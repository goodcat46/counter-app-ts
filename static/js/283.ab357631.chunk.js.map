{"version":3,"file":"static/js/283.ab357631.chunk.js","mappings":"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","sources":["components/Forms/FormCreateTransaction.tsx"],"sourcesContent":["import * as React from 'react';\nimport { useMemo, useState } from 'react';\nimport ModalForm, { ModalFormProps } from '../ModalForm';\nimport styled from 'styled-components';\nimport { ITransaction, ITransactionReqData, TransactionType } from 'redux/transactions/transactions.types';\nimport { CategoryTypes } from 'redux/directories/directories.types';\nimport InputLabel from '../atoms/Inputs/InputLabel';\nimport InputText from '../atoms/Inputs/InputText';\nimport * as yup from 'yup';\nimport TextareaPrimary from '../atoms/Inputs/TextareaPrimary';\nimport { FilterOpt } from '../ModalForm/ModalFilter';\nimport CustomSelect from '../atoms/Inputs/CustomSelect/CustomSelect';\nimport { toInputValueDate, toTrReqData } from '../../utils';\nimport { useAppSelector } from '../../redux/store.store';\nimport FlexBox from '../atoms/FlexBox';\nimport translate from '../../lang';\nimport { ApiDirType } from '../../redux/APP_CONFIGS';\nimport { useAppForm } from '../../hooks';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport FormAfterSubmitOptions, { useAfterSubmitOptions } from './components/FormAfterSubmitOptions';\nimport { UseAppFormSubmitOptions } from '../../hooks/useAppForm.hook';\n\nexport type TransactionsFilterOpt = FilterOpt<CategoryTypes>;\n\nexport interface FormCreateTransactionProps extends Omit<ModalFormProps, 'onSubmit'> {\n  edit?: boolean;\n  copy?: boolean;\n  id?: string;\n  onSubmit?: (data: ITransactionReqData, options?: UseAppFormSubmitOptions) => void;\n  filterOptions?: TransactionsFilterOpt[];\n  defaultState?: Partial<ITransaction>;\n  addInputs?: boolean;\n}\n\nconst optionalSelectItem = yup\n  .object()\n  .shape({\n    _id: yup.string(),\n    label: yup.string(),\n  })\n  .nullable()\n  .optional();\nconst requiredSelectItem = yup\n  .object()\n  .shape({\n    _id: yup.string(),\n    label: yup.string(),\n  })\n  .required();\n\nconst getValidation = (type?: TransactionType) =>\n  yup.object().shape({\n    amount: yup.number().required(),\n    type: yup.string().required(),\n    eventDate: yup.string().required(),\n    comment: yup.string().optional(),\n    countIn: type && ['INCOME', 'TRANSFER'].includes(type) ? requiredSelectItem : optionalSelectItem,\n    subCountIn: optionalSelectItem,\n    countOut: type && ['EXPENSE', 'TRANSFER'].includes(type) ? requiredSelectItem : optionalSelectItem,\n    subCountOut: optionalSelectItem,\n    category: requiredSelectItem,\n    subCategory: optionalSelectItem,\n  });\n\nconst FormCreateTransaction: React.FC<FormCreateTransactionProps> = ({\n  edit,\n  onSubmit,\n  copy,\n  defaultState,\n  addInputs,\n  ...props\n}) => {\n  const {\n    directories: { directories },\n  } = useAppSelector();\n  const [currentType, setCurrentType] = useState<TransactionType | undefined>(defaultState?.type);\n  const {\n    formState: { errors, isValid },\n    formValues,\n    register,\n    setValue,\n    registerSelect,\n    handleSubmit,\n  } = useAppForm<ITransaction>({\n    defaultValues: { currency: 'UAH', ...defaultState, eventDate: toInputValueDate(defaultState?.eventDate) },\n    resolver: yupResolver(getValidation(currentType)),\n    reValidateMode: 'onSubmit',\n  });\n\n  const submitOptions = useAfterSubmitOptions();\n\n  function onValidSubmit(submitData: ITransaction) {\n    const omitPathArr: (keyof ITransaction)[] =\n      (formValues.type === 'INCOME' && ['countOut', 'subCountOut']) ||\n      (formValues.type === 'EXPENSE' && ['countIn', 'subCountIn']) ||\n      [];\n\n    const trReqData = toTrReqData(submitData, omitPathArr, '', 'amount');\n\n    onSubmit && onSubmit({ _id: '', data: trReqData }, { ...submitOptions.state });\n  }\n\n  const renderInputsCountIn = useMemo(() => {\n    const parentOptions = directories[ApiDirType.COUNTS];\n\n    const parent = parentOptions.find(el => el._id === formValues.countIn?._id);\n\n    return formValues.type && ['INCOME', 'TRANSFER'].includes(formValues.type) ? (\n      <>\n        <CustomSelect\n          {...registerSelect(\n            'countIn',\n            {\n              label: translate('countIn'),\n              placeholder: translate('countIn'),\n              required: true,\n              options: parentOptions,\n            },\n            { childName: 'subCountIn' }\n          )}\n        />\n        {parent?.childrenList && parent?.childrenList?.length > 0 && (\n          <CustomSelect\n            label={translate('subCountIn')}\n            placeholder={translate('subCountIn')}\n            {...registerSelect('subCountIn', { options: parent?.childrenList })}\n          />\n        )}\n      </>\n    ) : null;\n  }, [directories, formValues.countIn?._id, formValues.type, registerSelect]);\n\n  const renderInputsCountOut = useMemo(() => {\n    const parentOptions = directories[ApiDirType.COUNTS];\n\n    const childOptions = parentOptions.find(el => el._id === formValues.countOut?._id)?.childrenList;\n\n    return formValues.type && ['EXPENSE', 'TRANSFER'].includes(formValues.type) ? (\n      <>\n        <CustomSelect\n          {...registerSelect(\n            'countOut',\n            {\n              label: translate('countOut'),\n              placeholder: translate('countOut'),\n              required: true,\n              options: parentOptions,\n              error: errors.countOut,\n            },\n            { childName: 'subCountOut' }\n          )}\n        />\n        {childOptions && childOptions.length > 0 && (\n          <CustomSelect\n            label={translate('subCountOut')}\n            placeholder={translate('subCountOut')}\n            {...registerSelect('subCountOut', { options: childOptions, error: errors.subCountOut })}\n          />\n        )}\n      </>\n    ) : null;\n  }, [directories, errors.countOut, errors.subCountOut, formValues.countOut?._id, formValues.type, registerSelect]);\n\n  const renderInputsCategories = useMemo(() => {\n    const parentOptions = directories[ApiDirType.CATEGORIES_TR].filter(el => el.type === formValues.type);\n\n    const childOptions = parentOptions.find(el => el._id === formValues.category?._id)?.childrenList;\n\n    return (\n      <>\n        <CustomSelect\n          {...registerSelect(\n            'category',\n            {\n              label: translate('category'),\n              placeholder: translate('category'),\n              required: true,\n              options: parentOptions,\n            },\n            { childName: 'subCategory' }\n          )}\n        />\n        {childOptions && childOptions.length > 0 && (\n          <CustomSelect\n            label={translate('subCategory')}\n            placeholder={translate('subCategory')}\n            {...registerSelect('subCategory', { options: childOptions })}\n          />\n        )}\n      </>\n    );\n  }, [directories, formValues.category?._id, formValues.type, registerSelect]);\n\n  return (\n    <ModalForm\n      isValid={isValid}\n      onSubmit={handleSubmit(onValidSubmit, data => console.log(data))}\n      onOptSelect={({ value }) => {\n        if (value) {\n          setCurrentType(value);\n          setValue('type', value);\n        }\n      }}\n      {...props}\n      extraFooter={<FormAfterSubmitOptions {...submitOptions} />}\n    >\n      <FlexBox className={'inputs'} flex={'1'} fillWidth maxHeight={'100%'} padding={'0 8px 8px'} overflow={'auto'}>\n        <InputLabel label={translate('dateAndTime')} direction={'vertical'}>\n          <InputText placeholder={translate('dateAndTime')} type=\"datetime-local\" {...register('eventDate')} />\n        </InputLabel>\n        <GridWrapper>\n          <InputLabel label={translate('amount')} direction={'vertical'}>\n            <InputText\n              placeholder={translate('amount')}\n              type={'number'}\n              {...register('amount', { valueAsNumber: true })}\n            />\n          </InputLabel>\n\n          <InputLabel label={translate('currency')} direction={'vertical'}>\n            <InputText placeholder={translate('currency')} {...register('currency')} disabled />\n          </InputLabel>\n        </GridWrapper>\n\n        {renderInputsCountOut}\n        {renderInputsCountIn}\n        {renderInputsCategories}\n\n        <CustomSelect\n          label={translate('contractor')}\n          placeholder={translate('contractor')}\n          {...registerSelect('contractor', {\n            options: directories[ApiDirType.CONTRACTORS],\n          })}\n        />\n\n        <InputLabel label={translate('comment')} direction={'vertical'}>\n          <TextareaPrimary placeholder={translate('comment')} {...register('comment')} />\n        </InputLabel>\n      </FlexBox>\n    </ModalForm>\n  );\n};\n\nconst GridWrapper = styled.div<{ gridTemplateColumns?: string }>`\n  display: grid;\n  grid-template-columns: ${({ gridTemplateColumns }) => gridTemplateColumns || '1fr 120px'};\n  gap: 8px;\n`;\n\nexport default FormCreateTransaction;\n"],"names":["optionalSelectItem","yup","shape","_id","label","nullable","optional","requiredSelectItem","required","GridWrapper","styled","_templateObject","_taggedTemplateLiteral","_ref3","gridTemplateColumns","_ref","edit","_formValues$countIn2","_formValues$countOut2","_formValues$category2","type","onSubmit","defaultState","copy","props","addInputs","_objectWithoutProperties","_excluded","directories","useAppSelector","_useState","useState","_useState2","_slicedToArray","currentType","setCurrentType","_useAppForm","useAppForm","defaultValues","_objectSpread","currency","eventDate","toInputValueDate","resolver","yupResolver","amount","comment","countIn","includes","subCountIn","countOut","subCountOut","category","subCategory","reValidateMode","_useAppForm$formState","formState","errors","isValid","formValues","register","setValue","registerSelect","handleSubmit","submitOptions","useAfterSubmitOptions","renderInputsCountIn","useMemo","_parent$childrenList","parentOptions","ApiDirType","parent","find","el","_formValues$countIn","_jsxs","_Fragment","children","_jsx","CustomSelect","translate","placeholder","options","childName","childrenList","length","renderInputsCountOut","_parentOptions$find","childOptions","_formValues$countOut","error","renderInputsCategories","_parentOptions$find2","filter","_formValues$category","ModalForm","submitData","omitPathArr","trReqData","toTrReqData","data","state","console","log","onOptSelect","_ref2","value","extraFooter","FormAfterSubmitOptions","FlexBox","className","flex","fillWidth","maxHeight","padding","overflow","InputLabel","direction","InputText","valueAsNumber","disabled","TextareaPrimary"],"sourceRoot":""}