"use strict";(self.webpackChunkmia_erp=self.webpackChunkmia_erp||[]).push([[882,264],{882:function(e,a,t){t.r(a),t.d(a,{default:function(){return Z},useOffersTableSettings:function(){return L}});var o,i=t(9439),n=t(168),r=t(1413),d=t(5817),l=t(8495),f=t(2360),s=t(2791),c=t(6931),u=t(7348),h=function(){return[]},v=t(3665),p=t(1819),m=t(6522),g=t(7264),x=t(1494),y=t(2410),b=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).loaders,a=(0,p.xc)().get(p.EJ.offers),t=(0,y.x)(),o=(0,v.f9)(),i=(0,u.i7)().dataMap;return(0,s.useCallback)((function(n){var r,d=null===(r=n.selectedRow)||void 0===r?void 0:r._id,l=d?null===i||void 0===i?void 0:i[d]:void 0;return[{name:"refreshData",title:(0,m.t)("Refresh data"),icon:"refresh",type:"onlyIcon",onClick:function(){a.getAll({data:{refresh:!0},onLoading:e?e.onLoading("refresh"):n.onRefresh})}},{separator:!0},{name:"review",title:"\u041f\u0435\u0440\u0435\u0433\u043b\u044f\u0434 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0443",icon:"openInNew",disabled:!d,type:"onlyIcon",navTo:"/app/".concat(t.params.permissionId,"/offers/")+d},{name:"edit",title:"\u0417\u043c\u0456\u043d\u0438\u0442\u0438",icon:"edit",iconSize:"90%",type:"onlyIcon",disabled:!d,onClick:function(){l?o.create(g.default,{offer:l}):d&&a.getOne({data:{data:{params:{_id:d}}},onLoading:e?e.onLoading("offer"):n.onRefresh,onSuccess:function(e){var a=e.data;o.create(g.default,{offer:a})}})}},{name:"copy",title:"\u041a\u043e\u043f\u0456\u044e\u0432\u0430\u0442\u0438",icon:"copy",iconSize:"90%",type:"onlyIcon",disabled:!l,onClick:function(){l&&o.create(g.default,{offer:l,copy:!0})}},{name:"archiveProduct",title:"\u0410\u0440\u0445\u0456\u0432",icon:"archive",iconSize:"90%",type:"onlyIcon",disabled:!0},{separator:!0},{name:"createProduct",title:"\u041d\u043e\u0432\u0438\u0439",icon:"plus",iconSize:"90%",type:"onlyIconFilled",disabled:!1,onClick:function(){o.create(x.default)}}]}),[e,o,t,a,i])},D=t(4897),j=t(9541),S=t(7824),_=t(959),C=t(3329),P=f.ZP.div(o||(o=(0,n.Z)(["\n  ","\n"])),l.VU),Z=function(e){var a=L({}),t=a.tableConfig,o=a.isLoading;return(0,C.jsx)(c.default,{path:e.path,children:(0,C.jsx)(P,{children:(0,C.jsx)(d.ZP,(0,r.Z)((0,r.Z)({},t),{},{isLoading:null===o||void 0===o?void 0:o.offers}))})})},L=function(e){var a=e.searchState,t=e.sortState,o=(0,j.J)({offers:{content:"Refreshing..."},refresh:{content:"Refreshing..."},offer:{content:"Refreshing..."}}),n=o.onLoading,r=o.isLoading,d=(0,p.xc)().get(S.d.offers).getAll,l=(0,u.i7)(),f=h(),c=b({loaders:o}),v=(0,s.useState)(t),m=(0,i.Z)(v,2),g=m[0],x=m[1],y=(0,s.useState)(a),C=(0,i.Z)(y,2),P=C[0],Z=C[1],L=(0,s.useMemo)((function(){return{onSubmitSearch:function(e){if(e.search){var a,t,o=null!==(a=e.param)&&void 0!==a&&a.dataPath?(0,_.P_)(null===(t=e.param)||void 0===t?void 0:t.dataPath,e.search):void 0;Z(e),d({data:{refresh:!0,params:o},onLoading:n("offers")}).then()}else d({data:{refresh:!0},onLoading:n("offers")}).then()},tableData:l.list,tableTitles:D.Y5,searchParams:D.Dr,sortParams:D.Cs,filterSelectors:f,hasFilter:!0,hasSearch:!0,showFooter:!1,checkBoxes:!0,actionsCreator:c,onTableSortChange:function(e,a){x({param:e,order:a}),d({data:{refresh:!0,params:{sortOrder:a,dataKey:null===e||void 0===e?void 0:e.dataKey,dataPath:null===e||void 0===e?void 0:e.dataPath}},onLoading:n("offers")}).then()}}}),[c,f,d,n,l.list]);return(0,s.useEffect)((function(){0===l.list.length&&d({data:{refresh:!0},onLoading:n("offers")})}),[]),{tableConfig:L,isLoading:r,sortParams:g,searchParams:P}}},8495:function(e,a,t){t.d(a,{SI:function(){return f},VU:function(){return l}});var o,i,n,r=t(168),d=t(2360),l=(0,d.iv)(o||(o=(0,r.Z)(["\n  grid-column: 1/13;\n  grid-row: 1/13;\n"]))),f=(0,d.iv)(i||(i=(0,r.Z)(["\n  width: 100%;\n  height: 100%;\n"])));(0,d.iv)(n||(n=(0,r.Z)(["\n  outline: 1px solid tomato;\n"])))},7264:function(e,a,t){t.r(a);var o=t(1413),i=t(9420),n=t(8050),r=t(6522),d=t(959),l=t(3691),f=t(9306),s=t(3007),c=t(8095),u=t(6653),h=t(6492),v=t(9541),p=t(7578),m=t(8160),g=t(5888),x=t(2989),y=t(7608),b=t(5248),D=t(3329);a.default=function(e){var a,t,j,S,_,C,P,Z,L,I,k=e.onClose,w=e.offer,R=e.copy,V=(0,x.G2)(w),O=(0,v.J)({offer_refresh:{content:"Refreshing..."},offer_update:{content:"Updating..."}},{formData:V?(0,d.xT)(V):{type:l.iv.GOODS}}),T=O.setData,z=O.state,A=R?null===(a=z.formData)||void 0===a?void 0:a._id:null===V||void 0===V?void 0:V._id;return V?(0,D.jsx)(n.Z,{fillHeight:!0,title:R?(0,r.t)("Copy offer"):(0,r.t)("Update offer"),onClose:k,children:(0,D.jsx)(p.f4,{value:O,children:null!==(t=O.isLoading)&&void 0!==t&&t.offer?(0,D.jsxs)(c.ZP,{fillWidth:!0,padding:"24px",alignItems:"center",gap:16,children:[(0,D.jsx)(u.$,{size:52}),(0,D.jsx)(h.x,{children:(0,r.t)("Loading info about offer...")})]}):(0,D.jsxs)(c.ZP,{padding:"0 8px 16px",children:[(0,D.jsx)(s.B,{_id:A,edit:!R,type:null===(j=z.formData)||void 0===j?void 0:j.type,defaultValues:null===z||void 0===z?void 0:z.formData,onSuccess:function(e){var a=e.data;T("formData",R?(0,o.Z)((0,o.Z)({},(0,d.xT)(a)),{},{_id:a._id}):(0,d.xT)(a))}}),(0,D.jsx)(y.A,{_id:A,offer:V,defaultValues:null===(S=z.formData)||void 0===S?void 0:S.categories,disabled:!z.formData}),(0,D.jsx)(m.R,{_id:A,offer:V,defaultValues:null===(_=z.formData)||void 0===_?void 0:_.properties,disabled:!z.formData}),(0,D.jsx)(b.L,{expandable:!0,isOpen:!1,offer:V,defaultState:null===V||void 0===V?void 0:V.price,price:null===V||void 0===V?void 0:V.price,title:(0,r.t)("Price")}),(0,D.jsx)(g.A,{offer:V,defaultValues:null===z||void 0===z||null===(C=z.formData)||void 0===C?void 0:C.images,disabled:!(null!==z&&void 0!==z&&z.formData),_id:A}),(0,D.jsx)(i.A,{offer:V,defaultValues:null===(P=z.formData)||void 0===P?void 0:P.dimensions,disabled:R?!(null!==(Z=z.formData)&&void 0!==Z&&Z._id&&z.formData):!A,_id:A}),(0,D.jsx)(f.n,{offer:V,defaultValues:null===(L=z.formData)||void 0===L?void 0:L.measurement,disabled:R?!(null!==(I=z.formData)&&void 0!==I&&I._id&&z.formData):!A,_id:A})]})})}):(0,D.jsx)(n.Z,{title:R?(0,r.t)("Copy offer"):(0,r.t)("Update offer"),fillHeight:!0,children:(0,D.jsx)(c.ZP,{fillWidth:!0,fillHeight:!0,padding:"26px",alignItems:"center",justifyContent:"center",children:(0,D.jsx)(h.x,{$size:16,$weight:600,children:(0,r.t)("Offer not found")})})})}}}]);
//# sourceMappingURL=882.f378ce5a.chunk.js.map