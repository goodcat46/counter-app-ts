"use strict";(self.webpackChunkcounter_app_ts=self.webpackChunkcounter_app_ts||[]).push([[265],{8293:function(e,n,o){o.d(n,{Z:function(){return M}});var i,t=o(168),l=o(1413),r=o(4925),a=function(e){return e.facebook="facebook",e.instagram="instagram",e.referralSystem="referralSystem",e.another="another",e}({}),d=o(9656),u=o(6522),c=o(2360),s=o(8095),v=o(4990),f=o(6681),h=o(9964),m=o(457),p=o(1134),x=o(4109),g=o(1392),Z=o(8553),b=o(2791),C=o(1383),j=o(7038),S=o(763),P=o.n(S),w=o(3329),I=["defaultState","withReferer","onSubmit","onClose"],y=C.E4.isDevMode(),k=(0,Z.H1)(a),D=(0,c.ZP)(s.ZP)(i||(i=(0,t.Z)([""]))),M=function(e){var n=e.defaultState,o=e.withReferer,i=e.onSubmit,t=(e.onClose,(0,r.Z)(e,I)),c=(0,p.cI)({defaultValues:(0,l.Z)((0,l.Z)({},n),{},{businessType:j.G.company})}),Z=c.register,C=c.setValue,S=c.handleSubmit,M=(0,c.watch)(),R=(0,b.useMemo)((function(){return!(null===n||void 0===n||!n.email)}),[null===n||void 0===n?void 0:n.email]);return(0,w.jsx)(d.Z,(0,l.Z)((0,l.Z)({},t),{},{title:t.title?t.title:(0,u.t)("Create customer"),onSubmit:S((function(e){i&&i(P().omit(e,R?["engagementSource","email"]:["engagementSource"]))})),children:(0,w.jsxs)(D,{padding:"0 8px 8px",children:[(0,w.jsx)(v.Z,{label:(0,u.t)("type"),required:!0,children:(0,w.jsx)(h.Z,{options:m.Wk,onSelect:function(e){C("businessType",null===e||void 0===e?void 0:e.value)}})}),(0,w.jsx)(v.Z,{label:(0,u.t)("name"),required:!0,children:(0,w.jsx)(f.ZP,(0,l.Z)((0,l.Z)({placeholder:(0,u.t)("name")},Z("name")),{},{required:!0}))}),(0,w.jsx)(v.Z,{label:(0,u.t)("secondName"),children:(0,w.jsx)(f.ZP,(0,l.Z)({placeholder:(0,u.t)("secondName")},Z("secondName")))}),(0,w.jsx)(v.Z,{label:(0,u.t)("email"),disabled:R,required:!0,children:(0,w.jsx)(f.ZP,(0,l.Z)((0,l.Z)({placeholder:(0,u.t)("email"),type:"email"},Z("email",{required:!0})),{},{disabled:R,required:!0}))}),(0,w.jsx)(v.Z,{label:(0,u.t)("phone"),children:(0,w.jsx)(f.ZP,(0,l.Z)({placeholder:(0,u.t)("phone")},Z("phone")))}),(0,w.jsx)(v.Z,{label:(0,u.t)("Birth date"),children:(0,w.jsx)(f.ZP,(0,l.Z)((0,l.Z)({placeholder:(0,u.t)("Birth date")},Z("birthDate")),{},{type:"datetime-local"}))}),o&&y&&(0,w.jsx)(v.Z,{label:(0,u.t)("Referrer id"),children:(0,w.jsx)(f.ZP,(0,l.Z)({placeholder:(0,u.t)("Referrer id")},Z("referrer._id")))}),(0,w.jsx)(v.Z,{label:(0,u.t)("Source"),children:(0,w.jsx)(g.Z,{disabled:!0,options:k,currentOption:{value:null===M||void 0===M?void 0:M.engagementSource},onChangeIndex:function(e){C("engagementSource",k[e].value)}})}),(null===M||void 0===M?void 0:M.engagementSource)===a.referralSystem&&(0,w.jsxs)(s.ZP,{gap:8,fillWidth:!0,children:[(0,w.jsx)(v.Z,{label:(0,u.t)("Referrer"),required:!0,children:(0,w.jsx)(f.ZP,{placeholder:(0,u.t)("Referrer"),type:"email",required:!0})}),(0,w.jsxs)(s.ZP,{fxDirection:"row",fillWidth:!0,gap:8,padding:"8px 0",children:[(0,w.jsx)(x.Z,{variant:"defOutlinedSmall",children:(0,u.t)("Clear referrer")}),(0,w.jsx)(x.Z,{variant:"outlinedSmall",flex:1,children:(0,u.t)("Select referrer")})]})]})]})}))}},3265:function(e,n,o){o.r(n),o.d(n,{FormCreateOrdersGroupStepsEnum:function(){return ke},default:function(){return We}});var i,t,l,r,a=o(168),d=o(1413),u=o(9439),c=o(4942),s=o(8553),v=o(7506),f=o(853),h=o(2791),m=o(2360),p=o(8095),x=o(1251),g=o(6522),Z=o(7606),b=o(3433),C=o(7348),j=o(9434),S=o(4945),P=o(4109),w=o(1383),I=o(825),y=o(5188),k=o(6201),D=o(4636),M=o(6492),R=o(3329),B=(0,m.ZP)(D.Z)(i||(i=(0,a.Z)(["\n  & .header {\n  }\n  & .content {\n    padding: 0;\n  }\n"]))),q=function(e){var n=e.slots,o=e.onRemove,i=e.onUpdate,t=e.renderHeader,l=e.title,r=e.onAddSlotPress,a=e.renderFooter,d=(0,m.Fg)(),u=(0,h.useMemo)((function(){return n.map((function(e){return(0,R.jsx)(k.Z,{slot:e,editable:!0,onRemovePress:o?function(){return(null===e||void 0===e?void 0:e.tempId)&&o(null===e||void 0===e?void 0:e.tempId)}:void 0,onUpdate:i},"slot_".concat(null===e||void 0===e?void 0:e.tempId))}))}),[o,i,n]),c=(0,h.useMemo)((function(){return(0,R.jsxs)(p.ZP,{fxDirection:"row",fillHeight:!0,gap:8,alignItems:"center",padding:"2px 0",children:[t||(0,R.jsx)(M.x,{$weight:500,$size:15,children:l}),r&&(0,R.jsx)(p.ZP,{height:"80%",border:"1px solid ".concat(d.modalBorderColor)}),r&&(0,R.jsx)(P.Z,{variant:"textExtraSmall",style:{minWidth:"fit-content",height:"100%",fontWeight:600},disabled:!r,onClick:r,children:(0,g.t)("Add")})]})}),[r,t,d.modalBorderColor,l]);return(0,R.jsx)(R.Fragment,{children:(0,R.jsx)(B,{open:!0,renderHeader:c,renderFooter:a,title:l,children:u})})},W=o(6211),A=(0,m.ZP)(p.ZP)(t||(t=(0,a.Z)(["\n  color: ",";\n"])),(function(e){return e.theme.fontColorSidebar})),F=(0,m.ZP)(p.ZP)(l||(l=(0,a.Z)([""]))),_=(0,m.ZP)(p.ZP)(r||(r=(0,a.Z)(["\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),$=function(e){var n=e.onChangeValidStatus,o=(0,C.xA)().ordersGroupFormData.slots,i=(0,y.kw)(),t=(0,j.I0)(),l=(0,h.useCallback)((function(e){t((0,S.xp)(e))}),[t]),r=(0,h.useCallback)((function(e){t((0,S.BA)(e))}),[t]),a=(0,h.useCallback)((function(e){t((0,S.ac)(e))}),[t]),d=(0,h.useMemo)((function(){var e={};return null===o||void 0===o||o.map((function(n){var o,i,t;null!==(o=n.warehouse)&&void 0!==o&&o._id&&(e[n.warehouse._id]={warehouse:n.warehouse,slots:null!==(i=e[n.warehouse._id])&&void 0!==i&&i.slots?[].concat((0,b.Z)(null===(t=e[n.warehouse._id])||void 0===t?void 0:t.slots),[n]):[n]});return""})),e}),[o]);(0,h.useEffect)((function(){n&&n(!(null===o||void 0===o||!o.length)&&(null===o||void 0===o?void 0:o.length)>0)}),[n,null===o||void 0===o?void 0:o.length]);var u=(0,h.useMemo)((function(){return Object.keys(d).map((function(e,n){var o,t,u=d[e];return(0,R.jsx)(q,{slots:u.slots,title:null===u||void 0===u||null===(t=u.warehouse)||void 0===t?void 0:t.label,onRemove:r,onUpdate:a,onAddSlotPress:function(){var e=i.open({Modal:I.n.FormCreateOrderSlot,props:{params:null!==u&&void 0!==u&&u.warehouse?{warehouse:(0,W.rE)(null===u||void 0===u?void 0:u.warehouse)}:void 0,onSubmit:function(n){l(n),n&&null!==e&&void 0!==e&&e.onClose&&(null===e||void 0===e||e.onClose())}}})}},"pre-order_".concat((null===(o=u.warehouse)||void 0===o?void 0:o._id)||n))}))}),[d,l,r,a,i]);return(0,R.jsxs)(A,{flex:1,fillWidth:!0,overflow:"hidden",style:{position:"relative"},children:[(0,R.jsx)(F,{flex:1,overflow:"auto",children:(0,R.jsx)(p.ZP,{flex:1,fillWidth:!0,children:u})}),(0,R.jsxs)(_,{fxDirection:"row",gap:8,padding:"8px",children:[(0,R.jsx)(P.Z,{variant:"defOutlinedSmall",onClick:function(){window.confirm("Remove all items?")&&w.kl.info("All items will be remove")},children:(0,g.t)("Remove all")}),(0,R.jsx)(P.Z,{variant:"outlinedSmall",flex:1,onClick:function(){var e=i.open({Modal:I.n.FormCreateOrderSlot,props:{onSubmit:function(n){l(n),n&&null!==e&&void 0!==e&&e.onClose&&(null===e||void 0===e||e.onClose())}}})},children:(0,g.t)("Add position to group")})]})]})},E=o(4990),V=o(4925),N=o(9656),O=o(1186),H=o(3363),G=o(8332),L=o(8293),T=["onSelect","onSubmit","onClose","asReceiver"],U=function(e){var n=e.onSelect,o=(e.onSubmit,e.onClose),i=e.asReceiver,t=(0,V.Z)(e,T),l=(0,C.I6)().customers,r=(0,y.kw)(),a=(0,G.xc)()[G.EJ.customers],u=(0,h.useMemo)((function(){return{tableData:l,tableTitles:O.f,actionsCreator:function(e){return[{icon:"refresh",onClick:function(){return a.getAll()}},{separator:!0},{icon:"plus",onClick:function(){r.open({ModalChildren:L.Z,modalChildrenProps:{onSubmit:function(e){console.log("createDataForReq(d) ModalChildren: FormCreateCustomer",(0,W.X$)(e)),a.create({data:(0,W.X$)(e)})}}})}}]},onRowClick:function(e){(null===e||void 0===e?void 0:e.rowData)&&n&&n(e.rowData),o&&o()}}}),[a,l,o,r,n]);return(0,h.useEffect)((function(){a.getAll({data:{refresh:!0,params:{}}})}),[]),(0,R.jsx)(N.Z,(0,d.Z)((0,d.Z)({fillWidth:!0,fillHeight:!0,title:(0,g.t)(i?"Select receiver":"Select customer"),onClose:o},t),{},{children:(0,R.jsx)(H.ZP,(0,d.Z)({},u))}))},z=o(6074),X=o(7666),J=["onSubmit","onSelect","onClose"],Q=function(e){e.onSubmit;var n=e.onSelect,o=e.onClose,i=((0,V.Z)(e,J),(0,C.O5)().users),t=(0,h.useMemo)((function(){return{tableData:i,onRowClick:function(e){var o=i.find((function(n){return n._id===(null===e||void 0===e?void 0:e._id)}));o&&n&&n(o)}}}),[n,i]);return(0,R.jsx)(N.Z,{fillWidth:!0,fillHeight:!0,onClose:o,title:(0,g.t)("Select manager"),children:(0,R.jsx)(H.ZP,(0,d.Z)((0,d.Z)({tableTitles:X.NT},t),{},{isSearch:!1}))})},K=o(1392),Y=o(4507),ee=o(389),ne=o(6681),oe=o(1134),ie=function(e){var n=e.onSuccess,o=e.isReceiver,i=(0,G.xc)()[G.EJ.customers],t=(0,y.kw)();return(0,R.jsx)(P.Z,{variant:"onlyIcon",icon:"plus",iconSize:"100%",size:"30px",onClick:function(){t.open({ModalChildren:L.Z,modalChildrenProps:{title:o?(0,g.t)("Create receiver"):void 0,onSubmit:function(e){i.create({data:(0,W.X$)(e),onSuccess:n})}}})}})},te=function(e){var n=e.info,o=e.isReceiver,i=e.isManager,t=(0,m.Fg)(),l=(0,h.useMemo)((function(){if(n)return function(e){var n=e.isManager;return[{label:(0,g.t)("label"),getValue:function(e){return(null===e||void 0===e?void 0:e.label)||"---"},visible:!n},{label:(0,g.t)("name"),getValue:function(e){return(null===e||void 0===e?void 0:e.name)||"---"},visible:!0},{label:(0,g.t)("secondName"),getValue:function(e){return(null===e||void 0===e?void 0:e.secondName)||"---"},visible:!0},{label:(0,g.t)("email"),getValue:function(e){return(null===e||void 0===e?void 0:e.email)||"---"},visible:!0},{label:(0,g.t)("taxCode"),getValue:function(e){return(null===e||void 0===e?void 0:e.taxCode)||"---"},visible:!n},{label:(0,g.t)("personalTaxCode"),getValue:function(e){return(null===e||void 0===e?void 0:e.personalTaxCode)||"---"},visible:!n},{label:(0,g.t)("tags"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.tags)||void 0===n?void 0:n.join(", "))||"---"},visible:!n}]}({info:n,isReceiver:o,isManager:i}).map((function(e){var o=e.label,i=e.getValue;return e.visible&&(0,R.jsxs)(p.ZP,{gap:4,padding:"4px",flex:"1 1 50%",maxWidth:"50%",border:"1px solid ".concat(t.modalBorderColor),children:[(0,R.jsx)(M.x,{$size:12,children:o}),(0,R.jsx)(M.x,{$align:"right",children:i(n)})]},o)}))}),[n,i,o,t.modalBorderColor]);return(0,R.jsx)(p.ZP,{fillWidth:!0,flexWrap:"wrap",fxDirection:"row",border:"1px solid ".concat(t.modalBorderColor),children:l})};var le,re,ae,de,ue,ce,se,ve=[{name:"country",label:(0,g.t)("Country"),required:!1},{name:"region",label:(0,g.t)("Region"),required:!1},{name:"area",label:(0,g.t)("Area"),required:!1},{name:"city",label:(0,g.t)("City"),required:!1},{name:"street",label:(0,g.t)("Street"),required:!1},{name:"house",label:(0,g.t)("House"),required:!1},{name:"office",label:(0,g.t)("Office"),required:!1},{name:"room",label:(0,g.t)("Room"),required:!1}],fe=o(763),he=o.n(fe),me=(he().throttle((function(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];(e=console).log.apply(e,["Throttled Logger"].concat(o))}),5e3),he().throttle((function(e){console.log(me.name),e()}),3e3)),pe=(0,m.ZP)(p.ZP)(le||(le=(0,a.Z)([""]))),xe=(0,m.ZP)(p.ZP)(re||(re=(0,a.Z)(["\n  padding-bottom: 8px;\n\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),ge=(0,m.ZP)(D.Z)(ae||(ae=(0,a.Z)(["\n  & .content {\n    max-width: 480px;\n    width: 100%;\n    margin: auto;\n  }\n"]))),Ze=function(e){e.getFormMethods;var n,o,i,t,l,r,a,s,v,f,m=e.onChangeValidStatus,x=(0,h.useState)({}),Z=(0,u.Z)(x,2),b=Z[0],j=Z[1],S=(0,y.kw)(),w=(0,h.useState)({}),I=(0,u.Z)(w,2),k=I[0],D=I[1];(0,h.useEffect)((function(){console.debug("OrderInfoStep",{touchedFields:b})}),[b]);var B=(0,Y.$v)((0,C.eD)().methods,{withFullLabel:!0}),q=(0,Y.$v)((0,C.$N)().methods,{withFullLabel:!0}),W=(0,Y.$v)((0,C.A2)().methods,{withFullLabel:!0}),A=(0,oe.Gc)(),F=A.formState,_=F.isValid,$=F.errors,V=A.register,N=A.setValue,O=A.unregister,H=A.watch,G=A.trigger,L=H(),T=function(e,n){try{N(e,n),me((function(){return G().then((function(e){e&&m&&m(e)})).catch((function(e){console.error("handleOnChangeValue trigger error",e)}))})),function(e){j((function(n){return(0,d.Z)((0,d.Z)({},n),{},(0,c.Z)({},e,!0))}))}(e)}catch(o){console.error("handleOnChangeValue: ",o)}},X=function(e){return function(n){if(D((function(o){return(0,d.Z)((0,d.Z)({},o),{},(0,c.Z)({},e,n))})),!n){if("hasDeliveryInvoice"===e)return O("deliveryInfo.invoiceInfo");if("hasReceiverInfo"===e)return O("receiver")}}};return(0,h.useEffect)((function(){m&&m(_)}),[_,m]),(0,R.jsxs)(pe,{flex:1,overflow:"auto",children:[(0,R.jsxs)(p.ZP,{fillWidth:!0,gap:8,padding:"8px 2px",style:{maxWidth:480,width:"100%",margin:"0 auto"},children:[(null===L||void 0===L?void 0:L.manager)&&(0,R.jsx)(E.Z,{label:(0,g.t)("manager"),children:(0,R.jsx)(te,{info:null===L||void 0===L||null===(n=L.manager)||void 0===n?void 0:n.user,isManager:!0})}),(0,R.jsx)(P.Z,{variant:"outlinedSmall",onClick:function(){var e=S.open({ModalChildren:Q,modalChildrenProps:{onSelect:function(n){T("manager",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,g.t)(null!==L&&void 0!==L&&L.manager?"Change manager":"Select manager")})]}),(0,R.jsxs)(p.ZP,{padding:"0 2px",children:[(0,R.jsxs)(ge,{contentContainerStyle:{padding:"8px 0",gap:8},open:!0,renderHeader:(0,R.jsx)(M.x,{$padding:"0 6px",$ellipsisMode:!0,$size:16,$weight:500,children:"".concat((0,g.t)("Customer")," | ").concat((0,g.t)("Receiver"))}),children:[(null===L||void 0===L?void 0:L.customer)&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(E.Z,{label:(0,g.t)("Customer information"),children:(0,R.jsx)(te,{info:null===L||void 0===L?void 0:L.customer})}),(0,R.jsx)(xe,{fillWidth:!0,overflow:"hidden",children:(0,R.jsx)(E.Z,{label:(0,g.t)("Communication methods"),children:(0,R.jsx)(z.Z,{multiple:!0,numColumns:2,values:null===L||void 0===L||null===(o=L.communication)||void 0===o?void 0:o.customer,resetButtonLabel:(0,g.t)("Not needed"),options:q.map((function(e){return(0,d.Z)((0,d.Z)({},e),{},{value:e._id})})),resetButtonPosition:"start",onChange:function(e){T("communication.customer",e)}})})})]}),(0,R.jsxs)(p.ZP,{fxDirection:"row",gap:8,fillWidth:!0,alignItems:"center",children:[(0,R.jsx)(ie,{onSuccess:function(e){T("customer",e)}}),(0,R.jsx)(P.Z,{variant:"outlinedSmall",flex:1,onClick:function(){var e=S.open({ModalChildren:U,modalChildrenProps:{onSelect:function(n){T("customer",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,g.t)(null!==L&&void 0!==L&&L.customer?"Change customer":"Select customer")})]}),(0,R.jsx)(xe,{fillWidth:!0,gap:4,children:(0,R.jsx)(E.Z,{label:(0,g.t)("Receiver"),children:(0,R.jsx)(ee.Z,{onChange:X("hasReceiverInfo"),value:(null===k||void 0===k?void 0:k.hasReceiverInfo)||!(null===L||void 0===L||!L.receiver),rejectLabel:"The same",acceptLabel:"Another"})})}),((null===k||void 0===k?void 0:k.hasReceiverInfo)||(null===L||void 0===L?void 0:L.receiver))&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(E.Z,{label:(0,g.t)("Receiver information"),children:[(0,R.jsx)(te,{info:null===L||void 0===L?void 0:L.receiver})," "]}),(0,R.jsx)(xe,{fillWidth:!0,children:(0,R.jsx)(E.Z,{label:(0,g.t)("Communication methods"),children:(0,R.jsx)(z.Z,{multiple:!0,numColumns:2,values:null===L||void 0===L||null===(i=L.communication)||void 0===i?void 0:i.receiver,resetButtonLabel:(0,g.t)("Without"),options:q.map((function(e){return(0,d.Z)((0,d.Z)({},e),{},{value:e._id})})),resetButtonPosition:"start",onChange:function(e){T("communication.receiver",e)}})})})]}),(null===k||void 0===k?void 0:k.hasReceiverInfo)&&(0,R.jsxs)(p.ZP,{fxDirection:"row",gap:8,fillWidth:!0,alignItems:"center",children:[(0,R.jsx)(ie,{isReceiver:!0,onSuccess:function(e){T("receiver",e)}}),(0,R.jsx)(P.Z,{variant:"outlinedSmall",flex:1,onClick:function(){var e=S.open({ModalChildren:U,modalChildrenProps:{onSelect:function(n){T("receiver",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,g.t)(null!==L&&void 0!==L&&L.receiver?"Change receiver":"Select receiver")})]})]}),(0,R.jsxs)(ge,{contentContainerStyle:{padding:"8px 2px"},open:!0,renderHeader:(0,R.jsx)(M.x,{$padding:"0 6px",$ellipsisMode:!0,$size:16,$weight:500,children:(0,g.t)("Invoicing")}),children:[(0,R.jsx)(E.Z,{label:(0,g.t)("Payment method"),required:!0,children:(0,R.jsx)(K.Z,{options:W,currentOption:null===L||void 0===L||null===(t=L.invoiceInfo)||void 0===t?void 0:t.method,onChangeIndex:function(e){T("invoiceInfo.method",W[e])}})}),(0,R.jsx)(E.Z,{label:(0,g.t)("Expired at"),required:!0,children:(0,R.jsx)(ne.ZP,(0,d.Z)({placeholder:(0,g.t)("Expired at"),type:"datetime-local",required:!0},V("invoiceInfo.expiredAt",{required:!0})))})]}),(0,R.jsxs)(ge,{contentContainerStyle:{padding:"0 2px"},open:!0,renderHeader:(0,R.jsx)(M.x,{$padding:"0 6px",$ellipsisMode:!0,$size:16,$weight:500,children:"".concat((0,g.t)("Shipment")," | ").concat((0,g.t)("Delivery"))}),children:[(0,R.jsx)(xe,{fillWidth:!0,gap:8,children:(0,R.jsx)(E.Z,{label:(0,g.t)("Delivery method"),required:!0,children:(0,R.jsx)(K.Z,{options:B,currentOption:null===L||void 0===L||null===(l=L.deliveryInfo)||void 0===l?void 0:l.method,onChangeIndex:function(e){T("deliveryInfo.method",B[e])}})})}),(0,R.jsx)(xe,{fillWidth:!0,style:{columnGap:8,display:"grid",gridTemplateColumns:"1fr 1fr"},children:ve.map((function(e){var n,o,i=e.name,t=e.label,l=e.required;return(0,R.jsx)(E.Z,{label:t,error:null!==$&&void 0!==$&&null!==(n=$.deliveryInfo)&&void 0!==n&&n.destination?null===$||void 0===$||null===(o=$.deliveryInfo)||void 0===o?void 0:o.destination[i]:void 0,required:l,children:(0,R.jsx)(ne.ZP,(0,d.Z)({required:l,placeholder:t},V("deliveryInfo.destination.".concat(i),{required:l})))},"dest-addr-".concat(t))}))}),(0,R.jsx)(xe,{fillWidth:!0,gap:8,children:(0,R.jsx)(E.Z,{label:(0,g.t)("Has payment"),required:!0,children:(0,R.jsx)(ee.Z,{onChange:X("hasDeliveryInvoice"),value:(null===k||void 0===k?void 0:k.hasDeliveryInvoice)||!(null===L||void 0===L||null===(r=L.deliveryInfo)||void 0===r||!r.invoiceInfo)})})}),(0,R.jsx)(xe,{fillWidth:!0,gap:8,children:((null===k||void 0===k?void 0:k.hasDeliveryInvoice)||!(null===L||void 0===L||null===(a=L.deliveryInfo)||void 0===a||null===(s=a.invoiceInfo)||void 0===s||!s.method))&&(0,R.jsx)(E.Z,{label:(0,g.t)("Payment method"),required:!0,children:(0,R.jsx)(K.Z,{options:W,currentOption:null===L||void 0===L||null===(v=L.deliveryInfo)||void 0===v||null===(f=v.invoiceInfo)||void 0===f?void 0:f.method,onChangeIndex:function(e){T("deliveryInfo.invoiceInfo.method",W[e])}})})})]})]})]})},be=o(4695),Ce=o(371),je=o(9941),Se=o(6666),Pe=o(9297),we=o(8527),Ie=o(4522);function ye(e,n){(0,Ie.Z)(2,arguments);var o=(0,we.Z)(e),i=(0,Pe.Z)(n);return isNaN(i)?new Date(NaN):i?(o.setDate(o.getDate()+i),o):o}var ke=function(e){return e.Stuffing="Stuffing",e.Info="Info",e}({}),De=(0,s.H1)(ke),Me=(de={},(0,c.Z)(de,ke.Stuffing,!0),(0,c.Z)(de,ke.Info,!1),de),Re=m.ZP.div(ue||(ue=(0,a.Z)(["\n  color: ",";\n\n  display: flex;\n  flex-direction: column;\n\n  width: 98vw;\n  height: 98vh;\n  padding: 0 8px;\n\n  background-color: ",";\n"])),(function(e){return e.theme.fontColorSidebar}),(function(e){return e.theme.modalBackgroundColor})),Be=(0,m.ZP)(p.ZP)(ce||(ce=(0,a.Z)(["\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),qe=(0,m.ZP)(p.ZP)(se||(se=(0,a.Z)([""]))),We=function(e){e.onSubmit;var n,o=e.onClose,i=(0,G.xc)()[G.EJ.orders],t=(0,C.xA)().ordersGroupFormData,l=(0,f.dn)(De),r=l.stepsMap,a=l.stepIdx,s=l.setNextStep,m=l.setPrevStep,p=l.getCurrentStep,b=l.isLast,j=(0,h.useState)(Me),S=(0,u.Z)(j,2),P=S[0],I=S[1],y=function(e){return function(n){I((function(o){return(0,d.Z)((0,d.Z)({},o),{},(0,c.Z)({},ke[e],n))}))}},k=(0,oe.cI)({defaultValues:(0,d.Z)((0,d.Z)({},t.info),{},{invoiceInfo:(0,d.Z)({expiredAt:(0,Se._1)(ye(new Date,1))},null===(n=t.info)||void 0===n?void 0:n.invoiceInfo)}),resolver:(0,be.X)(Ce.Lr),reValidateMode:"onChange"}),D=k.watch();(0,h.useEffect)((function(){console.log(D)}),[D]);var M=(0,h.useMemo)((function(){return null!==r&&void 0!==r&&r.Stuffing?(0,R.jsx)($,{onChangeValidStatus:y("Stuffing")}):null!==r&&void 0!==r&&r.Info?(0,R.jsx)(Ze,{isGroup:!0,getFormMethods:function(){return k},onChangeValidStatus:y("Info")}):void 0}),[k,null===r||void 0===r?void 0:r.Info,null===r||void 0===r?void 0:r.Stuffing]),B=(0,h.useMemo)((function(){return P[p().value]}),[p,P]),q=(0,h.useMemo)((function(){return r.Stuffing?P.Stuffing:!!r.Info&&P.Info}),[P.Info,P.Stuffing,r.Info,r.Stuffing]);return(0,R.jsx)(oe.RV,(0,d.Z)((0,d.Z)({},k),{},{children:(0,R.jsxs)(Re,{children:[(0,R.jsx)(x.xB,{title:(0,g.t)("Create orders group by warehouse"),onBackPress:o}),(0,R.jsxs)(Be,{fillWidth:!0,flex:1,overflow:"hidden",children:[(0,R.jsx)(v.Z,{filterOptions:De,asStepper:!0,currentIndex:a,optionProps:{fitContentH:!0}}),M]}),(0,R.jsx)(qe,{padding:"8px",children:(0,R.jsx)(Z.Z,{steps:De,onNextPress:function(){"Info"===p().value&&i.updateCurrentGroupFormInfoData(he().cloneDeep(D)),B?s():w.kl.error("".concat((0,g.t)("Step is not finished"),': "').concat(p().value.toUpperCase(),'"'))},onPrevPress:function(){"Info"===p().value&&i.updateCurrentGroupFormInfoData(he().cloneDeep(D)),m()},currentIndex:a,canGoNext:!0,canAccept:b,onAcceptPress:function(){q?((0,je.Eh)({data:{data:{info:D,slots:t.slots}},onSuccess:function(e){console.log(e)},onError:function(e){console.log(e)},onLoading:function(e){}},je.p6.createManyOrdersGroupedByWarehouse,je.p6),console.log(p()),console.log(t)):w.kl.error("Form is not valid")},onCancelPress:0===a?o:void 0})})]})}))}},7606:function(e,n,o){var i,t,l,r=o(168),a=o(9439),d=o(2360),u=o(8095),c=o(4109),s=o(2791),v=o(6666),f=o(6522),h=o(4805),m=o(3329),p=(0,d.ZP)(u.ZP)(i||(i=(0,r.Z)(["\n  //min-height: 44px;\n  // border-top: 1px solid ",";\n  // border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),x=(0,d.ZP)(c.Z)(t||(t=(0,r.Z)(["\n  flex: 1;\n  min-width: min-content;\n  height: 100%;\n"]))),g=(0,d.ZP)(c.Z)(l||(l=(0,r.Z)(["\n  min-width: 34px;\n  height: 100%;\n  color: ",";\n  fill: ",";\n  background-color: ",";\n  @media screen and (min-width: 480px) {\n    flex: 1;\n  }\n"])),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.light}));n.Z=function(e){var n=e.steps,o=e.currentIndex,i=void 0===o?0:o,t=e.onNextPress,l=e.onPrevPress,r=e.onCancelPress,d=e.onAcceptPress,u=e.canGoNext,c=void 0===u||u,Z=e.canAccept,b=e.canSubmit,C=e.cancelButton,j=void 0===C||C,S=e.submitButton,P=void 0===S||S,w=e.acceptButton,I=e.arrowButtons,y=void 0===I||I,k=(0,h.useMediaQuery)({query:"(max-width: 768px)"}),D=(0,h.useMediaQuery)({query:"(max-width: 480px)"}),M=(0,s.useState)(i),R=(0,a.Z)(M,2),B=R[0],q=R[1],W=(0,s.useMemo)((function(){var e,o;return n&&n[B-1]?{label:null===(e=n[B-1])||void 0===e?void 0:e.label,value:null===(o=n[B-1])||void 0===o?void 0:o.value}:null}),[B,n]),A=(0,s.useMemo)((function(){var e,o;return n&&n[B+1]?{label:null===(e=n[B+1])||void 0===e?void 0:e.label,value:null===(o=n[B+1])||void 0===o?void 0:o.value}:null}),[B,n]),F=(0,s.useCallback)((function(){if(n)if(l){if(0===B)return void(r&&r());var e=B-1;l&&l({option:n[e],value:n[e].value,index:e})}else q((function(e){return 0===e?e:e-1}))}),[B,r,l,n]),_=(0,s.useCallback)((function(){if(n){if(t){var e=B+1;return e===n.length?d&&d():t({option:n[e],value:n[e].value,index:e})}q((function(e){return e+1===n.length?e+1:e}))}}),[B,d,t,n]);return(0,s.useEffect)((function(){v.sr.isNotUnd(i)&&q(i)}),[i]),(0,m.jsxs)(p,{fxDirection:"row",gap:8,fillWidth:!0,children:[j&&!k&&(0,m.jsx)(x,{variant:"defOutlinedSmall",onClick:r,children:(0,f.t)("Cancel")}),y&&(0,m.jsx)(g,{variant:D?"onlyIconFilled":"filledSmall",icon:"SmallArrowLeft",onClick:F,disabled:!W,children:null===W||void 0===W?void 0:W.label}),y&&(0,m.jsx)(g,{variant:D?"onlyIconFilled":"filledSmall",endIcon:"SmallArrowRight",onClick:_,disabled:!c||!A,children:null===A||void 0===A?void 0:A.label}),(P||w)&&(0,m.jsx)(x,{variant:"filledSmall",type:b&&P?"submit":"button",onClick:d,disabled:b&&P?!b:!Z,children:(0,f.t)("Accept")})]})}},1392:function(e,n,o){var i=o(3433),t=o(9439),l=o(2791),r=o(6666),a=o(8095),d=o(3855),u=o(6492),c=o(3329);n.Z=function(e){var n=e.options,o=e.onChangeIndex,s=e.currentIndex,v=e.currentOption,f=e.multiple,h=e.onChange,m=e.value,p=e.disabled,x=e.disabledCheck,g=(0,l.useState)(0),Z=(0,t.Z)(g,2),b=Z[0],C=Z[1],j=(0,l.useState)([]),S=(0,t.Z)(j,2),P=S[0],w=S[1];return(0,l.useEffect)((function(){r.sr.isUnd(s)||C(s)}),[s]),(0,l.useEffect)((function(){f||r.sr.isUnd(v)||r.sr.isUnd(n)||C(n.findIndex((function(e){return(null===e||void 0===e?void 0:e.value)===(null===v||void 0===v?void 0:v.value)||(null===e||void 0===e?void 0:e._id)===(null===v||void 0===v?void 0:v._id)})))}),[v,f,n]),(0,l.useEffect)((function(){f&&!r.sr.isUnd(m)&&r.sr.isArray(m)&&w(m)}),[f,m]),(0,c.jsx)(a.ZP,{fillWidth:!0,gap:8,children:null===n||void 0===n?void 0:n.map((function(e,n){var t=x?x(e,n):p;return(0,c.jsxs)(a.ZP,{fxDirection:"row",gap:8,padding:"2px 4px",alignItems:"center",style:{opacity:t?.7:1,pointerEvents:t?"none":"all"},onClick:function(){var l;t||(!function(e){C(e),o&&o(e)}(n),(null===e||void 0===e?void 0:e._id)&&(l=null===e||void 0===e?void 0:e._id,f?w((function(e){var n=P.includes(l)?e.filter((function(e){return e!==l})):[].concat((0,i.Z)(e),[l]);return h&&h(n),n})):(w([l]),h&&h([l]))))},children:[(0,c.jsx)(d.Z,{checked:(null===e||void 0===e?void 0:e._id)&&P.includes(null===e||void 0===e?void 0:e._id)||n===b,size:"22px",disabled:t}),(0,c.jsx)(u.x,{children:null===e||void 0===e?void 0:e.label})]},"m-opt_".concat(e.value))}))})}},1186:function(e,n,o){o.d(n,{f:function(){return t}});var i=o(6522),t=[{top:{name:"".concat((0,i.t)("label"),"/").concat((0,i.t)("name")),getData:function(e){return(null===e||void 0===e?void 0:e.label)||"".concat((null===e||void 0===e?void 0:e.name)||"---"," ").concat((null===e||void 0===e?void 0:e.secondName)||"---")}},bottom:{name:"\u0406\u041f\u041d/\u0404\u0414\u0420\u041f\u041e\u0423",getData:function(e){return(e.personalTaxCode||"---")+"/"+(e.taxCode||"---")}},width:"240px",action:"doubleDataWithAvatar"},{top:{name:"\u0422\u0438\u043f",path:"type",getData:function(e){return null===e||void 0===e?void 0:e.type}},bottom:{name:"\u0421\u0442\u0430\u0442\u0443\u0441",path:"status"},width:"120px",action:"valueByPath"},{top:{name:"\u0415\u043c\u0435\u0439\u043b",path:"email",uppercase:!1},bottom:{name:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",path:"phone"},width:"170px",action:"contacts"},{top:{name:"\u041b\u043e\u043a\u0430\u0446\u0456\u044f"},width:"170px",action:"valueByPath"},{top:{name:"\u0422\u0435\u0433\u0438",path:"tags"},width:"200px",action:"tags"},{top:{name:"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440",path:"description"},width:"170px",action:"valueByPath"},{top:{name:"\u0421\u0442\u0432\u043e\u0440\u0435\u043d\u043e",align:"center",path:"createdAt"},bottom:{name:"\u041e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",align:"center",path:"updatedAt"},width:"150px",action:"dateSimple"}]}}]);
//# sourceMappingURL=265.812d616f.chunk.js.map