"use strict";(self.webpackChunkcounter_app_ts=self.webpackChunkcounter_app_ts||[]).push([[800],{5800:function(e,t,n){n.r(t),n.d(t,{useCustomersTableSettings:function(){return P}});var i,r=n(168),a=n(1413),o=n(9439),l=n(9294),d=n(8495),u=n(2360),c=n(2791),s=n(9322),f=n(1186),h=n(2437),m=n(7348),p=n(5188),v=n(7665),Z=n(763),b=n.n(Z),x=n(2655),g=n(1383),S=n(3329),j=u.ZP.div(i||(i=(0,r.Z)(["\n  ","\n"])),d.VU);t.default=function(e){var t=(0,c.useState)(!1),n=(0,o.Z)(t,2),i=n[0],r=n[1],d=(0,p.kw)(),u=(0,m.I6)(),Z=(0,c.useState)(),P=(0,o.Z)(Z,2),y=P[0],C=P[1],w=(0,c.useState)(),_=(0,o.Z)(w,2),k=_[0],q=_[1],I=(0,h.xc)()[h.EJ.customers],D=(0,c.useMemo)((function(){return{tableData:u.customers,tableTitles:f.f,isFilter:!0,isSearch:!0,footer:!1,checkBoxes:!0,actionsCreator:function(e){var t=null===e||void 0===e?void 0:e.selectedRow;return[{icon:"refresh",onClick:function(){I.getAll({data:{refresh:!0,params:{}}})}},{separator:!0},{icon:"edit",type:"onlyIcon",onClick:function(){var e=d.open({ModalChildren:v.Z,modalChildrenProps:{defaultState:u.customers.find((function(e){return e._id===(null===t||void 0===t?void 0:t._id)})),onSubmit:function(n){I.update({data:{data:{data:(0,x.vg)(n),_id:null===t||void 0===t?void 0:t._id},refresh:!0},onSuccess:function(t,n){console.log("edit customer P",t),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}})}}})}},{separator:!0},{icon:"plus",type:"onlyIconFilled",onClick:function(){var e=d.open({ModalChildren:v.Z,modalChildrenProps:{withReferer:!0,onSubmit:function(t){var n;I.create({data:{data:null!==t&&void 0!==t&&null!==(n=t.referrer)&&void 0!==n&&n._id?(0,x.vg)(t):(0,x.vg)(b().omit(t,["referrer"]))},onSuccess:function(t){g.kl.success("New user created: ".concat(null===t||void 0===t?void 0:t.email)),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}})}}})}}]},onFilterSubmit:function(e){q(e)},handleTableSort:function(e,t){C({dataPath:e.dataPath,sortOrder:t})}}}),[d,I,u.customers]);return(0,c.useEffect)((function(){y||k||y||k||0===u.customers.length&&I.getAll({data:{refresh:!0,params:{}},onLoading:r})}),[k,I,y,u.customers.length]),(0,S.jsx)(s.default,{path:e.path,children:(0,S.jsx)(j,{children:(0,S.jsx)(l.ZP,(0,a.Z)((0,a.Z)({},D),{},{isLoading:i}))})})};var P=function(){var e=(0,c.useState)(),t=(0,o.Z)(e,2),n=t[0],i=t[1],r=(0,c.useState)(),a=(0,o.Z)(r,2),l=a[0],d=a[1],u=(0,c.useMemo)((function(){return{isFilter:!0,isSearch:!0,footer:!1,checkBoxes:!0,onFilterSubmit:function(e){d(e)},handleTableSort:function(e,t){i({dataPath:e.dataPath,sortOrder:t})}}}),[]);return(0,c.useEffect)((function(){}),[l,n,u]),{tableConfig:u,sortParams:n,filterParams:l}}},8495:function(e,t,n){n.d(t,{SI:function(){return u},VU:function(){return d}});var i,r,a,o=n(168),l=n(2360),d=(0,l.iv)(i||(i=(0,o.Z)(["\n  grid-column: 1/13;\n  grid-row: 1/13;\n"]))),u=(0,l.iv)(r||(r=(0,o.Z)(["\n  width: 100%;\n  height: 100%;\n"])));(0,l.iv)(a||(a=(0,o.Z)(["\n  outline: 1px solid tomato;\n"])))},7665:function(e,t,n){n.d(t,{Z:function(){return E}});var i,r=n(168),a=n(1413),o=n(4925),l=function(e){return e.facebook="facebook",e.instagram="instagram",e.referralSystem="referralSystem",e.another="another",e}({}),d=n(9656),u=n(6522),c=n(2360),s=n(8095),f=n(4990),h=n(6681),m=n(9964),p=n(457),v=n(1134),Z=n(8302),b=n(1392),x=n(8553),g=n(2791),S=n(1383),j=n(5611),P=n(763),y=n.n(P),C=n(3329),w=["defaultState","withReferer","onSubmit"],_=["register","setValue","handleSubmit","watch"],k=S.E4.isDevMode(),q=(0,x.H1)(l),I=(0,c.ZP)(s.ZP)(i||(i=(0,r.Z)([""]))),D=function(e){var t=e.form,n=[{name:"first",label:(0,u.t)("First name"),required:!0},{name:"second",label:(0,u.t)("Second name")},{name:"middle",label:(0,u.t)("Middle name")}];return(0,C.jsx)(C.Fragment,{children:n.map((function(e){var n=e.name,i=e.label,r=e.required;return(0,C.jsx)(f.Z,{label:i,required:r,children:(0,C.jsx)(h.ZP,(0,a.Z)((0,a.Z)({placeholder:i},t.register("name.".concat(n),{required:r})),{},{required:r}))},"name_".concat(n))}))})},T=function(e){var t=e.form,n=[{name:"base",label:(0,u.t)("Label"),required:!0},{name:"print",label:(0,u.t)("Print label")}];return(0,C.jsx)(C.Fragment,{children:n.map((function(e){var n=e.name,i=e.label,r=e.required;return(0,C.jsx)(f.Z,{label:i,required:r,children:(0,C.jsx)(h.ZP,(0,a.Z)((0,a.Z)({placeholder:i},t.register("label.".concat(n),{required:r})),{},{required:r}))},"name_".concat(n))}))})},E=function(e){var t=e.defaultState,n=e.withReferer,i=e.onSubmit,r=(0,o.Z)(e,w),c=(0,v.cI)({defaultValues:(0,a.Z)((0,a.Z)({},t),{},{businessType:j.G.company})}),x=c.register,S=c.setValue,P=c.handleSubmit,E=c.watch,F=(0,o.Z)(c,_),R=E(),B=(0,g.useMemo)((function(){return!(null===t||void 0===t||!t.email)}),[null===t||void 0===t?void 0:t.email]);return(0,C.jsx)(d.Z,(0,a.Z)((0,a.Z)({fillHeight:!0},r),{},{title:r.title?r.title:(0,u.t)("Create customer"),onSubmit:P((function(e){i&&i(y().omit(e,B?["engagementSource","email"]:["engagementSource"]))})),children:(0,C.jsxs)(I,{padding:"0 8px 8px",children:[(0,C.jsx)(f.Z,{label:(0,u.t)("type"),required:!0,children:(0,C.jsx)(m.Z,{options:p.Wk,onSelect:function(e){S("businessType",null===e||void 0===e?void 0:e.value)}})}),R.businessType!==j.G.person&&(0,C.jsx)(T,{form:(0,a.Z)({register:x,setValue:S,handleSubmit:P,watch:E},F)}),R.businessType!==j.G.company&&(0,C.jsx)(D,{form:(0,a.Z)({register:x,setValue:S,handleSubmit:P,watch:E},F)}),(0,C.jsx)(f.Z,{label:(0,u.t)("email"),disabled:B,required:!0,children:(0,C.jsx)(h.ZP,(0,a.Z)((0,a.Z)({placeholder:(0,u.t)("email"),type:"email"},x("email",{required:!0})),{},{disabled:B,required:!0}))}),(0,C.jsx)(f.Z,{label:(0,u.t)("phone"),children:(0,C.jsx)(h.ZP,(0,a.Z)({placeholder:(0,u.t)("phone")},x("phone")))}),R.businessType!==j.G.company&&(0,C.jsx)(f.Z,{label:(0,u.t)("Birth date"),children:(0,C.jsx)(h.ZP,(0,a.Z)((0,a.Z)({placeholder:(0,u.t)("Birth date")},x("birthDate")),{},{type:"datetime-local"}))}),n&&k&&(0,C.jsx)(f.Z,{label:(0,u.t)("Referrer id"),children:(0,C.jsx)(h.ZP,(0,a.Z)({placeholder:(0,u.t)("Referrer id")},x("referrer._id")))}),(0,C.jsx)(f.Z,{label:(0,u.t)("Source"),children:(0,C.jsx)(b.Z,{disabled:!0,options:q,currentOption:{value:null===R||void 0===R?void 0:R.engagementSource},onChangeIndex:function(e){S("engagementSource",q[e].value)}})}),(null===R||void 0===R?void 0:R.engagementSource)===l.referralSystem&&(0,C.jsxs)(s.ZP,{gap:8,fillWidth:!0,children:[(0,C.jsx)(f.Z,{label:(0,u.t)("Referrer"),required:!0,children:(0,C.jsx)(h.ZP,{placeholder:(0,u.t)("Referrer"),type:"email",required:!0})}),(0,C.jsxs)(s.ZP,{fxDirection:"row",fillWidth:!0,gap:8,padding:"8px 0",children:[(0,C.jsx)(Z.Z,{variant:"defOutlinedSmall",children:(0,u.t)("Clear referrer")}),(0,C.jsx)(Z.Z,{variant:"outlinedSmall",flex:1,children:(0,u.t)("Select referrer")})]})]})]})}))}},1392:function(e,t,n){var i=n(3433),r=n(9439),a=n(2791),o=n(4538),l=n(8095),d=n(3855),u=n(6492),c=n(3329);t.Z=function(e){var t=e.options,n=e.onChangeIndex,s=e.currentIndex,f=e.currentOption,h=e.multiple,m=e.onChange,p=e.value,v=e.disabled,Z=e.disabledCheck,b=(0,a.useState)(0),x=(0,r.Z)(b,2),g=x[0],S=x[1],j=(0,a.useState)([]),P=(0,r.Z)(j,2),y=P[0],C=P[1];return(0,a.useEffect)((function(){o.sr.isUnd(s)||S(s)}),[s]),(0,a.useEffect)((function(){h||o.sr.isUnd(f)||o.sr.isUnd(t)||S(t.findIndex((function(e){return(null===e||void 0===e?void 0:e.value)===(null===f||void 0===f?void 0:f.value)||(null===e||void 0===e?void 0:e._id)===(null===f||void 0===f?void 0:f._id)})))}),[f,h,t]),(0,a.useEffect)((function(){h&&!o.sr.isUnd(p)&&o.sr.isArray(p)&&C(p)}),[h,p]),(0,c.jsx)(l.ZP,{fillWidth:!0,gap:8,children:null===t||void 0===t?void 0:t.map((function(e,t){var r=Z?Z(e,t):v;return(0,c.jsxs)(l.ZP,{fxDirection:"row",gap:8,padding:"2px 4px",alignItems:"center",style:{opacity:r?.7:1,pointerEvents:r?"none":"all"},onClick:function(){var a;r||(!function(e){S(e),n&&n(e)}(t),(null===e||void 0===e?void 0:e._id)&&(a=null===e||void 0===e?void 0:e._id,h?C((function(e){var t=y.includes(a)?e.filter((function(e){return e!==a})):[].concat((0,i.Z)(e),[a]);return m&&m(t),t})):(C([a]),m&&m([a]))))},children:[(0,c.jsx)(d.Z,{checked:(null===e||void 0===e?void 0:e._id)&&y.includes(null===e||void 0===e?void 0:e._id)||t===g,size:"22px",disabled:r}),(0,c.jsx)(u.x,{children:null===e||void 0===e?void 0:e.label})]},"m-opt_".concat(e.value))}))})}},1186:function(e,t,n){n.d(t,{f:function(){return r}});var i=n(6522),r=[{top:{name:"".concat((0,i.t)("label"),"/").concat((0,i.t)("name")),getData:function(e){var t,n=null!==(t=e.label)&&void 0!==t?t:e.name;return n?Object.values(n).map((function(e){return null!==e&&void 0!==e?e:""})).join(" "):"---"}},bottom:{name:"\u0406\u041f\u041d/\u0404\u0414\u0420\u041f\u041e\u0423",getData:function(e){var t,n;return((null===(t=e.taxCode)||void 0===t?void 0:t.personal)||"---")+"/"+((null===(n=e.taxCode)||void 0===n?void 0:n.corp)||"---")}},width:"240px",action:"doubleDataWithAvatar"},{top:{name:"\u0422\u0438\u043f",getData:function(e){return null===e||void 0===e?void 0:e.type}},bottom:{name:"\u0421\u0442\u0430\u0442\u0443\u0441",path:"status"},width:"120px",action:"valueByPath"},{top:{name:"\u0415\u043c\u0435\u0439\u043b",path:"email",uppercase:!1},bottom:{name:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",path:"phone"},width:"170px",action:"contacts"},{top:{name:"\u041b\u043e\u043a\u0430\u0446\u0456\u044f"},width:"170px",action:"valueByPath"},{top:{name:"\u0422\u0435\u0433\u0438",path:"tags"},width:"200px",action:"tags"},{top:{name:"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440",path:"description"},width:"170px",action:"valueByPath"},{top:{name:"\u0421\u0442\u0432\u043e\u0440\u0435\u043d\u043e",align:"center",path:"createdAt"},bottom:{name:"\u041e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",align:"center",path:"updatedAt"},width:"150px",action:"dateSimple"}]}}]);
//# sourceMappingURL=800.3f163dd8.chunk.js.map