"use strict";(self.webpackChunkmia_erp=self.webpackChunkmia_erp||[]).push([[882,264],{882:function(e,o,t){t.r(o),t.d(o,{default:function(){return L},useOffersTableSettings:function(){return P}});var n,a=t(9439),i=t(168),r=t(1413),d=t(8589),l=t(8495),f=t(2360),s=t(2791),c=t(6931),u=t(7348),h=function(){return[]},v=t(3665),p=t(1819),m=t(6522),g=t(7264),x=t(1494),b=t(2410),y=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).loaders,o=(0,p.xc)().get(p.EJ.offers),t=(0,b.x)(),n=(0,v.f9)(),a=(0,u.i7)().dataMap;return(0,s.useCallback)((function(i){var r,d=null===(r=i.selectedRow)||void 0===r?void 0:r._id,l=d?null===a||void 0===a?void 0:a[d]:void 0;return[{name:"refreshData",title:(0,m.t)("Refresh data"),icon:"refresh",type:"onlyIcon",onClick:function(){o.getAll({data:{refresh:!0},onLoading:e?e.onLoading("refresh"):i.onRefresh})}},{separator:!0},{name:"review",title:"\u041f\u0435\u0440\u0435\u0433\u043b\u044f\u0434 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0443",icon:"openInNew",disabled:!d,type:"onlyIcon",navTo:"/app/".concat(t.params.permissionId,"/offers/")+d},{name:"edit",title:"\u0417\u043c\u0456\u043d\u0438\u0442\u0438",icon:"edit",iconSize:"90%",type:"onlyIcon",disabled:!d,onClick:function(){l?n.create(g.default,{offer:l}):d&&o.getOne({data:{data:{params:{_id:d}}},onLoading:e?e.onLoading("offer"):i.onRefresh,onSuccess:function(e){var o=e.data;n.create(g.default,{offer:o})}})}},{name:"copy",title:"\u041a\u043e\u043f\u0456\u044e\u0432\u0430\u0442\u0438",icon:"copy",iconSize:"90%",type:"onlyIcon",disabled:!l,onClick:function(){l&&n.create(g.default,{offer:l,copy:!0})}},{name:"archiveProduct",title:"\u0410\u0440\u0445\u0456\u0432",icon:"archive",iconSize:"90%",type:"onlyIcon",disabled:!0},{separator:!0},{name:"createProduct",title:"\u041d\u043e\u0432\u0438\u0439",icon:"plus",iconSize:"90%",type:"onlyIconFilled",disabled:!1,onClick:function(){n.create(x.default)}}]}),[e,n,t,o,a])},D=t(4897),j=t(9541),S=t(7824),_=t(959),C=t(3329),Z=f.ZP.div(n||(n=(0,i.Z)(["\n  ","\n"])),l.VU),L=function(e){var o=P({}),t=o.tableConfig,n=o.isLoading;return(0,C.jsx)(c.default,{path:e.path,children:(0,C.jsx)(Z,{children:(0,C.jsx)(d.ZP,(0,r.Z)((0,r.Z)({},t),{},{showFooter:!0,isLoading:null===n||void 0===n?void 0:n.offers}))})})},P=function(e){var o=e.searchState,t=e.sortState,n=(0,j.J)({offers:{content:"Refreshing..."},refresh:{content:"Refreshing..."},offer:{content:"Refreshing..."}}),i=n.onLoading,r=n.isLoading,d=(0,p.xc)().get(S.d.offers).getAll,l=(0,u.i7)(),f=h(),c=y({loaders:n}),v=(0,s.useState)(t),m=(0,a.Z)(v,2),g=m[0],x=m[1],b=(0,s.useState)(o),C=(0,a.Z)(b,2),Z=C[0],L=C[1],P=(0,s.useMemo)((function(){return{onSubmitSearch:function(e){if(e.search){var o,t={},n=null===(o=e.param)||void 0===o?void 0:o.dataPath;n&&e.search&&(0,_.P_)(n,e.search,t,{mutation:!0}),L(e),d({params:t,onLoading:i("offers")}).then()}else d({onLoading:i("offers")}).then()},tableData:l.list,tableTitles:D.Y5,searchParams:D.Dr,sortParams:D.Cs,filterSelectors:f,hasFilter:!0,hasSearch:!0,showFooter:!1,checkBoxes:!0,actionsCreator:c,onTableSortChange:function(e,o){x({param:e,order:o}),console.log({param:e,order:o}),d({params:{sortOrder:o,sortPath:e.dataPath},onLoading:i("offers")}).then()}}}),[c,f,d,i,l.list]);return(0,s.useEffect)((function(){0===l.list.length&&d({onLoading:i("offers")})}),[]),{tableConfig:P,isLoading:r,sortParams:g,searchParams:Z}}},8495:function(e,o,t){t.d(o,{SI:function(){return f},VU:function(){return l}});var n,a,i,r=t(168),d=t(2360),l=(0,d.iv)(n||(n=(0,r.Z)(["\n  grid-column: 1/13;\n  grid-row: 1/13;\n"]))),f=(0,d.iv)(a||(a=(0,r.Z)(["\n  width: 100%;\n  height: 100%;\n"])));(0,d.iv)(i||(i=(0,r.Z)(["\n  outline: 1px solid tomato;\n"])))},7264:function(e,o,t){t.r(o);var n=t(1413),a=t(9420),i=t(8050),r=t(6522),d=t(959),l=t(3691),f=t(9306),s=t(3007),c=t(8095),u=t(6653),h=t(6492),v=t(9541),p=t(7578),m=t(8160),g=t(5888),x=t(2989),b=t(7608),y=t(5248),D=t(3329);o.default=function(e){var o,t,j,S,_,C,Z,L,P,I,k=e.onClose,w=e.offer,R=e.copy,V=(0,x.G2)(w),O=(0,v.J)({offer_refresh:{content:"Refreshing..."},offer_update:{content:"Updating..."}},{formData:V?(0,d.xT)(V):{type:l.i.GOODS}}),T=O.setData,z=O.state,A=R?null===(o=z.formData)||void 0===o?void 0:o._id:null===V||void 0===V?void 0:V._id;return V?(0,D.jsx)(i.Z,{fillHeight:!0,title:R?(0,r.t)("Copy offer"):(0,r.t)("Update offer"),onClose:k,children:(0,D.jsx)(p.f4,{value:O,children:null!==(t=O.isLoading)&&void 0!==t&&t.offer?(0,D.jsxs)(c.ZP,{fillWidth:!0,padding:"24px",alignItems:"center",gap:16,children:[(0,D.jsx)(u.$,{size:52}),(0,D.jsx)(h.x,{children:(0,r.t)("Loading info about offer...")})]}):(0,D.jsxs)(c.ZP,{padding:"0 0 16px",children:[(0,D.jsx)(s.B,{_id:A,edit:!R,type:null===(j=z.formData)||void 0===j?void 0:j.type,defaultValues:null===z||void 0===z?void 0:z.formData,onSuccess:function(e){var o=e.data;T("formData",R?(0,n.Z)((0,n.Z)({},(0,d.xT)(o)),{},{_id:o._id}):(0,d.xT)(o))}}),(0,D.jsx)(b.A,{_id:A,offer:V,defaultValues:null===(S=z.formData)||void 0===S?void 0:S.categories,disabled:!z.formData}),(0,D.jsx)(m.R,{_id:A,offer:V,defaultValues:null===(_=z.formData)||void 0===_?void 0:_.properties,disabled:!z.formData}),(0,D.jsx)(y.L,{expandable:!0,isOpen:!1,offer:V,defaultState:null===V||void 0===V?void 0:V.price,price:null===V||void 0===V?void 0:V.price,title:(0,r.t)("Price")}),(0,D.jsx)(g.A,{offer:V,defaultValues:null===z||void 0===z||null===(C=z.formData)||void 0===C?void 0:C.images,disabled:!(null!==z&&void 0!==z&&z.formData),_id:A}),(0,D.jsx)(a.A,{offer:V,defaultValues:null===(Z=z.formData)||void 0===Z?void 0:Z.dimensions,disabled:R?!(null!==(L=z.formData)&&void 0!==L&&L._id&&z.formData):!A,_id:A}),(0,D.jsx)(f.n,{offer:V,defaultValues:null===(P=z.formData)||void 0===P?void 0:P.measurement,disabled:R?!(null!==(I=z.formData)&&void 0!==I&&I._id&&z.formData):!A,_id:A})]})})}):(0,D.jsx)(i.Z,{title:R?(0,r.t)("Copy offer"):(0,r.t)("Update offer"),fillHeight:!0,children:(0,D.jsx)(c.ZP,{fillWidth:!0,fillHeight:!0,padding:"26px",alignItems:"center",justifyContent:"center",children:(0,D.jsx)(h.x,{$size:16,$weight:600,children:(0,r.t)("Offer not found")})})})}}}]);
//# sourceMappingURL=882.17dd6dd3.chunk.js.map