"use strict";(self.webpackChunkcounter_app_ts=self.webpackChunkcounter_app_ts||[]).push([[643,264],{8643:function(t,a,e){e.r(a),e.d(a,{default:function(){return I},useProductsTableSettings:function(){return Z}});var o,n=e(168),l=e(1413),i=e(9439),r=e(400),d=e(8495),u=e(2360),s=e(2791),c=e(6931),f=e(7348),h=e(2913),p=function(){return[]},m=e(5188),v=e(7689),b=e(1819),g=e(6522),P=e(7264),y=e(1494),x=function(){var t=(0,b.xc)()[b.EJ.offers],a=(0,v.s0)(),e=(0,m.f9)();return(0,s.useCallback)((function(o){var n,l,i;return[{name:"refreshData",title:(0,g.t)("Refresh data"),icon:"refresh",type:"onlyIcon",onClick:function(){t.getAll({data:{refresh:!0},onLoading:o.onRefresh})}},{separator:!0},{name:"reviewProduct",title:"\u041f\u0435\u0440\u0435\u0433\u043b\u044f\u0434 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0443",icon:"openInNew",disabled:!(null!==(n=o.selectedRow)&&void 0!==n&&n._id),type:"onlyIcon",onClick:function(){var t,e;(null===(t=o.selectedRow)||void 0===t?void 0:t._id)&&a(null===(e=o.selectedRow)||void 0===e?void 0:e._id)}},{name:"editProduct",title:"\u0417\u043c\u0456\u043d\u0438\u0442\u0438",icon:"edit",iconSize:"90%",type:"onlyIcon",disabled:!(null!==o&&void 0!==o&&null!==(l=o.selectedRow)&&void 0!==l&&l._id),onClick:function(){var t,a;(null===o||void 0===o||null===(t=o.selectedRow)||void 0===t?void 0:t._id)&&e.openModal({ModalChildren:P.default,modalChildrenProps:{title:"\u0417\u043c\u0456\u043d\u0438\u0442\u0438",_id:null===o||void 0===o||null===(a=o.selectedRow)||void 0===a?void 0:a._id,fillHeight:!0}})}},{name:"copyProduct",title:"\u041a\u043e\u043f\u0456\u044e\u0432\u0430\u0442\u0438",icon:"copy",iconSize:"90%",type:"onlyIcon",disabled:!(null!==o&&void 0!==o&&null!==(i=o.selectedRow)&&void 0!==i&&i._id),onClick:function(){var t,a;(null===o||void 0===o||null===(t=o.selectedRow)||void 0===t?void 0:t._id)&&e.openModal({ModalChildren:P.default,modalChildrenProps:{_id:null===o||void 0===o||null===(a=o.selectedRow)||void 0===a?void 0:a._id,copy:!0}})}},{name:"archiveProduct",title:"\u0410\u0440\u0445\u0456\u0432",icon:"archive",iconSize:"90%",type:"onlyIcon",disabled:!0},{separator:!0},{name:"createProduct",title:"\u041d\u043e\u0432\u0438\u0439",icon:"plus",iconSize:"90%",type:"onlyIconFilled",disabled:!1,onClick:function(){e.open({ModalChildren:y.default})}}]}),[e,a,t])},C=e(8828),_=e(4961),w=e(9541),S=e(3329),D=u.ZP.div(o||(o=(0,n.Z)(["\n  ","\n"])),d.VU),I=function(t){var a=(0,w.J)(),e=a.onLoading,o=a.isLoading,n=(0,h.Z)().getAll,d=(0,f.nr)(),u=p(),m=x(),v=(0,s.useState)(),b=(0,i.Z)(v,2),g=b[0],P=b[1],y=(0,s.useState)(),_=(0,i.Z)(y,2),I=_[0],Z=_[1],j=(0,s.useMemo)((function(){return{filterSelectors:u,isFilter:!0,isSearch:!0,footer:!1,checkBoxes:!0,actionsCreator:m,onFilterSubmit:function(t){Z(t),n({data:{refresh:!0,query:{filterParams:t,sortParams:g}},onLoading:e("offers")}).then()},handleTableSort:function(t,a){P({dataPath:t.dataPath,sortOrder:a}),n({data:{refresh:!0,query:{sortParams:{dataPath:t.dataPath,sortOrder:a},filterParams:I}},onLoading:e("offers")}).then()}}}),[m,I,u,n,e,g]);return(0,s.useEffect)((function(){var t;null!==(t=d.list)&&void 0!==t&&t.length||g||I||g||I||n({data:{refresh:!0},onLoading:e("offers")})}),[]),(0,S.jsx)(c.default,{path:t.path,children:(0,S.jsx)(D,{children:(0,S.jsx)(r.ZP,(0,l.Z)((0,l.Z)({},j),{},{tableData:d.list,tableTitles:C.Y5,isLoading:null===o||void 0===o?void 0:o.offers}))})})},Z=function(){var t=(0,h.Z)(),a=(0,f.nr)(),e=t.getAll,o=p(),n=x(),l=(0,s.useState)(!1),r=(0,i.Z)(l,2),d=r[0],u=r[1],c=(0,s.useState)(),m=(0,i.Z)(c,2),v=m[0],b=m[1],g=(0,s.useState)(),P=(0,i.Z)(g,2),y=P[0],w=P[1],S=(0,s.useMemo)((function(){return{tableData:a.list,tableTitles:C.Y5,tableSortParams:_.wo.filter((function(t){return t.sort})),filterSelectors:o,isFilter:!0,isSearch:!0,footer:!1,checkBoxes:!0,actionsCreator:n,onFilterSubmit:function(t){w(t),e({data:{refresh:!0,query:{filterParams:t,sortParams:v}},onLoading:u}).then()},handleTableSort:function(t,a){b({dataPath:t.dataPath,sortOrder:a}),e({data:{refresh:!0,query:{sortParams:{dataPath:t.dataPath,sortOrder:a},filterParams:y}},onLoading:u}).then()}}}),[n,y,o,e,v,a.list]);return(0,s.useEffect)((function(){v||y||v||y||0===a.list.length&&e({data:{refresh:!0},onLoading:u})}),[y,e,d,v,a.list.length,S]),{tableConfig:S,isLoading:d,sortParams:v,filterParams:y}}},8495:function(t,a,e){e.d(a,{SI:function(){return u},VU:function(){return d}});var o,n,l,i=e(168),r=e(2360),d=(0,r.iv)(o||(o=(0,i.Z)(["\n  grid-column: 1/13;\n  grid-row: 1/13;\n"]))),u=(0,r.iv)(n||(n=(0,i.Z)(["\n  width: 100%;\n  height: 100%;\n"])));(0,r.iv)(l||(l=(0,i.Z)(["\n  outline: 1px solid tomato;\n"])))},7264:function(t,a,e){e.r(a);var o=e(1413),n=e(6600),l=e(8050),i=e(6522),r=e(7653),d=e(2791),u=e(3691),s=e(4826),c=e(9701),f=e(8095),h=e(6653),p=e(6492),m=e(9953),v=e(3383),b=e(9541),g=e(7578),P=e(7109),y=e(2913),x=e(2353),C=e(4716),_=e(3023),w=e(3329);a.default=function(t){var a,e,S,D,I,Z,j,O,R,L,E,k,B,A=t.onClose,T=t._id,M=t.copy,V=(0,C.G2)({id:T}),F=(0,y.Z)(),N=(0,b.J)({offer_refresh:{content:"Refreshing..."},offer_update:{content:"Updating..."}},{formData:V?(0,r.xT)(V):{type:u.iv.GOODS}}),q=N.setData,z=N.state,U=M?null===(a=z.formData)||void 0===a?void 0:a._id:T,H=(0,C.xj)();return(0,d.useEffect)((function(){F.getProductFullInfo({data:{_id:T},onSuccess:N.onSuccess("offer_refresh",(function(t){M&&(t._id=""),q("formData",(0,r.xT)(t)),H.push({query:{offerId:T}})})),onLoading:N.onLoading("offer_refresh")})}),[T,M]),(0,w.jsx)(l.Z,{fillHeight:!0,title:M?(0,i.t)("Copy offer"):(0,i.t)("Update offer"),onClose:A,extraHeader:(0,w.jsx)(m.Z,{filterOptions:v.jI,defaultValue:null!==(e=null===z||void 0===z||null===(S=z.formData)||void 0===S?void 0:S.type)&&void 0!==e?e:void 0,preventDefault:!0,onOptSelect:function(t){q("formData",(function(a){return(0,o.Z)((0,o.Z)({},a),{},{type:t.value})}))}}),children:(0,w.jsx)(g.f4,{value:N,children:null!==(D=N.isLoading)&&void 0!==D&&D.offer?(0,w.jsxs)(f.ZP,{fillWidth:!0,padding:"24px",alignItems:"center",gap:16,children:[(0,w.jsx)(h.$,{size:52}),(0,w.jsx)(p.x,{children:(0,i.t)("Loading info about offer...")})]}):(0,w.jsxs)(f.ZP,{padding:"0 8px 16px",children:[(0,w.jsx)(c.B,{_id:U,edit:!M,type:null===(I=z.formData)||void 0===I?void 0:I.type,defaultValues:null===z||void 0===z?void 0:z.formData,onSuccess:function(t){q("formData",M?(0,o.Z)((0,o.Z)({},(0,r.xT)(t)),{},{_id:t._id}):(0,r.xT)(t))}}),(0,w.jsx)(_.A,{_id:U,offer:V,defaultValues:null===(Z=z.formData)||void 0===Z?void 0:Z.categories,disabled:!z.formData}),(0,w.jsx)(P.R,{_id:U,offer:V,defaultValues:null===(j=z.formData)||void 0===j?void 0:j.properties,disabled:!z.formData}),(0,w.jsx)(n.A,{offer:V,defaultValues:null===(O=z.formData)||void 0===O?void 0:O.dimensions,disabled:M?!(null!==(R=z.formData)&&void 0!==R&&R._id&&z.formData):!T,_id:U}),(0,w.jsx)(s.n,{offer:V,defaultValues:null===(L=z.formData)||void 0===L?void 0:L.measurement,disabled:M?!(null!==(E=z.formData)&&void 0!==E&&E._id&&z.formData):!T,_id:U}),(0,w.jsx)(x.A,{offer:V,defaultValues:null===z||void 0===z||null===(k=z.formData)||void 0===k?void 0:k.images,disabled:!(null!==z&&void 0!==z&&z.formData),_id:M?null===z||void 0===z||null===(B=z.formData)||void 0===B?void 0:B._id:T})]})})})}},4961:function(t,a,e){e.d(a,{MN:function(){return i},wo:function(){return l},yV:function(){return n}});var o=e(6522),n=((0,o.t)("date"),(0,o.t)("time"),(0,o.t)("type"),(0,o.t)("status"),(0,o.t)("amount"),(0,o.t)("countIn"),(0,o.t)("subCountIn"),(0,o.t)("countOut"),(0,o.t)("subCountOut"),(0,o.t)("category"),(0,o.t)("subCategory"),[{top:{name:"\u0414\u0430\u0442\u0430",align:"center",path:"eventDate"},bottom:{name:"\u0427\u0430\u0441",align:"center"},width:"90px",action:"dateSimple"},{top:{name:"\u0422\u0438\u043f",align:"start",path:"type"},bottom:{name:"\u0421\u0442\u0430\u0442\u0443\u0441",align:"start",path:"status"},width:"100px",action:"status"},{top:{name:(0,o.t)("amount"),align:"end",path:"amount"},bottom:{name:"\u0412\u0430\u043b\u044e\u0442\u0430",align:"end",path:"currency"},width:"120px",action:"numberWithSpaces"},{top:{name:(0,o.t)("countOut"),align:"start",path:"countOut.label"},bottom:{name:(0,o.t)("subCountOut"),align:"start",path:"subCountOut.label"},width:"190px",action:"valueByPath"},{top:{name:(0,o.t)("countIn"),align:"start",path:"countIn.label"},bottom:{name:(0,o.t)("subCountIn"),align:"start",path:"subCountIn.label"},width:"190px",action:"valueByPath"},{top:{name:(0,o.t)("category"),align:"start",path:"category.label"},bottom:{name:(0,o.t)("subCategory"),align:"start",path:"subCategory.label"},width:"190px",action:"valueByPath"},{top:{name:"\u0406\u043d\u0432\u043e\u0439\u0441",align:"start",path:"invoice.label"},bottom:{name:"\u041d\u043e\u043c\u0435\u0440",align:"start",path:"invoice.number"},width:"150px",action:"valueByPath"},{top:{name:"\u041e\u043f\u043b\u0430\u0442\u0430",align:"start",path:"payment.label"},bottom:{name:"\u041d\u043e\u043c\u0435\u0440",align:"start",path:"payment.number"},width:"150px",action:"valueByPath"},{top:{name:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",align:"start",path:"contractor.name"},bottom:{name:"\u0422\u0438\u043f",align:"start",path:"contractor.type"},width:"150px",action:"valueByPath"},{top:{name:"\u0414\u0456\u044f\u043b\u044c\u043d\u0456\u0441\u0442\u044c",align:"start",path:"activity.label"},width:"150px",action:"valueByPath"},{top:{name:"\u041f\u0440\u043e\u0435\u043a\u0442",align:"start",path:"project.label"},width:"150px",action:"valueByPath"},{top:{name:"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440",align:"start",path:"comment"},width:"150px",action:"valueByPath"},{top:{name:"\u0421\u0442\u0432\u043e\u0440\u0438\u0432",align:"start",path:"author.email"},bottom:{name:"\u041e\u043d\u043e\u0432\u0438\u0432",align:"start",path:"editor.email"},width:"150px",action:"valueByPath"},{top:{name:"\u0421\u0442\u0432\u043e\u0440\u0435\u043d\u043e",align:"center",path:"createdAt"},bottom:{name:"\u041e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",align:"center",path:"updatedAt"},width:"150px",action:"dateDbl"}]),l=[{label:"\u0414\u0430\u0442\u0430",dataPath:"eventDate",filter:!1,search:!1,sort:!0},{label:(0,o.t)("type"),dataPath:"type",filter:!1,search:!0,sort:!0},{label:(0,o.t)("amount"),dataPath:"amount",filter:!1,search:!0,sort:!0},{label:"\u041e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",dataPath:"createdAt",filter:!1,search:!1,sort:!0},{label:"\u0421\u0442\u0432\u043e\u0440\u0435\u043d\u043e",dataPath:"updatedAt",filter:!1,search:!1,sort:!0},{label:(0,o.t)("countIn"),dataPath:"countIn.label",filter:!1,search:!0,sort:!0},{label:(0,o.t)("subCountIn"),dataPath:"subCountIn.label",filter:!1,search:!0,sort:!0},{label:(0,o.t)("countOut"),dataPath:"countOut.label",filter:!1,search:!0,sort:!0},{label:(0,o.t)("subCountOut"),dataPath:"subCountOut.label",filter:!1,search:!0,sort:!0},{label:(0,o.t)("category"),dataPath:"category.label",filter:!1,search:!0,sort:!0},{label:(0,o.t)("subCategory"),dataPath:"subCategory.label",filter:!1,search:!0,sort:!0},{label:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",dataPath:"contractor.name",filter:!1,search:!0,sort:!0},{label:(0,o.t)("project"),dataPath:"project.label",filter:!1,search:!0,sort:!0},{label:"\u041c\u0456\u0442\u043a\u0430",dataPath:"mark.label",filter:!1,search:!0,sort:!0},{label:"\u0421\u0442\u0430\u0442\u0443\u0441",dataPath:"status",filter:!1,search:!0,sort:!0}],i=[{label:(0,o.t)("INCOME"),value:"INCOME"},{label:(0,o.t)("TRANSFER"),value:"TRANSFER"},{label:(0,o.t)("EXPENSE"),value:"EXPENSE"}]}}]);
//# sourceMappingURL=643.d9331956.chunk.js.map