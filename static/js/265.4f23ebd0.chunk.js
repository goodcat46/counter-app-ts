"use strict";(self.webpackChunkcounter_app_ts=self.webpackChunkcounter_app_ts||[]).push([[265],{3265:function(e,n,o){o.r(n),o.d(n,{FormCreateOrdersGroupStepsEnum:function(){return Ae},_transformOrderInfoForReq:function(){return _e},default:function(){return Be}});var i,t,r,l,d=o(3433),a=o(168),u=o(1413),c=o(9439),s=o(4942),v=o(8553),f=o(7506),h=o(853),m=o(2791),p=o(2360),x=o(8095),Z=o(1251),g=o(6522),b=o(7606),j=o(7348),C=o(4109),S=o(1383),y=o(825),I=o(5188),P=o(6201),w=o(4636),D=o(6492),k=o(3329),A=(0,p.ZP)(w.Z)(i||(i=(0,a.Z)(["\n  & .header {\n  }\n  & .content {\n    padding: 0;\n  }\n"]))),q=function(e){var n=e.slots,o=e.onRemove,i=e.onUpdate,t=e.renderHeader,r=e.title,l=e.onAddSlotPress,d=e.renderFooter,a=(0,p.Fg)(),u=(0,m.useMemo)((function(){return n.map((function(e){return(0,k.jsx)(P.Z,{slot:e,editable:!0,onRemovePress:o?function(){return(null===e||void 0===e?void 0:e.tempId)&&o(null===e||void 0===e?void 0:e.tempId)}:void 0,onUpdate:i},"slot_".concat(null===e||void 0===e?void 0:e.tempId))}))}),[o,i,n]),c=(0,m.useMemo)((function(){return(0,k.jsxs)(x.ZP,{fxDirection:"row",fillHeight:!0,gap:8,alignItems:"center",padding:"2px 0",children:[t||(0,k.jsx)(D.x,{$weight:500,$size:15,children:r}),l&&(0,k.jsx)(x.ZP,{height:"80%",border:"1px solid ".concat(a.modalBorderColor)}),l&&(0,k.jsx)(C.Z,{variant:"textExtraSmall",style:{minWidth:"fit-content",height:"100%",fontWeight:600},disabled:!l,onClick:l,children:(0,g.t)("Add")})]})}),[l,t,a.modalBorderColor,r]);return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)(A,{open:!0,renderHeader:c,renderFooter:d,title:r,children:u})})},E=o(6211),R=o(4805),M=o(2437),W=o(7824),B=(0,p.ZP)(x.ZP)(t||(t=(0,a.Z)(["\n  color: ",";\n"])),(function(e){return e.theme.fontColorSidebar})),O=(0,p.ZP)(x.ZP)(r||(r=(0,a.Z)([""]))),_=(0,p.ZP)(x.ZP)(l||(l=(0,a.Z)(["\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),F=function(e){var n=e.onChangeValidStatus,o=(0,I.kw)(),i=(0,M.xc)()[W.d.orders],t=(0,j.xA)().ordersGroupFormData.slots,r=(0,R.useMediaQuery)({maxWidth:480}),l=(0,m.useCallback)((function(e){i.addTempSlot(e)}),[i]),a=(0,m.useCallback)((function(e){i.removeTempSlot(e)}),[i]),u=(0,m.useCallback)((function(e){i.updateTempSlot(e)}),[i]),c=(0,m.useMemo)((function(){var e={};return null===t||void 0===t||t.map((function(n){var o,i,t;null!==(o=n.warehouse)&&void 0!==o&&o._id&&(e[n.warehouse._id]={warehouse:n.warehouse,slots:null!==(i=e[n.warehouse._id])&&void 0!==i&&i.slots?[].concat((0,d.Z)(null===(t=e[n.warehouse._id])||void 0===t?void 0:t.slots),[n]):[n]});return""})),e}),[t]);(0,m.useEffect)((function(){n&&n(!(null===t||void 0===t||!t.length)&&(null===t||void 0===t?void 0:t.length)>0)}),[n,null===t||void 0===t?void 0:t.length]);var s=(0,m.useMemo)((function(){return Object.keys(c).map((function(e,n){var i,t,r=c[e];return(0,k.jsx)(q,{slots:r.slots,title:null===r||void 0===r||null===(t=r.warehouse)||void 0===t?void 0:t.label,onRemove:a,onUpdate:u,onAddSlotPress:function(){var e=o.open({Modal:y.n.FormCreateOrderSlot,props:{params:null!==r&&void 0!==r&&r.warehouse?{warehouse:(0,E.rE)(null===r||void 0===r?void 0:r.warehouse)}:void 0,onSubmit:function(n){l(n),n&&null!==e&&void 0!==e&&e.onClose&&(null===e||void 0===e||e.onClose())}}})}},"pre-order_".concat((null===(i=r.warehouse)||void 0===i?void 0:i._id)||n))}))}),[c,l,a,u,o]);return(0,k.jsxs)(B,{flex:1,fillWidth:!0,overflow:"hidden",style:{position:"relative"},children:[(0,k.jsx)(O,{flex:1,overflow:"auto",children:(0,k.jsx)(x.ZP,{flex:1,fillWidth:!0,children:s})}),(0,k.jsxs)(_,{fxDirection:"row",gap:8,padding:"8px",children:[(0,k.jsx)(C.Z,{variant:"defOutlinedSmall",onClick:function(){window.confirm("Remove all items?")&&S.kl.info("All items will be remove")},children:(0,g.t)("Remove all")}),(0,k.jsx)(C.Z,{variant:"outlinedSmall",flex:1,onClick:function(){var e=o.open({Modal:y.n.FormCreateOrderSlot,props:{onSubmit:function(n){l(n),n&&null!==e&&void 0!==e&&e.onClose&&(null===e||void 0===e||e.onClose())}}})},children:(0,g.t)(r?"Add":"Add position to group")})]})]})},V=o(4990),N=o(4925),T=o(9656),H=o(1186),G=o(7585),L=o(4646),U=["onSelect","onSubmit","onClose","asReceiver"],$=function(e){var n=e.onSelect,o=(e.onSubmit,e.onClose),i=e.asReceiver,t=(0,N.Z)(e,U),r=(0,j.I6)().customers,l=(0,I.kw)(),d=(0,M.xc)()[M.EJ.customers],a=(0,m.useMemo)((function(){return{tableData:r,tableTitles:H.f,actionsCreator:function(e){return[{icon:"refresh",onClick:function(){return d.getAll()}},{separator:!0},{icon:"plus",onClick:function(){var e=l.open({ModalChildren:L.Z,modalChildrenProps:{onSubmit:function(n){d.create({data:(0,E.X$)(n),onSuccess:null===e||void 0===e?void 0:e.onClose})}}})}}]},onRowClick:function(e){null!==e&&void 0!==e&&e.rowData&&n&&(n(e.rowData),o&&o())}}}),[d,r,o,l,n]);return(0,m.useEffect)((function(){d.getAll({data:{refresh:!0,params:{}}})}),[]),(0,k.jsx)(T.Z,(0,u.Z)((0,u.Z)({fillWidth:!0,fillHeight:!0,title:(0,g.t)(i?"Select receiver":"Select customer"),onClose:o},t),{},{children:(0,k.jsx)(G.ZP,(0,u.Z)({},a))}))},z=o(6074),J=o(7666),Q=["onSubmit","onSelect","onClose"],X=function(e){e.onSubmit;var n=e.onSelect,o=e.onClose,i=((0,N.Z)(e,Q),(0,j.O5)().users),t=(0,m.useMemo)((function(){return{tableData:i,onRowClick:function(e){var o=i.find((function(n){return n._id===(null===e||void 0===e?void 0:e._id)}));o&&n&&n(o)}}}),[n,i]);return(0,k.jsx)(T.Z,{fillWidth:!0,fillHeight:!0,onClose:o,title:(0,g.t)("Select manager"),children:(0,k.jsx)(G.ZP,(0,u.Z)((0,u.Z)({tableTitles:J.NT},t),{},{isSearch:!1}))})},K=o(1392),Y=o(2911),ee=o(389),ne=o(6681),oe=o(1134),ie=function(e){var n=e.onSuccess,o=e.isReceiver,i=(0,M.xc)()[M.EJ.customers],t=(0,I.kw)();return(0,k.jsx)(C.Z,{variant:"onlyIcon",icon:"plus",iconSize:"100%",size:"30px",onClick:function(){var e=t.open({ModalChildren:L.Z,modalChildrenProps:{title:o?(0,g.t)("Create receiver"):void 0,onSubmit:function(o){i.create({data:(0,E.X$)(o),onSuccess:function(o){n&&n(o),null===e||void 0===e||e.onClose()}})}}})}})},te=function(e){var n=e.info,o=e.isReceiver,i=e.isManager,t=(0,p.Fg)(),r=(0,m.useMemo)((function(){if(n)return function(e){var n=e.isManager;return[{label:(0,g.t)("label"),getValue:function(e){return(null===e||void 0===e?void 0:e.label)||"---"},visible:!n},{label:(0,g.t)("name"),getValue:function(e){return(null===e||void 0===e?void 0:e.name)||"---"},visible:!0},{label:(0,g.t)("secondName"),getValue:function(e){return(null===e||void 0===e?void 0:e.secondName)||"---"},visible:!0},{label:(0,g.t)("email"),getValue:function(e){return(null===e||void 0===e?void 0:e.email)||"---"},visible:!0},{label:(0,g.t)("taxCode"),getValue:function(e){return(null===e||void 0===e?void 0:e.taxCode)||"---"},visible:!n},{label:(0,g.t)("personalTaxCode"),getValue:function(e){return(null===e||void 0===e?void 0:e.personalTaxCode)||"---"},visible:!n},{label:(0,g.t)("tags"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.tags)||void 0===n?void 0:n.join(", "))||"---"},visible:!n}]}({info:n,isReceiver:o,isManager:i}).map((function(e){var o=e.label,i=e.getValue;return e.visible&&(0,k.jsxs)(x.ZP,{gap:4,padding:"4px",flex:"1 1 50%",maxWidth:"50%",border:"1px solid ".concat(t.modalBorderColor),children:[(0,k.jsx)(D.x,{$size:12,children:o}),(0,k.jsx)(D.x,{$align:"right",children:i(n)})]},o)}))}),[n,i,o,t.modalBorderColor]);return(0,k.jsx)(x.ZP,{fillWidth:!0,flexWrap:"wrap",fxDirection:"row",border:"1px solid ".concat(t.modalBorderColor),children:r})};var re=[{name:"country",label:(0,g.t)("Country"),required:!1},{name:"region",label:(0,g.t)("Region"),required:!1},{name:"area",label:(0,g.t)("Area"),required:!1},{name:"city",label:(0,g.t)("City"),required:!1},{name:"street",label:(0,g.t)("Street"),required:!1},{name:"house",label:(0,g.t)("House"),required:!1},{name:"office",label:(0,g.t)("Office"),required:!1},{name:"room",label:(0,g.t)("Room"),required:!1}],le=o(763),de=o.n(le),ae=(de().throttle((function(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];(e=console).log.apply(e,["Throttled Logger"].concat(o))}),5e3),de().throttle((function(e){console.log(ae.name),e()}),3e3)),ue=o(1604),ce=o(9297),se=o(8527),ve=o(4522);function fe(e,n){(0,ve.Z)(2,arguments);var o=(0,se.Z)(e),i=(0,ce.Z)(n);return isNaN(i)?new Date(NaN):i?(o.setDate(o.getDate()+i),o):o}var he,me,pe,xe,Ze,ge,be,je=o(6666),Ce=function(e){var n=e.title;return(0,k.jsx)(D.x,{$padding:"0 6px",$ellipsisMode:!0,$size:16,$weight:500,children:n})},Se=(0,p.ZP)(x.ZP)(he||(he=(0,a.Z)([""]))),ye=(0,p.ZP)(x.ZP)(me||(me=(0,a.Z)(["\n  padding-bottom: 8px;\n\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),Ie=(0,p.ZP)(w.Z)(pe||(pe=(0,a.Z)(["\n  & .content {\n    max-width: 480px;\n    width: 100%;\n    margin: auto;\n  }\n"]))),Pe=function(e){var n,o,i,t,r,l,d,a,v,f=e.onChangeValidStatus,h=(0,I.kw)(),p=(0,oe.Gc)(),Z=p.formState,b=Z.isValid,S=Z.errors,y=p.register,P=p.setValue,w=p.unregister,D=p.watch,A=p.trigger,q=D(),E=(0,Y.f)((0,j.ei)().methods,{withFullLabel:!0}),R=(0,Y.f)((0,j.$N)().methods,{withFullLabel:!0}),M=(0,Y.f)((0,j.A2)().methods,{withFullLabel:!0}),W=(0,m.useState)({hasDelivery:!!q.deliveryInfo,hasDeliveryInvoice:!(null===(n=q.deliveryInfo)||void 0===n||!n.invoiceInfo),hasReceiverInfo:!!q.receiver,hasExecuteDate:!(null===(o=q.shipmentInfo)||void 0===o||!o.executeAt)}),B=(0,c.Z)(W,2),O=B[0],_=B[1],F=function(e,n){try{P(e,n),ae((function(){return A().then((function(e){e&&f&&f(e)})).catch((function(e){console.error("handleOnChangeValue trigger error",e)}))}))}catch(o){console.error("handleOnChangeValue: ",o)}},N=function(e){return function(n){if(_((function(o){return(0,u.Z)((0,u.Z)({},o),{},(0,s.Z)({},e,n))})),n){if("hasExecuteDate"===e)return P("shipmentInfo.executeAt",ue.Z(fe(new Date,1),"yyyy-MM-dd"));if("hasDeliveryInvoice"===e)return P("deliveryInfo.invoiceInfo.expiredAt",(0,je._1)(fe(new Date,1)))}else if(!n){if("hasReceiverInfo"===e)return w("receiver");if("hasDeliveryInvoice"===e)return w("deliveryInfo.invoiceInfo");if("hasDelivery"===e)return w("deliveryInfo")}}},T=function(e){return{name:e,onChange:N(e),value:O[e]}};return(0,m.useEffect)((function(){f&&f(b)}),[b,f]),(0,m.useEffect)((function(){console.debug("CURRENT CONFIRMS",O)}),[O]),(0,k.jsxs)(Se,{flex:1,overflow:"auto",children:[(0,k.jsxs)(x.ZP,{fillWidth:!0,gap:8,padding:"8px 2px",style:{maxWidth:480,width:"100%",margin:"0 auto"},children:[(null===q||void 0===q?void 0:q.manager)&&(0,k.jsx)(V.Z,{label:(0,g.t)("manager"),children:(0,k.jsx)(te,{info:null===q||void 0===q||null===(i=q.manager)||void 0===i?void 0:i.user,isManager:!0})}),(0,k.jsx)(C.Z,{variant:"outlinedSmall",onClick:function(){var e=h.open({ModalChildren:X,modalChildrenProps:{onSelect:function(n){F("manager",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,g.t)(null!==q&&void 0!==q&&q.manager?"Change manager":"Select manager")})]}),(0,k.jsxs)(x.ZP,{padding:"0 2px",children:[(0,k.jsxs)(Ie,{contentContainerStyle:{padding:"8px 0",gap:8},open:!0,renderHeader:(0,k.jsx)(Ce,{title:(0,g.t)("Customer")}),children:[(null===q||void 0===q?void 0:q.customer)&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(V.Z,{label:(0,g.t)("Customer information"),children:(0,k.jsx)(te,{info:null===q||void 0===q?void 0:q.customer})}),(0,k.jsx)(ye,{fillWidth:!0,overflow:"hidden",children:(0,k.jsx)(V.Z,{label:(0,g.t)("Communication methods"),children:(0,k.jsx)(z.Z,{multiple:!0,numColumns:2,values:null===q||void 0===q||null===(t=q.communication)||void 0===t?void 0:t.customer,resetButtonLabel:(0,g.t)("Not needed"),options:R,resetButtonPosition:"start",onChange:function(e){F("communication.customer",e)}})})})]}),(0,k.jsxs)(x.ZP,{fxDirection:"row",gap:8,fillWidth:!0,alignItems:"center",children:[(0,k.jsx)(ie,{onSuccess:function(e){F("customer",e)}}),(0,k.jsx)(C.Z,{variant:"outlinedSmall",flex:1,onClick:function(){var e=h.open({ModalChildren:$,modalChildrenProps:{onSelect:function(n){F("customer",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,g.t)(null!==q&&void 0!==q&&q.customer?"Change customer":"Select customer")})]}),(0,k.jsx)(ye,{fillWidth:!0,gap:4,children:(0,k.jsx)(V.Z,{label:(0,g.t)("Receiver"),children:(0,k.jsx)(ee.Z,(0,u.Z)((0,u.Z)({},T("hasReceiverInfo")),{},{rejectLabel:(0,g.t)("The same"),acceptLabel:(0,g.t)("Another")}))})})]}),(null===O||void 0===O?void 0:O.hasReceiverInfo)&&(0,k.jsxs)(Ie,{contentContainerStyle:{padding:"8px 0",gap:8},open:!0,renderHeader:(0,k.jsx)(Ce,{title:(0,g.t)("Receiver")}),children:[(null===q||void 0===q?void 0:q.receiver)&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(V.Z,{label:(0,g.t)("Receiver information"),children:[(0,k.jsx)(te,{info:null===q||void 0===q?void 0:q.receiver})," "]}),(0,k.jsx)(ye,{fillWidth:!0,children:(0,k.jsx)(V.Z,{label:(0,g.t)("Communication methods"),children:(0,k.jsx)(z.Z,{multiple:!0,numColumns:2,values:null===q||void 0===q||null===(r=q.communication)||void 0===r?void 0:r.receiver,resetButtonLabel:(0,g.t)("Without"),options:R.map((function(e){return(0,u.Z)((0,u.Z)({},e),{},{value:e._id})})),resetButtonPosition:"start",onChange:function(e){F("communication.receiver",e)}})})})]}),(0,k.jsxs)(x.ZP,{fxDirection:"row",gap:8,fillWidth:!0,alignItems:"center",children:[(0,k.jsx)(ie,{isReceiver:!0,onSuccess:function(e){F("receiver",e)}}),(0,k.jsx)(C.Z,{variant:"outlinedSmall",flex:1,onClick:function(){var e=h.open({ModalChildren:$,modalChildrenProps:{onSelect:function(n){F("receiver",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,g.t)(null!==q&&void 0!==q&&q.receiver?"Change receiver":"Select receiver")})]})]}),(0,k.jsxs)(Ie,{contentContainerStyle:{padding:"8px 2px"},open:!0,renderHeader:(0,k.jsx)(Ce,{title:(0,g.t)("Invoicing")}),children:[(0,k.jsx)(V.Z,{label:(0,g.t)("Payment method"),required:!0,children:(0,k.jsx)(K.Z,{options:M,currentOption:null===q||void 0===q||null===(l=q.invoiceInfo)||void 0===l?void 0:l.method,onChangeIndex:function(e){F("invoiceInfo.method",M[e])}})}),(0,k.jsx)(V.Z,{label:(0,g.t)("Expired at"),required:!0,children:(0,k.jsx)(ne.ZP,(0,u.Z)({placeholder:(0,g.t)("Expired at"),type:"datetime-local",required:!0},y("invoiceInfo.expiredAt",{required:!0})))})]}),(0,k.jsxs)(Ie,{contentContainerStyle:{padding:"0 2px"},open:!0,renderHeader:(0,k.jsx)(Ce,{title:(0,g.t)("Shipment")}),children:[(0,k.jsxs)(ye,{fillWidth:!0,gap:4,children:[(0,k.jsx)(V.Z,{label:(0,g.t)("Another execute date"),children:(0,k.jsx)(ee.Z,(0,u.Z)({},T("hasExecuteDate")))}),(null===O||void 0===O?void 0:O.hasExecuteDate)&&(0,k.jsx)(V.Z,{label:(0,g.t)("Execute at"),required:null===O||void 0===O?void 0:O.hasExecuteDate,children:(0,k.jsx)(ne.ZP,(0,u.Z)({placeholder:(0,g.t)("Execute at"),type:"date",required:null===O||void 0===O?void 0:O.hasExecuteDate},y("shipmentInfo.executeAt",{required:null===O||void 0===O?void 0:O.hasExecuteDate})))})]}),(0,k.jsx)(ye,{fillWidth:!0,gap:4,children:(0,k.jsx)(V.Z,{label:(0,g.t)("Delivery"),children:(0,k.jsx)(ee.Z,(0,u.Z)({},T("hasDelivery")))})})]}),(null===O||void 0===O?void 0:O.hasDelivery)&&(0,k.jsxs)(Ie,{contentContainerStyle:{padding:"0 2px"},open:!0,renderHeader:(0,k.jsx)(Ce,{title:(0,g.t)("Delivery")}),children:[(0,k.jsx)(ye,{fillWidth:!0,gap:8,children:(0,k.jsx)(V.Z,{label:(0,g.t)("Delivery method"),required:!0,children:(0,k.jsx)(K.Z,{options:E,currentOption:null===q||void 0===q||null===(d=q.deliveryInfo)||void 0===d?void 0:d.method,onChangeIndex:function(e){F("deliveryInfo.method",E[e])}})})}),(0,k.jsx)(ye,{fillWidth:!0,style:{columnGap:8,display:"grid",gridTemplateColumns:"1fr 1fr"},children:re.map((function(e){var n,o,i=e.name,t=e.label,r=e.required;return(0,k.jsx)(V.Z,{label:t,error:null!==S&&void 0!==S&&null!==(n=S.deliveryInfo)&&void 0!==n&&n.destination?null===S||void 0===S||null===(o=S.deliveryInfo)||void 0===o?void 0:o.destination[i]:void 0,required:r,children:(0,k.jsx)(ne.ZP,(0,u.Z)({required:r,placeholder:t},y("deliveryInfo.destination.".concat(i),{required:r})))},"dest-addr-".concat(t))}))}),(0,k.jsx)(ye,{fillWidth:!0,gap:8,children:(0,k.jsx)(V.Z,{label:(0,g.t)("Has payment"),required:!0,children:(0,k.jsx)(ee.Z,(0,u.Z)({},T("hasDeliveryInvoice")))})}),(0,k.jsx)(ye,{fillWidth:!0,gap:8,children:(null===O||void 0===O?void 0:O.hasDeliveryInvoice)&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(V.Z,{label:(0,g.t)("Payment method"),required:!0,children:(0,k.jsx)(K.Z,{options:M,currentOption:null===q||void 0===q||null===(a=q.deliveryInfo)||void 0===a||null===(v=a.invoiceInfo)||void 0===v?void 0:v.method,onChangeIndex:function(e){F("deliveryInfo.invoiceInfo.method",M[e])}})}),(0,k.jsx)(V.Z,{label:(0,g.t)("Expired at"),required:!0,children:(0,k.jsx)(ne.ZP,(0,u.Z)({placeholder:(0,g.t)("Expired at"),type:"datetime-local",required:!0},y("deliveryInfo.invoiceInfo.expiredAt",{required:!0})))})]})})]})]})]})},we=o(4695),De=o(371),ke=o(2795),Ae=function(e){return e.Stuffing="Stuffing",e.Info="Info",e}({}),qe=(0,v.H1)(Ae),Ee=(xe={},(0,s.Z)(xe,Ae.Stuffing,!0),(0,s.Z)(xe,Ae.Info,!1),xe),Re=p.ZP.form(Ze||(Ze=(0,a.Z)(["\n  color: ",";\n\n  display: flex;\n  flex-direction: column;\n\n  width: 98vw;\n  height: 98vh;\n  padding: 0 8px;\n\n  background-color: ",";\n"])),(function(e){return e.theme.fontColorSidebar}),(function(e){return e.theme.modalBackgroundColor})),Me=(0,p.ZP)(x.ZP)(ge||(ge=(0,a.Z)(["\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),We=(0,p.ZP)(x.ZP)(be||(be=(0,a.Z)([""]))),Be=function(e){e.onSubmit;var n,o,i,t,r=e.onClose,l=(0,M.xc)()[M.EJ.orders],d=(0,j.xA)().ordersGroupFormData,a=(0,h.dn)(qe),v=a.stepsMap,p=a.stepIdx,x=a.setNextStep,C=a.setPrevStep,y=a.getCurrentStep,I=a.isLast,P=(0,m.useState)(Ee),w=(0,c.Z)(P,2),D=w[0],A=w[1],q=function(e){return function(n){A((function(o){return(0,u.Z)((0,u.Z)({},o),{},(0,s.Z)({},Ae[e],n))}))}},E=(0,oe.cI)({defaultValues:(0,u.Z)((0,u.Z)({},d.info),{},{invoiceInfo:(0,u.Z)((0,u.Z)({},null===(n=d.info)||void 0===n?void 0:n.invoiceInfo),{},{expiredAt:null!==(o=null===(i=d.info)||void 0===i||null===(t=i.invoiceInfo)||void 0===t?void 0:t.expiredAt)&&void 0!==o?o:(0,je._1)(fe(new Date,1))})}),resolver:(0,we.X)(De.Lr),reValidateMode:"onChange"}),R=E.watch,W=E.handleSubmit,B=R(),O=(0,m.useMemo)((function(){return null!==v&&void 0!==v&&v.Stuffing?(0,k.jsx)(F,{onChangeValidStatus:q("Stuffing")}):null!==v&&void 0!==v&&v.Info?(0,k.jsx)(Pe,{onChangeValidStatus:q("Info"),isGroup:!0}):void 0}),[null===v||void 0===v?void 0:v.Info,null===v||void 0===v?void 0:v.Stuffing]),_=(0,m.useMemo)((function(){return D[y().value]}),[y,D]);return(0,k.jsx)(oe.RV,(0,u.Z)((0,u.Z)({},E),{},{children:(0,k.jsxs)(Re,{onSubmit:W((function(e){I?(console.debug("onValidSubmit data"),console.log(e),console.debug("onValidSubmit orderInfoFormValues"),console.log(B),(0,ke.Eh)({data:{data:{info:Oe(B),slots:Fe(d.slots)}},onSuccess:function(e){console.log(e)},onError:function(e){console.log(e)},onLoading:function(e){}},ke.p6.createManyOrdersGroupedByWarehouse,ke.p6)):S.kl.error("Form is not valid")}),(function e(n){console.debug(e.name,n)})),children:[(0,k.jsx)(Z.xB,{title:(0,g.t)("Create orders group by warehouse"),onBackPress:r}),(0,k.jsxs)(Me,{fillWidth:!0,flex:1,overflow:"hidden",children:[(0,k.jsx)(f.Z,{filterOptions:qe,asStepper:!0,currentIndex:p,optionProps:{fitContentH:!0}}),O]}),(0,k.jsx)(We,{padding:"8px",children:(0,k.jsx)(b.Z,{steps:qe,onNextPress:function(){"Info"===y().value&&l.updateCurrentGroupFormInfoData(de().cloneDeep(B)),_?x():S.kl.error("".concat((0,g.t)("Step is not finished"),': "').concat(y().value.toUpperCase(),'"'))},onPrevPress:function(){"Info"===y().value&&l.updateCurrentGroupFormInfoData(de().cloneDeep(B)),C()},currentIndex:p,canGoNext:!0,canSubmit:I,submitButton:!0,onCancelPress:0===p?r:void 0})})]})}))};function Oe(e){var n={},o=Object.keys(e).map((function(n){var o=e[n];return o&&"object"===typeof o&&o.hasOwnProperty("_id")&&"_id"in o?(0,s.Z)({},n,(0,E.rE)(o)):(0,s.Z)({},n,o)}));if(Object.assign.apply(Object,[n].concat((0,d.Z)(o))),null!==e&&void 0!==e&&e.invoiceInfo&&e.invoiceInfo){var i,t,r={};if(null!==(i=e.invoiceInfo)&&void 0!==i&&i.method)r={method:(0,E.rE)(e.invoiceInfo.method),expiredAt:null===(t=e.invoiceInfo)||void 0===t?void 0:t.expiredAt},n.invoiceInfo=r}if(null!==e&&void 0!==e&&e.deliveryInfo){var l,a,u,c,v={};if(e.deliveryInfo.method&&(v.method=(0,E.rE)(e.deliveryInfo.method)),null!==e&&void 0!==e&&null!==(l=e.deliveryInfo)&&void 0!==l&&l.invoiceInfo)if(null!==e&&void 0!==e&&null!==(a=e.deliveryInfo)&&void 0!==a&&null!==(u=a.invoiceInfo)&&void 0!==u&&u.method)v.invoiceInfo={method:(0,E.rE)(e.deliveryInfo.invoiceInfo.method),expiredAt:null===(c=e.deliveryInfo.invoiceInfo)||void 0===c?void 0:c.expiredAt};n.deliveryInfo=v}return console.debug("Transform Order Info For Req".toUpperCase()),console.log({input:e}),console.log({output:n}),n}function _e(e){console.debug("Transform Order Info For Req".toUpperCase()),console.log({input:e});var n={info:function e(n){var o={};for(var i in n)n[i]instanceof Object?o[i]=e(n[i]):"method"===i?(o.method=(0,E.rE)(n.method),o.expiredAt=n.expiredAt):o[i]=n[i];return o}(e)};return console.log({output:n}),n.info}function Fe(e){var n=e.map((function(e){var n=de().omit(e,["tempId"]),o=Object.keys(n).map((function(e){var o=n[e];return o&&"object"===typeof o&&o.hasOwnProperty("_id")&&"_id"in o?(0,s.Z)({},e,(0,E.rE)(o)):(0,s.Z)({},e,o)}));return console.log({objectsArr:o}),Object.assign.apply(Object,[n].concat((0,d.Z)(o))),n}));return console.debug(Fe.name),console.log(n),n}},7606:function(e,n,o){var i,t,r,l=o(168),d=o(9439),a=o(2360),u=o(8095),c=o(4109),s=o(2791),v=o(6666),f=o(6522),h=o(4805),m=o(3329),p=(0,a.ZP)(u.ZP)(i||(i=(0,l.Z)(["\n  //min-height: 44px;\n  // border-top: 1px solid ",";\n  // border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),x=(0,a.ZP)(c.Z)(t||(t=(0,l.Z)(["\n  flex: 1;\n  min-width: min-content;\n  height: 100%;\n"]))),Z=(0,a.ZP)(c.Z)(r||(r=(0,l.Z)(["\n  min-width: 34px;\n  height: 100%;\n  // color: ",";\n  // fill: ",";\n  // background-color: ",";\n  @media screen and (min-width: 480px) {\n    flex: 1;\n  }\n"])),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.light}));n.Z=function(e){var n=e.steps,o=e.currentIndex,i=void 0===o?0:o,t=e.onNextPress,r=e.onPrevPress,l=e.onCancelPress,a=e.onAcceptPress,u=e.canGoNext,c=void 0===u||u,g=e.canAccept,b=e.canSubmit,j=e.cancelButton,C=void 0===j||j,S=e.submitButton,y=void 0!==S&&S,I=e.acceptButton,P=e.arrowButtons,w=void 0===P||P,D=(0,h.useMediaQuery)({query:"(max-width: 768px)"}),k=(0,h.useMediaQuery)({query:"(max-width: 480px)"}),A=(0,s.useState)(i),q=(0,d.Z)(A,2),E=q[0],R=q[1],M=(0,s.useMemo)((function(){var e,o;return n&&n[E-1]?{label:null===(e=n[E-1])||void 0===e?void 0:e.label,value:null===(o=n[E-1])||void 0===o?void 0:o.value}:null}),[E,n]),W=(0,s.useMemo)((function(){var e,o;return n&&n[E+1]?{label:null===(e=n[E+1])||void 0===e?void 0:e.label,value:null===(o=n[E+1])||void 0===o?void 0:o.value}:null}),[E,n]),B=(0,s.useCallback)((function(){if(n)if(r){if(0===E)return void(l&&l());var e=E-1;r&&r({option:n[e],value:n[e].value,index:e})}else R((function(e){return 0===e?e:e-1}))}),[E,l,r,n]),O=(0,s.useCallback)((function(){if(n){if(t){var e=E+1;return e===n.length?a&&a():t({option:n[e],value:n[e].value,index:e})}R((function(e){return e+1===n.length?e+1:e}))}}),[E,a,t,n]);return(0,s.useEffect)((function(){v.sr.isNotUnd(i)&&R(i)}),[i]),(0,m.jsxs)(p,{fxDirection:"row",gap:8,fillWidth:!0,children:[C&&!D&&(0,m.jsx)(x,{variant:"defOutlinedSmall",onClick:l,children:(0,f.t)("Cancel")}),w&&(0,m.jsx)(Z,{variant:k?"onlyIconFilled":"filledSmall",icon:"SmallArrowLeft",onClick:B,disabled:!M,children:null===M||void 0===M?void 0:M.label}),w&&(0,m.jsx)(Z,{variant:k?"onlyIconFilled":"filledSmall",endIcon:"SmallArrowRight",onClick:O,disabled:!c||!W,children:null===W||void 0===W?void 0:W.label}),(y||I)&&(0,m.jsx)(x,{variant:"filledSmall",type:b&&y?"submit":"button",onClick:a,disabled:b&&y?!b:!g,children:(0,f.t)("Accept")})]})}},4646:function(e,n,o){o.d(n,{Z:function(){return A}});var i,t=o(168),r=o(1413),l=o(4925),d=function(e){return e.facebook="facebook",e.instagram="instagram",e.referralSystem="referralSystem",e.another="another",e}({}),a=o(9656),u=o(6522),c=o(2360),s=o(8095),v=o(4990),f=o(6681),h=o(9964),m=o(457),p=o(1134),x=o(4109),Z=o(1392),g=o(8553),b=o(2791),j=o(1383),C=o(7038),S=o(763),y=o.n(S),I=o(3329),P=["defaultState","withReferer","onSubmit"],w=j.E4.isDevMode(),D=(0,g.H1)(d),k=(0,c.ZP)(s.ZP)(i||(i=(0,t.Z)([""]))),A=function(e){var n=e.defaultState,o=e.withReferer,i=e.onSubmit,t=(0,l.Z)(e,P),c=(0,p.cI)({defaultValues:(0,r.Z)((0,r.Z)({},n),{},{businessType:C.G.company})}),g=c.register,j=c.setValue,S=c.handleSubmit,A=(0,c.watch)(),q=(0,b.useMemo)((function(){return!(null===n||void 0===n||!n.email)}),[null===n||void 0===n?void 0:n.email]);return(0,I.jsx)(a.Z,(0,r.Z)((0,r.Z)({},t),{},{title:t.title?t.title:(0,u.t)("Create customer"),onSubmit:S((function(e){i&&i(y().omit(e,q?["engagementSource","email"]:["engagementSource"]))})),children:(0,I.jsxs)(k,{padding:"0 8px 8px",children:[(0,I.jsx)(v.Z,{label:(0,u.t)("type"),required:!0,children:(0,I.jsx)(h.Z,{options:m.Wk,onSelect:function(e){j("businessType",null===e||void 0===e?void 0:e.value)}})}),(0,I.jsx)(v.Z,{label:(0,u.t)("name"),required:!0,children:(0,I.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:(0,u.t)("name")},g("name")),{},{required:!0}))}),(0,I.jsx)(v.Z,{label:(0,u.t)("secondName"),children:(0,I.jsx)(f.ZP,(0,r.Z)({placeholder:(0,u.t)("secondName")},g("secondName")))}),(0,I.jsx)(v.Z,{label:(0,u.t)("email"),disabled:q,required:!0,children:(0,I.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:(0,u.t)("email"),type:"email"},g("email",{required:!0})),{},{disabled:q,required:!0}))}),(0,I.jsx)(v.Z,{label:(0,u.t)("phone"),children:(0,I.jsx)(f.ZP,(0,r.Z)({placeholder:(0,u.t)("phone")},g("phone")))}),(0,I.jsx)(v.Z,{label:(0,u.t)("Birth date"),children:(0,I.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:(0,u.t)("Birth date")},g("birthDate")),{},{type:"datetime-local"}))}),o&&w&&(0,I.jsx)(v.Z,{label:(0,u.t)("Referrer id"),children:(0,I.jsx)(f.ZP,(0,r.Z)({placeholder:(0,u.t)("Referrer id")},g("referrer._id")))}),(0,I.jsx)(v.Z,{label:(0,u.t)("Source"),children:(0,I.jsx)(Z.Z,{disabled:!0,options:D,currentOption:{value:null===A||void 0===A?void 0:A.engagementSource},onChangeIndex:function(e){j("engagementSource",D[e].value)}})}),(null===A||void 0===A?void 0:A.engagementSource)===d.referralSystem&&(0,I.jsxs)(s.ZP,{gap:8,fillWidth:!0,children:[(0,I.jsx)(v.Z,{label:(0,u.t)("Referrer"),required:!0,children:(0,I.jsx)(f.ZP,{placeholder:(0,u.t)("Referrer"),type:"email",required:!0})}),(0,I.jsxs)(s.ZP,{fxDirection:"row",fillWidth:!0,gap:8,padding:"8px 0",children:[(0,I.jsx)(x.Z,{variant:"defOutlinedSmall",children:(0,u.t)("Clear referrer")}),(0,I.jsx)(x.Z,{variant:"outlinedSmall",flex:1,children:(0,u.t)("Select referrer")})]})]})]})}))}},1392:function(e,n,o){var i=o(3433),t=o(9439),r=o(2791),l=o(6666),d=o(8095),a=o(3855),u=o(6492),c=o(3329);n.Z=function(e){var n=e.options,o=e.onChangeIndex,s=e.currentIndex,v=e.currentOption,f=e.multiple,h=e.onChange,m=e.value,p=e.disabled,x=e.disabledCheck,Z=(0,r.useState)(0),g=(0,t.Z)(Z,2),b=g[0],j=g[1],C=(0,r.useState)([]),S=(0,t.Z)(C,2),y=S[0],I=S[1];return(0,r.useEffect)((function(){l.sr.isUnd(s)||j(s)}),[s]),(0,r.useEffect)((function(){f||l.sr.isUnd(v)||l.sr.isUnd(n)||j(n.findIndex((function(e){return(null===e||void 0===e?void 0:e.value)===(null===v||void 0===v?void 0:v.value)||(null===e||void 0===e?void 0:e._id)===(null===v||void 0===v?void 0:v._id)})))}),[v,f,n]),(0,r.useEffect)((function(){f&&!l.sr.isUnd(m)&&l.sr.isArray(m)&&I(m)}),[f,m]),(0,c.jsx)(d.ZP,{fillWidth:!0,gap:8,children:null===n||void 0===n?void 0:n.map((function(e,n){var t=x?x(e,n):p;return(0,c.jsxs)(d.ZP,{fxDirection:"row",gap:8,padding:"2px 4px",alignItems:"center",style:{opacity:t?.7:1,pointerEvents:t?"none":"all"},onClick:function(){var r;t||(!function(e){j(e),o&&o(e)}(n),(null===e||void 0===e?void 0:e._id)&&(r=null===e||void 0===e?void 0:e._id,f?I((function(e){var n=y.includes(r)?e.filter((function(e){return e!==r})):[].concat((0,i.Z)(e),[r]);return h&&h(n),n})):(I([r]),h&&h([r]))))},children:[(0,c.jsx)(a.Z,{checked:(null===e||void 0===e?void 0:e._id)&&y.includes(null===e||void 0===e?void 0:e._id)||n===b,size:"22px",disabled:t}),(0,c.jsx)(u.x,{children:null===e||void 0===e?void 0:e.label})]},"m-opt_".concat(e.value))}))})}},1186:function(e,n,o){o.d(n,{f:function(){return t}});var i=o(6522),t=[{top:{name:"".concat((0,i.t)("label"),"/").concat((0,i.t)("name")),getData:function(e){return(null===e||void 0===e?void 0:e.label)||"".concat((null===e||void 0===e?void 0:e.name)||"---"," ").concat((null===e||void 0===e?void 0:e.secondName)||"---")}},bottom:{name:"\u0406\u041f\u041d/\u0404\u0414\u0420\u041f\u041e\u0423",getData:function(e){return(e.personalTaxCode||"---")+"/"+(e.taxCode||"---")}},width:"240px",action:"doubleDataWithAvatar"},{top:{name:"\u0422\u0438\u043f",path:"type",getData:function(e){return null===e||void 0===e?void 0:e.type}},bottom:{name:"\u0421\u0442\u0430\u0442\u0443\u0441",path:"status"},width:"120px",action:"valueByPath"},{top:{name:"\u0415\u043c\u0435\u0439\u043b",path:"email",uppercase:!1},bottom:{name:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",path:"phone"},width:"170px",action:"contacts"},{top:{name:"\u041b\u043e\u043a\u0430\u0446\u0456\u044f"},width:"170px",action:"valueByPath"},{top:{name:"\u0422\u0435\u0433\u0438",path:"tags"},width:"200px",action:"tags"},{top:{name:"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440",path:"description"},width:"170px",action:"valueByPath"},{top:{name:"\u0421\u0442\u0432\u043e\u0440\u0435\u043d\u043e",align:"center",path:"createdAt"},bottom:{name:"\u041e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",align:"center",path:"updatedAt"},width:"150px",action:"dateSimple"}]}}]);
//# sourceMappingURL=265.4f23ebd0.chunk.js.map