"use strict";(self.webpackChunkmia_erp=self.webpackChunkmia_erp||[]).push([[494],{3007:function(e,i,n){n.d(i,{B:function(){return P}});var o=n(1413),t=n(4925),l=n(9006),d=n(3691),a=n(2989),r=n(4990),u=n(6522),s=n(6681),c=n(8095),f=n(3423),v=n(870),p=n(4343),m=n(959),b=n(9994),h=n(1494),g=n(4897),x=n(7348),Z=n(3383),S=n(389),j=n(9964),y=n(3329),L=["formState","register","registerSelect","formValues","setValue","handleSubmit"],P=function(e){var i,n=e.defaultValues,P=e.edit,_=e.type,V=e.onSuccess,O=e._id,C=(0,h.useOfferLoadersProvider)(),D=C.isLoading,w=C.onLoading,B=(0,b.Z)(),I=(0,x.eO)(),k=(0,x.q$)(v.cA.COUNTERPARTIES).directory,A=(0,x.q$)(v.cA.BRANDS).directory,E=(0,a.hN)({defaultValues:(0,o.Z)((0,o.Z)({visible:!1,approved:d.H.pending},n),{},{type:_})}),M=E.formState.errors,F=E.register,K=E.registerSelect,q=E.formValues,N=E.setValue,R=E.handleSubmit,G=(0,t.Z)(E,L);return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(l.h,{label:(0,u.t)("Base info"),isLoading:P?null===D||void 0===D?void 0:D.offer_update:null===D||void 0===D?void 0:D.offer_create,onSubmit:R((function(e){var i=(0,m.vg)(e,{ignorePaths:["measurement"]});P?B.updateById({data:{data:{data:i,_id:O}},onSuccess:V,onLoading:w("offer_update")}):B.create({data:{data:{data:i}},onSuccess:V,onLoading:w("offer_create")})})),onReset:G.reset,canSubmit:!0,expandable:!1,children:[(0,y.jsx)(j.Z,{value:null!==(i=null===q||void 0===q?void 0:q.type)&&void 0!==i?i:d.i.GOODS,options:Z.LC,onSelect:function(e){return N("type",e.value)}}),(0,y.jsx)(r.Z,{label:(0,u.t)("label"),error:M.label,required:!0,children:(0,y.jsx)(s.ZP,(0,o.Z)((0,o.Z)({placeholder:(0,u.t)("label")},F("label")),{},{required:!0,autoFocus:!0}))}),(0,y.jsxs)(c.ZP,{fxDirection:"row",gap:6,fillWidth:!0,children:[(0,y.jsx)(r.Z,{label:(0,u.t)("sku"),error:M.sku,children:(0,y.jsx)(s.ZP,(0,o.Z)({placeholder:(0,u.t)("sku")},F("sku")))}),(0,y.jsx)(r.Z,{label:(0,u.t)("Bar-code"),error:M.barCode,children:(0,y.jsx)(s.ZP,(0,o.Z)({placeholder:(0,u.t)("Bar-code")},F("barCode")))})]}),(0,y.jsx)(f.Z,(0,o.Z)({},K("brand",{options:A,label:(0,u.t)("brand"),placeholder:(0,u.t)("selectBrand")}))),(0,y.jsx)(f.Z,(0,o.Z)({},K("warehouse",{options:I.warehouses,label:(0,u.t)("Select warehouse"),placeholder:(0,u.t)("Select warehouse")}))),(0,y.jsx)(f.Z,(0,o.Z)({},K("supplier",{options:k,label:(0,u.t)("Select supplier"),placeholder:(0,u.t)("Select supplier")}))),(0,y.jsx)(f.Z,(0,o.Z)({},K("approved",{options:g.SQ,label:(0,u.t)("status"),placeholder:(0,u.t)("status"),value:q.approved,selectedValue:q.approved}))),(0,y.jsx)(r.Z,{label:(0,u.t)("description"),error:M.description,children:(0,y.jsx)(p.Z,(0,o.Z)({placeholder:(0,u.t)("description")},F("description")))}),(0,y.jsx)(r.Z,{label:(0,u.t)("Visibility"),error:M.description,children:(0,y.jsx)(S.Z,{value:q.visible,onChange:function(e){N("visible",e,{shouldTouch:!0,shouldDirty:!0})}})})]})})}},7608:function(e,i,n){n.d(i,{A:function(){return h}});var o,t=n(168),l=n(9439),d=n(2791),a=n(9006),r=n(2360),u=n(8095),s=n(1819),c=n(1494),f=n(6522),v=n(959),p=n(9184),m=n(2989),b=n(3329),h=function(e){var i,n,o=e.offer,t=e.disabled,r=(0,m.G2)(o),u=(0,c.useOfferLoadersProvider)(),h=(0,v.sK)(null===r||void 0===r||null===(i=r.categories)||void 0===i?void 0:i.map((function(e){return e._id}))),x=(0,s.xc)()[s.EJ.offers],Z=(0,d.useState)(h),S=(0,l.Z)(Z,2),j=S[0],y=S[1],L=(0,d.useMemo)((function(){return!(null===j||void 0===j||!j.length)&&(null===h||void 0===h?void 0:h.join(","))!==(0,v.sK)(j).join(",")}),[h,j]);return(0,d.useEffect)((function(){null!==r&&void 0!==r&&r.categories&&y((0,v.SJ)(null===r||void 0===r?void 0:r.categories))}),[]),(0,b.jsx)(a.h,{label:(0,f.t)("Categories"),onSubmit:function(e){e.preventDefault(),r&&x.updateById({onLoading:u.onLoading("categories"),data:{data:{_id:r._id,data:{categories:j}}},onSuccess:function(e,i){}})},disabled:t,isLoading:null===(n=u.isLoading)||void 0===n?void 0:n.categories,canSubmit:L,maxHeight:"300px",isOpen:!1,children:(0,b.jsx)(g,{flex:1,overflow:"auto",children:(0,b.jsx)(p.Z,{onChangeIds:y,offer:r})})})},g=(0,r.ZP)(u.j6)(o||(o=(0,t.Z)(["\n  padding-bottom: 8px;\n"])))},9420:function(e,i,n){n.d(i,{A:function(){return y}});var o,t=n(1413),l=n(9439),d=n(4925),a=n(168),r=n(6522),u=n(2791),s=n(8095),c=n(4990),f=n(6681),v=n(2360),p=n(3329),m=[{name:"height",label:(0,r.t)("Height"),placeholder:(0,r.t)("Sm")},{name:"width",label:(0,r.t)("Width"),placeholder:(0,r.t)("Sm")},{name:"length",label:(0,r.t)("Length"),placeholder:(0,r.t)("Sm")},{name:"weight",label:(0,r.t)("Weight"),placeholder:(0,r.t)("Kg")}],b=(0,v.ZP)(s.ZP)(o||(o=(0,a.Z)(["\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  column-gap: 8px;\n\n  @media screen and (min-width: 480px) {\n    grid-template-columns: repeat(4, 1fr);\n  }\n"]))),h=function(e){var i,n,o=e.form,l=e.disabled,d=null===o||void 0===o||null===(i=o.formState)||void 0===i||null===(n=i.errors)||void 0===n?void 0:n.dimensions;return(0,p.jsx)(b,{fillWidth:!0,children:m.map((function(e){return(0,p.jsx)(c.Z,{label:e.label,error:d&&d[e.name],children:(0,p.jsx)(f.ZP,(0,t.Z)((0,t.Z)({placeholder:e.placeholder,min:1,type:"number"},o.register("dimensions.".concat(e.name),{valueAsNumber:!0,min:1})),{},{disabled:l}))},e.name)}))})},g=n(2989),x=n(9006),Z=n(9994),S=n(1383),j=["defaultValues","_id","disabled"],y=function(e){var i,n,o,a=e.defaultValues,s=e._id,c=e.disabled,f=(0,d.Z)(e,j),v=(0,Z.Z)(),m=(0,u.useState)(!1),b=(0,l.Z)(m,2),y=b[0],L=b[1],P=(0,g.hN)({defaultValues:{dimensions:null!==a&&void 0!==a?a:{}}}),_=!(null===(i=P.formState.dirtyFields)||void 0===i||!i.dimensions)&&(null===(n=Object.values(null===(o=P.formState.dirtyFields)||void 0===o?void 0:o.dimensions))||void 0===n?void 0:n.some((function(e){return e})));return(0,p.jsx)(x.h,(0,t.Z)((0,t.Z)({onSubmit:P.handleSubmit((function(e){v.updateById({data:{data:{data:e,_id:s}},onSuccess:function(e){S.kl.success("Product updated")},onError:function(e){console.error("Product update action",e)},onLoading:L})})),label:(0,r.t)("Package size"),isLoading:y,isOpen:!1},f),{},{disabled:!_||c,children:(0,p.jsx)(h,{form:P,disabled:c})}))}},5888:function(e,i,n){n.d(i,{A:function(){return v}});var o=n(1413),t=n(9439),l=n(1494),d=n(1819),a=n(2791),r=n(9006),u=n(713),s=n(959),c=n(6522),f=n(3329),v=function(e){var i,n,v=e.offer,p=e.onSubmit,m=e.onSuccess,b=e.disabled,h=e.defaultValues,g=(0,l.useOfferLoadersProvider)(),x=(0,a.useState)(h||(null===g||void 0===g||null===(i=g.state)||void 0===i?void 0:i.images)||[]),Z=(0,t.Z)(x,2),S=Z[0],j=Z[1],y=(0,d.xc)()[d.EJ.offers],L=(0,a.useMemo)((function(){return!(null===S||void 0===S||!S.length)}),[null===S||void 0===S?void 0:S.length]);return(0,f.jsx)(r.h,{label:(0,c.t)("Images"),onSubmit:function(e){e.preventDefault(),p?p(S):v?y.updateById({data:{refresh:!0,data:(0,o.Z)((0,o.Z)({},(0,s.rE)(v)),{},{data:{images:S}})},onSuccess:m,onLoading:g.onLoading("images")}):console.warn("Offer not passed")},canSubmit:L,disabled:b,isLoading:null===(n=g.isLoading)||void 0===n?void 0:n.images,isOpen:!1,maxHeight:"400px",children:(0,f.jsx)(u.Z,{hideLabel:!0,initialData:S,onChangeState:j,contentContainerStyle:{flex:1}})})}},9306:function(e,i,n){n.d(i,{n:function(){return y}});var o=n(1413),t=n(9439),l=n(4925),d=n(8553),a=n(3423),r=n(4990),u=n(6681),s=n(8095),c=n(2791),f=n(6522),v=n(3096),p=n(3329),m=(0,d.H1)(v.q),b=[{name:"measurement.unit",label:(0,f.t)("unit"),placeholder:(0,f.t)("unit"),options:m},{name:"measurement.min",label:(0,f.t)("min"),placeholder:(0,f.t)("min"),type:"number"},{name:"measurement.max",label:(0,f.t)("max"),placeholder:(0,f.t)("max"),type:"number"}],h=function(e){var i=e.appForm,n=e.disabled;return(0,p.jsx)(s.ZP,{fillWidth:!0,style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",columnGap:8},children:b.map((function(e){var t;return e.options?(0,p.jsx)(a.Z,(0,o.Z)((0,o.Z)({},i.registerSelect(null===e||void 0===e?void 0:e.name,{options:null===e||void 0===e?void 0:e.options,label:null===e||void 0===e?void 0:e.label,placeholder:null===e||void 0===e?void 0:e.label,onlyValue:!0})),{},{disabled:n}),e.name):(0,p.jsx)(r.Z,{label:e.label,error:null===i||void 0===i||null===(t=i.formState)||void 0===t?void 0:t.errors[e.name],children:(0,p.jsx)(u.ZP,(0,o.Z)((0,o.Z)({placeholder:e.placeholder,min:"number"===(null===e||void 0===e?void 0:e.type)?1:void 0,type:null===e||void 0===e?void 0:e.type},i.register(e.name,{valueAsNumber:"number"===(null===e||void 0===e?void 0:e.type),min:"number"===(null===e||void 0===e?void 0:e.type)?1:void 0})),{},{disabled:n}))},e.name)}))})},g=n(2989),x=n(9006),Z=n(9994),S=n(1383),j=["defaultValues","_id","disabled"],y=function(e){var i,n,d,a=e.defaultValues,r=e._id,u=e.disabled,s=(0,l.Z)(e,j),v=(0,Z.Z)(),m=(0,c.useState)(!1),b=(0,t.Z)(m,2),y=b[0],L=b[1],P=(0,g.hN)({defaultValues:{measurement:a}}),_=!(null===(i=P.formState.dirtyFields)||void 0===i||!i.measurement)&&(null===(n=Object.values(null===(d=P.formState.dirtyFields)||void 0===d?void 0:d.measurement))||void 0===n?void 0:n.some((function(e){return e})));return(0,p.jsx)(x.h,(0,o.Z)((0,o.Z)({onSubmit:P.handleSubmit((function(e){v.updateById({data:{data:{data:e,_id:r}},update:!0,onSuccess:function(e){S.kl.success("Product updated")},onError:function(e){console.error("Product update action",e)},onLoading:L})})),label:(0,f.t)("Measurement info"),isLoading:y,disabled:!_||u,isOpen:!1},s),{},{children:(0,p.jsx)(h,{appForm:P,disabled:u})}))}},8160:function(e,i,n){n.d(i,{R:function(){return S}});var o,t=n(168),l=n(7762),d=n(9439),a=n(2791),r=n(9006),u=n(2360),s=n(8095),c=n(7348),f=n(1819),v=n(1494),p=n(6522),m=n(5998),b=n(98),h=n(6492),g=n(2989),x=n(959),Z=n(3329),S=function(e){var i,n,o=e.onSuccess,t=e.disabled,u=e.offer,S=(0,v.useOfferLoadersProvider)(),y=(0,c.i7)(),L=(0,g.G2)(u),P=(0,f.xc)().get(f.EJ.offers),_=(0,x.sK)(null===L||void 0===L||null===(i=L.properties)||void 0===i?void 0:i.map((function(e){return e._id}))),V=(0,a.useState)(_),O=(0,d.Z)(V,2),C=O[0],D=O[1],w=(0,a.useState)(),B=(0,d.Z)(w,2),I=B[0],k=B[1],A=(0,a.useMemo)((function(){var e;return!(null===C||void 0===C||!C.length)&&(null===_||void 0===_?void 0:_.join(","))!==(null===(e=(0,x.sK)(C))||void 0===e?void 0:e.join(","))}),[C,_]),E=(0,a.useMemo)((function(){var e,i,n,o=null===I||void 0===I?void 0:I._id,t=[],d=null!==(e=null===(i=y.propertiesKeysMap)||void 0===i?void 0:i[null!==o&&void 0!==o?o:"def"])&&void 0!==e?e:[],a=(0,l.Z)(d);try{for(a.s();!(n=a.n()).done;){var r,u=n.value,s=null===(r=y.propertiesDataMap)||void 0===r?void 0:r[u];if(s&&(null===s||void 0===s||!s.isSelectable)){var c=y.propertiesKeysMap[null===s||void 0===s?void 0:s._id];null!==c&&void 0!==c&&c.length&&t.push(s)}}}catch(f){a.e(f)}finally{a.f()}return t}),[I,y.propertiesDataMap,y.propertiesKeysMap]),M=(0,a.useCallback)((function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";D((function(e){return(0,x.ES)({arr:e,id:i,toggle:!0})}))}),[]),F=(0,a.useMemo)((function(){return null===E||void 0===E?void 0:E.map((function(e){return(0,Z.jsx)(b.Z,{item:e,selectedIds:C,onSelect:M},"prop_".concat(e._id))}))}),[E,C,M]);return(0,Z.jsxs)(r.h,{label:(0,p.t)("Properties"),canSubmit:A,onSubmit:function(e){e.preventDefault(),L&&P.updateById({data:{data:{_id:null===L||void 0===L?void 0:L._id,data:{properties:C}}},update:!0,onLoading:S.onLoading("properties"),onSuccess:o})},isLoading:null===(n=S.isLoading)||void 0===n?void 0:n.properties,isOpen:!1,disabled:!L||t,children:[(0,Z.jsx)(m.U,{selected:I,onSelect:k}),(0,Z.jsx)(j,{flex:1,overflow:"auto",children:null!==F&&void 0!==F&&F.length?F:(0,Z.jsx)(s.ZP,{padding:"24px",alignItems:"center",justifyContent:"center",children:(0,Z.jsx)(h.x,{$size:16,children:(0,p.t)("Data not found")})})})]})},j=(0,u.ZP)(s.ZP)(o||(o=(0,t.Z)(["\n  padding-bottom: 8px;\n"])))},1494:function(e,i,n){n.r(i),n.d(i,{useOfferLoadersProvider:function(){return x}});var o=n(9420),t=n(8050),l=n(6522),d=n(959),a=n(2791),r=n(9306),u=n(3007),s=n(8095),c=n(8160),f=n(9541),v=n(7578),p=n(5888),m=n(2989),b=n(7608),h=n(5248),g=n(3329),x=function(){return(0,v.un)()};i.default=function(e){var i,n=e.onClose,x=(e._id,(0,f.J)()),Z=x.state.formData,S=x.setData,j=(0,m.xj)(),y=(0,m.G2)({_id:null===(i=j.query)||void 0===i?void 0:i.offerId});return(0,a.useEffect)((function(){}),[]),(0,g.jsx)(t.Z,{title:(0,l.t)("Create offer"),onClose:n,children:(0,g.jsx)(v.f4,{value:x,children:(0,g.jsxs)(s.ZP,{padding:"0 8px 16px",children:[(0,g.jsx)(u.B,{defaultValues:Z,onSuccess:function(e){var i=e.data;S("formData",(0,d.xT)(i)),j.push({query:{offerId:null===i||void 0===i?void 0:i._id}})},type:null===Z||void 0===Z?void 0:Z.type}),y&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(b.A,{offer:y,defaultValues:null===Z||void 0===Z?void 0:Z.categories,disabled:!Z}),(0,g.jsx)(c.R,{offer:y,defaultValues:null===Z||void 0===Z?void 0:Z.properties,disabled:!Z}),(0,g.jsx)(h.L,{expandable:!0,isOpen:!1,offer:y,defaultState:null===y||void 0===y?void 0:y.price,price:null===y||void 0===y?void 0:y.price,title:(0,l.t)("Price")}),(0,g.jsx)(p.A,{offer:y,defaultValues:null===Z||void 0===Z?void 0:Z.images,disabled:!Z}),(0,g.jsx)(o.A,{offer:y,defaultValues:null===Z||void 0===Z?void 0:Z.dimensions,disabled:!Z}),(0,g.jsx)(r.n,{offer:y,defaultValues:null===Z||void 0===Z?void 0:Z.measurement,disabled:!Z})]})]})})})}}}]);
//# sourceMappingURL=494.6a1d0fc4.chunk.js.map