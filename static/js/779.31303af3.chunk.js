"use strict";(self.webpackChunkcounter_app_ts=self.webpackChunkcounter_app_ts||[]).push([[779,264],{1779:function(e,n,i){i.r(n),i.d(n,{default:function(){return E}});var t,o=i(168),a=i(2360),r=i(8095),l=i(8495),d=i(6146),s=i(400),u=i(6366),c=i(4897),f=i(2791),v=i(3665),p=i(2928),h=i(9006),x=i(2989),g=i(4781),m=i(2483),j=i(1413),b=i(9439),Z=i(1819),y=i(7824),w=i(882),C=i(1483),P=i(7294),S=i(763),D=i(6492),k=i(6522),I=i(3299),$=i(6681),_=i(3329),z=function(e){var n,i=e.slot,t=e.onChangeQuantity,o=(0,f.useState)(null!==(n=null===i||void 0===i?void 0:i.quantity)&&void 0!==n?n:1),l=(0,b.Z)(o,2),d=l[0],s=l[1],u=(0,a.Fg)(),c=(0,f.useRef)(),v=(0,f.useRef)(),p=function(e){return function(){var n=null===i||void 0===i?void 0:i.quantity;!(0,S.isUndefined)(n)&&t?t(n+e<0?n:n+e):s((function(n){return n+e<0?n:n+e}))}},h=function(e){return{onMouseDown:function(){c.current=setTimeout((function(){v.current=setInterval((function(){s((function(n){return n+e<0?n:n+e}))}),100)}),250)},onMouseUp:function(){clearTimeout(c.current),clearInterval(v.current),c.current=void 0,v.current=void 0,t&&t(d)}}};return(0,f.useEffect)((function(){var e=null===i||void 0===i?void 0:i.quantity;(0,S.isUndefined)(e)||s(e)}),[null===i||void 0===i?void 0:i.quantity]),(0,_.jsxs)(r.ZP,{flexWrap:"wrap",gap:8,padding:"8px",fxDirection:"row",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr"},children:[["cashback","bonus","discount"].map((function(e){var n;return(0,_.jsxs)(r.ZP,{background:u.fieldBackgroundColor,borderRadius:"6px",justifyContent:"space-between",children:[(0,_.jsx)(D.x,{$weight:400,$size:12,$padding:"4px 6px",children:(0,k.t)(e)}),(0,_.jsx)(D.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,I.pU)(null===i||void 0===i||null===(n=i[e])||void 0===n?void 0:n.amount)})]},e)})),["brutto","netto"].map((function(e){return(0,_.jsxs)(r.ZP,{background:u.fieldBackgroundColor,borderRadius:"6px",justifyContent:"space-between",children:[(0,_.jsx)(D.x,{$weight:400,$size:12,$padding:"4px 6px",children:(0,k.t)(e)}),(0,_.jsx)(D.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,I.pU)(null===i||void 0===i?void 0:i[e])})]},e)})),(0,_.jsxs)(r.ZP,{padding:"0 8px",children:[(0,_.jsx)(R,(0,j.Z)((0,j.Z)({variant:"def",iconSize:"15px",icon:"SmallArrowUp"},h(1)),{},{onClick:p(1)})),(0,_.jsx)($.ZP,{value:d,name:"quantity",align:"center",onChange:function(e){s(Number(e.target.value))},onBlur:function(){t&&t(d)}}),(0,_.jsx)(R,(0,j.Z)((0,j.Z)({variant:"def",iconSize:"15px",icon:"SmallArrowDown"},h(-1)),{},{onClick:p(-1)}))]})]})},R=(0,a.ZP)(p.Z)(t||(t=(0,o.Z)(["\n  height: 15px;\n\n  &:hover {\n    padding: 4px 0;\n  }\n"]))),q=i(1251),L=i(8189),A=i(8050),T=function(e){var n,i=e.offer,t=e.warehouse,o=(e.slotId,e.onClose),a=(0,v.f9)(),r=(0,x.G2)(i),l=(0,f.useState)(),d=(0,b.Z)(l,2),s=d[0],c=d[1],p=(0,u.jD)(),h=p.actions.getSlotByVariationId(null===s||void 0===s?void 0:s._id),g=(0,f.useState)(null!==(n=null===h||void 0===h?void 0:h.quantity)&&void 0!==n?n:1),m=(0,b.Z)(g,2),Z=m[0],y=m[1],w=(0,f.useMemo)((function(){var e;return(0,C.Gn)((0,j.Z)((0,j.Z)((0,j.Z)({},h),{},{quantity:Z},null!==(e=null===s||void 0===s?void 0:s.price)&&void 0!==e?e:null===r||void 0===r?void 0:r.price),{},{offer:r,variation:s,warehouse:null!==t&&void 0!==t?t:null===r||void 0===r?void 0:r.warehouse}))}),[h,r,Z,s,t]);return(0,_.jsxs)(A.Z,{title:"Select variation | ".concat(null===r||void 0===r?void 0:r.label),fillHeight:!0,children:[(0,_.jsx)(L.Z,{offer:r,onSelect:c,selected:s}),(0,_.jsx)(z,{slot:w,onChangeQuantity:y}),(0,_.jsx)(q.AT,{canAccept:!!s,onAcceptPress:function(){var e;null!==s&&void 0!==s&&s._id&&(null!==w&&void 0!==w&&w.tempId&&null!==w&&void 0!==w&&null!==(e=w.tempId)&&void 0!==e&&e.includes(null===s||void 0===s?void 0:s._id)?w.quantity!==h.quantity&&p.actions.update(w):null!==w&&void 0!==w&&w.warehouse&&p.actions.addSlot(w),a.clearStack());o&&o()}})]})};function M(e){var n,i,t=e.warehouse,o=e.slotId,a=(0,u.jD)(),r=(0,Z.xc)().get(y.d.offers).getAll,l=a.actions.getSlot(o),d=(0,x.xj)(),c=(0,f.useState)(),p=(0,b.Z)(c,2),h=p[0],g=p[1],m=(0,f.useState)(null!==(n=null===l||void 0===l?void 0:l.quantity)&&void 0!==n?n:1),S=(0,b.Z)(m,2),D=S[0],k=S[1],I=(0,v.kw)(),$=(0,w.useOffersTableSettings)({searchState:null!==t&&void 0!==t&&t.label?{search:null!==(i=null===t||void 0===t?void 0:t.label)&&void 0!==i?i:"",param:{dataPath:"warehouse.label",label:"\u0421\u043a\u043b\u0430\u0434"}}:void 0}),R=$.tableConfig,L=$.isLoading,A=$.searchParams,M=(0,f.useMemo)((function(){return(0,C.Gn)((0,j.Z)((0,j.Z)({},l),{},{quantity:D},null===h||void 0===h?void 0:h.price))}),[l,D,null===h||void 0===h?void 0:h.price]);return(0,f.useEffect)((function(){var e,n=(0,C.P_)(null===A||void 0===A||null===(e=A.param)||void 0===e?void 0:e.dataPath,null===A||void 0===A?void 0:A.search);t&&r({data:{refresh:!0,params:n}})}),[]),(0,_.jsxs)(P.Z,{title:(null===t||void 0===t?void 0:t.label)||"Select offer",fillHeight:!0,children:[(0,_.jsx)(s.ZP,(0,j.Z)((0,j.Z)({},R),{},{isLoading:null===L||void 0===L?void 0:L.offers,checkBoxes:!1,selectedRow:h,onRowClick:function(e){var n,i;null!==e&&void 0!==e&&e.rowData&&((null===e||void 0===e||null===(n=e.rowData)||void 0===n?void 0:n._id)&&d.push({query:{offerId:null===e||void 0===e||null===(i=e.rowData)||void 0===i?void 0:i._id}}),g(null===e||void 0===e?void 0:e.rowData))}})),h&&(0,_.jsx)(z,{slot:M,onChangeQuantity:k}),(0,_.jsx)(q.AT,{canAccept:!!h,onAcceptPress:function(){h&&I.create(T,{offer:h})}})]})}var U,V=i(7121);function B(e){e.warehouse;var n,i,t=(0,u.jD)(),o=(0,x.zR)(),a=t.actions.getSlot(null===(n=o.query)||void 0===n?void 0:n.slotId),l=(0,f.useState)(a.variation),d=(0,b.Z)(l,1)[0],s=(0,f.useState)(null!==(i=null===a||void 0===a?void 0:a.quantity)&&void 0!==i?i:1),c=(0,b.Z)(s,2),v=c[0],p=c[1],h=(0,f.useMemo)((function(){return(0,C.Gn)((0,j.Z)((0,j.Z)((0,j.Z)({},null===d||void 0===d?void 0:d.price),{},{offer:d,variation:d},a),{},{quantity:v}))}),[a,v,d]);return(0,_.jsxs)(F,{fillHeight:!0,maxWidth:"380px",flex:1,padding:"0 8px 8px",children:[(0,_.jsx)(V.iw,{title:"Current slot"}),(0,_.jsx)(r.ZP,{flex:1}),(0,_.jsx)(z,{slot:h,onChangeQuantity:p}),(0,_.jsx)(q.AT,{canAccept:!!a.tempId&&a.quantity!==v,onAcceptPress:function(){a.setQty(v)}})]})}var H,O,F=(0,a.ZP)(r.ZP)(U||(U=(0,o.Z)(["\n  position: relative;\n  overflow: hidden;\n\n  background-color: ",";\n"])),(function(e){return e.theme.sideBarBackgroundColor})),W=i(4805);function E(e){var n,i=e.path,t=(0,x.zR)(),o=(0,x.Zx)(),a=(0,W.useMediaQuery)({query:"(min-width: 960px)"}),l=(0,u.jD)();return(0,f.useEffect)((function(){o.cartId&&l.actions.setCartId(o.cartId)}),[]),(0,_.jsx)(d.vI,{path:i,children:(0,_.jsxs)(g.ZP,{children:[(0,_.jsxs)(G,{fillWidth:!0,flex:1,overflow:"hidden",fillHeight:!0,fxDirection:"row",gap:12,children:[(0,_.jsx)(r.ZP,{fillHeight:!0,flex:2,children:(0,_.jsx)(J,{})}),(0,_.jsx)(Q,{isVisible:a?void 0:!(null===t||void 0===t||null===(n=t.query)||void 0===n||!n.slotId),className:"RightSide",style:{},children:(0,_.jsx)(B,{})})]}),(0,_.jsx)(m.j,{})]})})}var G=(0,a.ZP)(r.ZP)(H||(H=(0,o.Z)(["\n  ","\n"])),l.VU),Q=(0,a.ZP)(r.ZP)(O||(O=(0,o.Z)(["\n  overflow: auto;\n\n  max-width: 100%;\n  height: 100%;\n\n  transition: ",";\n  background-color: ",";\n\n  @media screen and (min-width: 768px) {\n    min-width: 320px;\n  }\n\n  @media screen and (max-width: 768px) {\n    position: absolute;\n    top: 0;\n    right: 0;\n    z-index: 250;\n    height: 100%;\n\n    transform: translateX(","%);\n\n    box-shadow: 0 12px 26px rgba(0, 0, 0, 0.25);\n  }\n"])),(function(e){return e.theme.globals.timingFunctionMain}),(function(e){return e.theme.backgroundColorLight}),(function(e){return e.isVisible?0:100}));function J(e){e.onSlotEditPress;var n=(0,x.zR)().query.cartId,i=(0,u.jD)(),t=(0,v.kw)(),o=(0,x.xj)(),l=(0,a.Fg)(),d=i.actions.getCurrentCart(n),g=(0,f.useMemo)((function(){var e=null===d||void 0===d?void 0:d.ordersIds;return null===e||void 0===e?void 0:e.map((function(e,n){var a,l,d;if(!e)return null;var u=i.actions.getOrderById(e),f=null===(a=i.ordersSlotsMap)||void 0===a?void 0:a[e];return(0,_.jsx)(h.y,{label:null!==(l=(0,k.t)("Warehouse")+": "+(null===u||void 0===u||null===(d=u.warehouse)||void 0===d?void 0:d.label))&&void 0!==l?l:(0,k.t)("undefined"),hideFooter:!0,children:(0,_.jsx)(r.ZP,{minHeight:"300px",children:(0,_.jsx)(s.ZP,{tableData:f,hasSearch:!1,hasFilter:!1,tableTitles:c.KS,actionsCreator:function(e){var n,a=null===(n=e.selectedRow)||void 0===n?void 0:n.tempId;return[{icon:"delete",disabled:!a,onClick:function(){a&&i.actions.remove(a)}},{icon:"edit",disabled:!a,onClick:function(){a&&o.push({query:{slotId:a}})}},{icon:"plus",disabled:!(null!==u&&void 0!==u&&u.warehouse),onClick:function(){(null===u||void 0===u?void 0:u.warehouse)&&t.create(M,{warehouse:null===u||void 0===u?void 0:u.warehouse})}}]}})})},null!==e&&void 0!==e?e:n)}))}),[null===d||void 0===d?void 0:d.ordersIds,i.actions,i.ordersSlotsMap,t,o]);return(0,_.jsxs)(r.ZP,{overflow:"auto",fillHeight:!0,children:[(0,_.jsx)(h.y,{label:"Cart: ".concat(null===d||void 0===d?void 0:d.tempId),expandable:!0,isOpen:!0,hideFooter:!0,children:(0,_.jsxs)(r.ZP,{padding:"8px 12px",flexWrap:"wrap",fxDirection:"row",gap:10,children:[["cashback","bonus","discount"].map((function(e){var n,i;return(0,_.jsxs)(r.ZP,{background:l.backgroundColorSecondary,borderRadius:"4px",justifyContent:"space-between",children:[(0,_.jsx)(D.x,{$weight:400,$size:12,$padding:"4px 6px",$textTransform:"capitalize",children:(0,k.t)(e)}),(0,_.jsx)(D.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,I.pU)(null===d||void 0===d||null===(n=d.summary)||void 0===n||null===(i=n[e])||void 0===i?void 0:i.amount)})]},e)})),["brutto","netto"].map((function(e){var n;return(0,_.jsxs)(r.ZP,{background:l.backgroundColorSecondary,borderRadius:"4px",justifyContent:"space-between",children:[(0,_.jsx)(D.x,{$weight:400,$size:12,$padding:"4px 6px",$textTransform:"capitalize",children:(0,k.t)(e)}),(0,_.jsx)(D.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,I.pU)(null===d||void 0===d||null===(n=d.summary)||void 0===n?void 0:n[e])})]},e)}))]})}),(0,_.jsx)(r.ZP,{flex:1,children:g}),(0,_.jsx)(r.ZP,{fxDirection:"row",gap:12,padding:"16px",fillWidth:!0,alignItems:"center",justifyContent:"center",style:{position:"sticky",bottom:0,left:0},children:(0,_.jsx)(p.Z,{variant:"filledMiddle",icon:"plus",onClick:function(){t.create(M,{})},children:"Create"})})]})}},882:function(e,n,i){i.r(n),i.d(n,{default:function(){return D},useOffersTableSettings:function(){return k}});var t,o=i(9439),a=i(168),r=i(1413),l=i(400),d=i(8495),s=i(2360),u=i(2791),c=i(6931),f=i(7348),v=function(){return[]},p=i(3665),h=i(1819),x=i(6522),g=i(7264),m=i(1494),j=i(2410),b=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).loaders,n=(0,h.xc)().get(h.EJ.offers),i=(0,j.x)(),t=(0,p.f9)(),o=(0,f.i7)().dataMap;return(0,u.useCallback)((function(a){var r,l=null===(r=a.selectedRow)||void 0===r?void 0:r._id,d=l?null===o||void 0===o?void 0:o[l]:void 0;return[{name:"refreshData",title:(0,x.t)("Refresh data"),icon:"refresh",type:"onlyIcon",onClick:function(){n.getAll({data:{refresh:!0},onLoading:e?e.onLoading("refresh"):a.onRefresh})}},{separator:!0},{name:"review",title:"\u041f\u0435\u0440\u0435\u0433\u043b\u044f\u0434 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0443",icon:"openInNew",disabled:!l,type:"onlyIcon",navTo:"/app/".concat(i.params.permissionId,"/offers/")+l},{name:"edit",title:"\u0417\u043c\u0456\u043d\u0438\u0442\u0438",icon:"edit",iconSize:"90%",type:"onlyIcon",disabled:!l,onClick:function(){d?t.create(g.default,{offer:d}):l&&n.getOne({data:{data:{params:{_id:l}}},onLoading:e?e.onLoading("offer"):a.onRefresh,onSuccess:function(e){var n=e.data;t.create(g.default,{offer:n})}})}},{name:"copy",title:"\u041a\u043e\u043f\u0456\u044e\u0432\u0430\u0442\u0438",icon:"copy",iconSize:"90%",type:"onlyIcon",disabled:!d,onClick:function(){d&&t.create(g.default,{offer:d,copy:!0})}},{name:"archiveProduct",title:"\u0410\u0440\u0445\u0456\u0432",icon:"archive",iconSize:"90%",type:"onlyIcon",disabled:!0},{separator:!0},{name:"createProduct",title:"\u041d\u043e\u0432\u0438\u0439",icon:"plus",iconSize:"90%",type:"onlyIconFilled",disabled:!1,onClick:function(){t.create(m.default)}}]}),[e,t,i,n,o])},Z=i(4897),y=i(9541),w=i(7824),C=i(1483),P=i(3329),S=s.ZP.div(t||(t=(0,a.Z)(["\n  ","\n"])),d.VU),D=function(e){var n=k({}),i=n.tableConfig,t=n.isLoading;return(0,P.jsx)(c.default,{path:e.path,children:(0,P.jsx)(S,{children:(0,P.jsx)(l.ZP,(0,r.Z)((0,r.Z)({},i),{},{isLoading:null===t||void 0===t?void 0:t.offers}))})})},k=function(e){var n=e.searchState,i=e.sortState,t=(0,y.J)({offers:{content:"Refreshing..."},refresh:{content:"Refreshing..."},offer:{content:"Refreshing..."}}),a=t.onLoading,r=t.isLoading,l=(0,h.xc)().get(w.d.offers).getAll,d=(0,f.i7)(),s=v(),c=b({loaders:t}),p=(0,u.useState)(i),x=(0,o.Z)(p,2),g=x[0],m=x[1],j=(0,u.useState)(n),P=(0,o.Z)(j,2),S=P[0],D=P[1],k=(0,u.useMemo)((function(){return{onSubmitSearch:function(e){if(e.search){var n,i,t=null!==(n=e.param)&&void 0!==n&&n.dataPath?(0,C.P_)(null===(i=e.param)||void 0===i?void 0:i.dataPath,e.search):void 0;D(e),l({data:{refresh:!0,params:t},onLoading:a("offers")}).then()}else l({data:{refresh:!0},onLoading:a("offers")}).then()},tableData:d.list,tableTitles:Z.Y5,searchParams:Z.Dr,sortParams:Z.Cs,filterSelectors:s,hasFilter:!0,hasSearch:!0,showFooter:!1,checkBoxes:!0,actionsCreator:c,onTableSortChange:function(e,n){m({param:e,order:n}),l({data:{refresh:!0,params:{sortOrder:n,dataKey:null===e||void 0===e?void 0:e.dataKey,dataPath:null===e||void 0===e?void 0:e.dataPath}},onLoading:a("offers")}).then()}}}),[c,s,l,a,d.list]);return(0,u.useEffect)((function(){0===d.list.length&&l({data:{refresh:!0},onLoading:a("offers")})}),[]),{tableConfig:k,isLoading:r,sortParams:g,searchParams:S}}},7264:function(e,n,i){i.r(n);var t=i(1413),o=i(9420),a=i(8050),r=i(6522),l=i(1483),d=i(3691),s=i(9306),u=i(3007),c=i(8095),f=i(6653),v=i(6492),p=i(9541),h=i(7578),x=i(8782),g=i(5888),m=i(2989),j=i(7608),b=i(5248),Z=i(3329);n.default=function(e){var n,i,y,w,C,P,S,D,k,I,$=e.onClose,_=e.offer,z=e.copy,R=(0,m.G2)(_),q=(0,p.J)({offer_refresh:{content:"Refreshing..."},offer_update:{content:"Updating..."}},{formData:R?(0,l.xT)(R):{type:d.iv.GOODS}}),L=q.setData,A=q.state,T=z?null===(n=A.formData)||void 0===n?void 0:n._id:null===R||void 0===R?void 0:R._id;return R?(0,Z.jsx)(a.Z,{fillHeight:!0,title:z?(0,r.t)("Copy offer"):(0,r.t)("Update offer"),onClose:$,children:(0,Z.jsx)(h.f4,{value:q,children:null!==(i=q.isLoading)&&void 0!==i&&i.offer?(0,Z.jsxs)(c.ZP,{fillWidth:!0,padding:"24px",alignItems:"center",gap:16,children:[(0,Z.jsx)(f.$,{size:52}),(0,Z.jsx)(v.x,{children:(0,r.t)("Loading info about offer...")})]}):(0,Z.jsxs)(c.ZP,{padding:"0 8px 16px",children:[(0,Z.jsx)(u.B,{_id:T,edit:!z,type:null===(y=A.formData)||void 0===y?void 0:y.type,defaultValues:null===A||void 0===A?void 0:A.formData,onSuccess:function(e){var n=e.data;L("formData",z?(0,t.Z)((0,t.Z)({},(0,l.xT)(n)),{},{_id:n._id}):(0,l.xT)(n))}}),(0,Z.jsx)(j.A,{_id:T,offer:R,defaultValues:null===(w=A.formData)||void 0===w?void 0:w.categories,disabled:!A.formData}),(0,Z.jsx)(x.R,{_id:T,offer:R,defaultValues:null===(C=A.formData)||void 0===C?void 0:C.properties,disabled:!A.formData}),(0,Z.jsx)(b.L,{expandable:!0,isOpen:!1,offer:R,defaultState:null===R||void 0===R?void 0:R.price,price:null===R||void 0===R?void 0:R.price,title:(0,r.t)("Price")}),(0,Z.jsx)(g.A,{offer:R,defaultValues:null===A||void 0===A||null===(P=A.formData)||void 0===P?void 0:P.images,disabled:!(null!==A&&void 0!==A&&A.formData),_id:T}),(0,Z.jsx)(o.A,{offer:R,defaultValues:null===(S=A.formData)||void 0===S?void 0:S.dimensions,disabled:z?!(null!==(D=A.formData)&&void 0!==D&&D._id&&A.formData):!T,_id:T}),(0,Z.jsx)(s.n,{offer:R,defaultValues:null===(k=A.formData)||void 0===k?void 0:k.measurement,disabled:z?!(null!==(I=A.formData)&&void 0!==I&&I._id&&A.formData):!T,_id:T})]})})}):(0,Z.jsx)(a.Z,{title:z?(0,r.t)("Copy offer"):(0,r.t)("Update offer"),fillHeight:!0,children:(0,Z.jsx)(c.ZP,{fillWidth:!0,fillHeight:!0,padding:"26px",alignItems:"center",justifyContent:"center",children:(0,Z.jsx)(v.x,{$size:16,$weight:600,children:(0,r.t)("Offer not found")})})})}}}]);
//# sourceMappingURL=779.31303af3.chunk.js.map