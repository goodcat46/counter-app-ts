"use strict";(self.webpackChunkcounter_app_ts=self.webpackChunkcounter_app_ts||[]).push([[265],{3265:function(e,n,o){o.r(n),o.d(n,{FormCreateOrdersGroupStepsEnum:function(){return ke},_transformOrderInfoForReq:function(){return Fe},default:function(){return Be}});var i,t,r,l,a=o(168),d=o(1413),u=o(9439),c=o(4942),s=o(8553),v=o(7506),f=o(853),h=o(2791),m=o(2360),p=o(8095),x=o(1251),Z=o(6522),g=o(7606),b=o(3433),j=o(7348),C=o(8302),S=o(1383),y=o(825),w=o(5188),P=o(6201),I=o(4636),D=o(6492),q=o(3329),k=(0,m.ZP)(I.Z)(i||(i=(0,a.Z)(["\n  & .header {\n  }\n  & .content {\n    padding: 0;\n  }\n"]))),M=function(e){var n=e.slots,o=e.onRemove,i=e.onUpdate,t=e.renderHeader,r=e.title,l=e.onAddSlotPress,a=e.renderFooter,d=(0,m.Fg)(),u=(0,h.useMemo)((function(){return n.map((function(e){return(0,q.jsx)(P.Z,{slot:e,editable:!0,onRemovePress:o?function(){return(null===e||void 0===e?void 0:e.tempId)&&o(null===e||void 0===e?void 0:e.tempId)}:void 0,onUpdate:i},"slot_".concat(null===e||void 0===e?void 0:e.tempId))}))}),[o,i,n]),c=(0,h.useMemo)((function(){return(0,q.jsxs)(p.ZP,{fxDirection:"row",fillHeight:!0,gap:8,alignItems:"center",padding:"2px 0",children:[t||(0,q.jsx)(D.x,{$weight:500,$size:15,children:r}),l&&(0,q.jsx)(p.ZP,{height:"80%",border:"1px solid ".concat(d.modalBorderColor)}),l&&(0,q.jsx)(C.Z,{variant:"textExtraSmall",style:{minWidth:"fit-content",height:"100%",fontWeight:600},disabled:!l,onClick:l,children:(0,Z.t)("Add")})]})}),[l,t,d.modalBorderColor,r]);return(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(k,{open:!0,renderHeader:c,renderFooter:a,title:r,children:u})})},A=o(2655),R=o(4805),E=o(2437),W=o(7824),B=(0,m.ZP)(p.ZP)(t||(t=(0,a.Z)(["\n  color: ",";\n"])),(function(e){return e.theme.fontColorSidebar})),F=(0,m.ZP)(p.ZP)(r||(r=(0,a.Z)([""]))),_=(0,m.ZP)(p.ZP)(l||(l=(0,a.Z)(["\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),V=function(e){var n=e.onChangeValidStatus,o=(0,w.kw)(),i=(0,E.xc)()[W.d.orders],t=(0,j.xA)().ordersGroupFormData.slots,r=(0,R.useMediaQuery)({maxWidth:480}),l=(0,h.useCallback)((function(e){i.addTempSlot(e)}),[i]),a=(0,h.useCallback)((function(e){i.removeTempSlot(e)}),[i]),d=(0,h.useCallback)((function(e){i.updateTempSlot(e)}),[i]),u=(0,h.useMemo)((function(){var e={};return null===t||void 0===t||t.map((function(n){var o,i,t;null!==(o=n.warehouse)&&void 0!==o&&o._id&&(e[n.warehouse._id]={warehouse:n.warehouse,slots:null!==(i=e[n.warehouse._id])&&void 0!==i&&i.slots?[].concat((0,b.Z)(null===(t=e[n.warehouse._id])||void 0===t?void 0:t.slots),[n]):[n]});return""})),e}),[t]);(0,h.useEffect)((function(){n&&n(!(null===t||void 0===t||!t.length)&&(null===t||void 0===t?void 0:t.length)>0)}),[n,null===t||void 0===t?void 0:t.length]);var c=(0,h.useMemo)((function(){return Object.keys(u).map((function(e,n){var i,t,r=u[e];return(0,q.jsx)(M,{slots:r.slots,title:null===r||void 0===r||null===(t=r.warehouse)||void 0===t?void 0:t.label,onRemove:a,onUpdate:d,onAddSlotPress:function(){var e=o.open({Modal:y.n.FormCreateOrderSlot,props:{params:null!==r&&void 0!==r&&r.warehouse?{warehouse:(0,A.rE)(null===r||void 0===r?void 0:r.warehouse)}:void 0,onSubmit:function(n){l(n),n&&null!==e&&void 0!==e&&e.onClose&&(null===e||void 0===e||e.onClose())}}})}},"pre-order_".concat((null===(i=r.warehouse)||void 0===i?void 0:i._id)||n))}))}),[u,l,a,d,o]);return(0,q.jsxs)(B,{flex:1,fillWidth:!0,overflow:"hidden",style:{position:"relative"},children:[(0,q.jsx)(F,{flex:1,overflow:"auto",children:(0,q.jsx)(p.ZP,{flex:1,fillWidth:!0,children:c})}),(0,q.jsxs)(_,{fxDirection:"row",gap:8,padding:"8px",children:[(0,q.jsx)(C.Z,{variant:"defOutlinedSmall",onClick:function(){window.confirm("Remove all items?")&&S.kl.info("All items will be remove")},children:(0,Z.t)("Remove all")}),(0,q.jsx)(C.Z,{variant:"outlinedSmall",flex:1,onClick:function(){var e=o.open({Modal:y.n.FormCreateOrderSlot,props:{onSubmit:function(n){l(n),n&&null!==e&&void 0!==e&&e.onClose&&(null===e||void 0===e||e.onClose())}}})},children:(0,Z.t)(r?"Add":"Add position to group")})]})]})},O=o(4990),T=o(4925),H=o(9656),N=o(1186),G=o(9294),L=o(7665),U=["onSelect","onSubmit","onClose","asReceiver"],$=function(e){var n=e.onSelect,o=(e.onSubmit,e.onClose),i=e.asReceiver,t=(0,T.Z)(e,U),r=(0,j.I6)().customers,l=(0,w.kw)(),a=(0,E.xc)()[E.EJ.customers],u=(0,h.useMemo)((function(){return{tableData:r,tableTitles:N.f,actionsCreator:function(e){return[{icon:"refresh",onClick:function(){return a.getAll()}},{separator:!0},{icon:"plus",onClick:function(){var e=l.open({ModalChildren:L.Z,modalChildrenProps:{onSubmit:function(n){a.create({data:(0,A.vg)(n),onSuccess:null===e||void 0===e?void 0:e.onClose})}}})}}]},onRowClick:function(e){null!==e&&void 0!==e&&e.rowData&&n&&(n(e.rowData),o&&o())}}}),[a,r,o,l,n]);return(0,h.useEffect)((function(){a.getAll({data:{refresh:!0,params:{}}})}),[]),(0,q.jsx)(H.Z,(0,d.Z)((0,d.Z)({fillWidth:!0,fillHeight:!0,title:(0,Z.t)(i?"Select receiver":"Select customer"),onClose:o},t),{},{children:(0,q.jsx)(G.ZP,(0,d.Z)({},u))}))},z=o(6074),J=o(7666),Q=["onSubmit","onSelect","onClose"],X=function(e){e.onSubmit;var n=e.onSelect,o=e.onClose,i=((0,T.Z)(e,Q),(0,j.O5)().users),t=(0,h.useMemo)((function(){return{tableData:i,onRowClick:function(e){var o=i.find((function(n){return n._id===(null===e||void 0===e?void 0:e._id)}));o&&n&&n(o)}}}),[n,i]);return(0,q.jsx)(H.Z,{fillWidth:!0,fillHeight:!0,onClose:o,title:(0,Z.t)("Select manager"),children:(0,q.jsx)(G.ZP,(0,d.Z)((0,d.Z)({tableTitles:J.NT},t),{},{isSearch:!1}))})},Y=o(1392),K=o(2911),ee=o(389),ne=o(6681),oe=o(1134),ie=function(e){var n=e.onSuccess,o=e.isReceiver,i=(0,E.xc)()[E.EJ.customers],t=(0,w.kw)();return(0,q.jsx)(C.Z,{variant:"onlyIcon",icon:"plus",iconSize:"100%",size:"30px",onClick:function(){var e=t.open({ModalChildren:L.Z,modalChildrenProps:{title:o?(0,Z.t)("Create receiver"):void 0,onSubmit:function(o){i.create({data:(0,A.vg)(o),onSuccess:function(o){n&&n(o),null===e||void 0===e||e.onClose()}})}}})}})},te=function(e){var n=e.info,o=e.isReceiver,i=e.isManager,t=(0,m.Fg)(),r=(0,h.useMemo)((function(){if(n)return function(e){var n=e.isManager;return[{label:(0,Z.t)("label"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.label)||void 0===n?void 0:n.base)||"---"},visible:!n},{label:(0,Z.t)("name"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.first)||"---"},visible:!0},{label:(0,Z.t)("Middle name"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.middle)||"---"},visible:!0},{label:(0,Z.t)("secondName"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.second)||"---"},visible:!0},{label:(0,Z.t)("email"),getValue:function(e){return(null===e||void 0===e?void 0:e.email)||"---"},visible:!0},{label:(0,Z.t)("taxCode"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.taxCode)||void 0===n?void 0:n.corp)||"---"},visible:!n},{label:(0,Z.t)("personalTaxCode"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.taxCode)||void 0===n?void 0:n.personal)||"---"},visible:!n},{label:(0,Z.t)("tags"),getValue:function(e){var n;return(null===e||void 0===e||null===(n=e.tags)||void 0===n?void 0:n.join(", "))||"---"},visible:!n}]}({info:n,isReceiver:o,isManager:i}).map((function(e){var o=e.label,i=e.getValue;return e.visible&&(0,q.jsxs)(p.ZP,{gap:2,padding:"4px",flex:"1 1 50%",maxWidth:"50%",border:"1px solid ".concat(t.modalBorderColor),children:[(0,q.jsx)(D.x,{$size:10,children:o}),(0,q.jsx)(D.x,{$align:"right",$size:12,$weight:600,children:i(n)})]},o)}))}),[n,i,o,t.modalBorderColor]);return(0,q.jsx)(p.ZP,{fillWidth:!0,flexWrap:"wrap",fxDirection:"row",border:"1px solid ".concat(t.modalBorderColor),children:r})};var re=[{name:"country",label:(0,Z.t)("Country"),required:!1},{name:"region",label:(0,Z.t)("Region"),required:!1},{name:"area",label:(0,Z.t)("Area"),required:!1},{name:"city",label:(0,Z.t)("City"),required:!1},{name:"street",label:(0,Z.t)("Street"),required:!1},{name:"house",label:(0,Z.t)("House"),required:!1},{name:"office",label:(0,Z.t)("Office"),required:!1},{name:"room",label:(0,Z.t)("Room"),required:!1}],le=o(763),ae=o.n(le),de=(ae().throttle((function(){for(var e,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];(e=console).log.apply(e,["Throttled Logger"].concat(o))}),5e3),ae().throttle((function(e){console.log(de.name),e()}),3e3)),ue=o(1604),ce=o(9297),se=o(8527),ve=o(4522);function fe(e,n){(0,ve.Z)(2,arguments);var o=(0,se.Z)(e),i=(0,ce.Z)(n);return isNaN(i)?new Date(NaN):i?(o.setDate(o.getDate()+i),o):o}var he,me,pe,xe,Ze,ge,be,je=o(4538),Ce=function(e){var n=e.title;return(0,q.jsx)(D.x,{$padding:"0 6px",$ellipsisMode:!0,$size:16,$weight:500,children:n})},Se=(0,m.ZP)(p.ZP)(he||(he=(0,a.Z)([""]))),ye=(0,m.ZP)(p.ZP)(me||(me=(0,a.Z)(["\n  padding-bottom: 8px;\n\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),we=(0,m.ZP)(I.Z)(pe||(pe=(0,a.Z)(["\n  & .content {\n    max-width: 480px;\n    width: 100%;\n    margin: auto;\n  }\n"]))),Pe=function(e){var n,o,i,t,r,l,a,s,v,f=e.onChangeValidStatus,m=(0,w.kw)(),x=(0,oe.Gc)(),g=x.formState,b=g.isValid,S=g.errors,y=x.register,P=x.setValue,I=x.unregister,D=x.watch,k=x.trigger,M=D(),A=(0,K.f)((0,j.ei)().methods,{withFullLabel:!0}),R=(0,K.f)((0,j.$N)().methods,{withFullLabel:!0}),E=(0,K.f)((0,j.A2)().methods,{withFullLabel:!0}),W=(0,h.useState)({hasDelivery:!!M.deliveryInfo,hasDeliveryInvoice:!(null===(n=M.deliveryInfo)||void 0===n||!n.invoiceInfo),hasReceiverInfo:!!M.receiver,hasExecuteDate:!(null===(o=M.shipmentInfo)||void 0===o||!o.executeAt)}),B=(0,u.Z)(W,2),F=B[0],_=B[1],V=function(e,n){try{P(e,n),de((function(){return k().then((function(e){e&&f&&f(e)})).catch((function(e){console.error("handleOnChangeValue trigger error",e)}))}))}catch(o){console.error("handleOnChangeValue: ",o)}},T=function(e){return function(n){if(_((function(o){return(0,d.Z)((0,d.Z)({},o),{},(0,c.Z)({},e,n))})),n){if("hasExecuteDate"===e)return P("shipmentInfo.executeAt",ue.Z(fe(new Date,1),"yyyy-MM-dd"));if("hasDeliveryInvoice"===e)return P("deliveryInfo.invoiceInfo.expiredAt",(0,je.w4)(fe(new Date,1)))}else if(!n){if("hasReceiverInfo"===e)return I("receiver");if("hasDeliveryInvoice"===e)return I("deliveryInfo.invoiceInfo");if("hasDelivery"===e)return I("deliveryInfo")}}},H=function(e){return{name:e,onChange:T(e),value:F[e]}};return(0,h.useEffect)((function(){f&&f(b)}),[b,f]),(0,h.useEffect)((function(){console.debug("CURRENT CONFIRMS",F)}),[F]),(0,q.jsxs)(Se,{flex:1,overflow:"auto",children:[(0,q.jsxs)(p.ZP,{fillWidth:!0,gap:8,padding:"8px 2px",style:{maxWidth:480,width:"100%",margin:"0 auto"},children:[(null===M||void 0===M?void 0:M.manager)&&(0,q.jsx)(O.Z,{label:(0,Z.t)("manager"),children:(0,q.jsx)(te,{info:null===M||void 0===M||null===(i=M.manager)||void 0===i?void 0:i.user,isManager:!0})}),(0,q.jsx)(C.Z,{variant:"outlinedSmall",onClick:function(){var e=m.open({ModalChildren:X,modalChildrenProps:{onSelect:function(n){V("manager",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,Z.t)(null!==M&&void 0!==M&&M.manager?"Change manager":"Select manager")})]}),(0,q.jsxs)(p.ZP,{padding:"0 2px",children:[(0,q.jsxs)(we,{contentContainerStyle:{padding:"8px 0",gap:8},open:!0,renderHeader:(0,q.jsx)(Ce,{title:(0,Z.t)("Customer")}),children:[(null===M||void 0===M?void 0:M.customer)&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(O.Z,{label:(0,Z.t)("Customer information"),children:(0,q.jsx)(te,{info:null===M||void 0===M?void 0:M.customer})}),(0,q.jsx)(ye,{fillWidth:!0,overflow:"hidden",children:(0,q.jsx)(O.Z,{label:(0,Z.t)("Communication methods"),children:(0,q.jsx)(z.Z,{multiple:!0,numColumns:2,values:null===M||void 0===M||null===(t=M.communication)||void 0===t?void 0:t.customer,resetButtonLabel:(0,Z.t)("Not needed"),options:R,resetButtonPosition:"start",onChange:function(e){V("communication.customer",e)}})})})]}),(0,q.jsxs)(p.ZP,{fxDirection:"row",gap:8,fillWidth:!0,alignItems:"center",children:[(0,q.jsx)(ie,{onSuccess:function(e){V("customer",e)}}),(0,q.jsx)(C.Z,{variant:"outlinedSmall",flex:1,onClick:function(){var e=m.open({ModalChildren:$,modalChildrenProps:{onSelect:function(n){V("customer",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,Z.t)(null!==M&&void 0!==M&&M.customer?"Change customer":"Select customer")})]}),(0,q.jsx)(ye,{fillWidth:!0,gap:4,children:(0,q.jsx)(O.Z,{label:(0,Z.t)("Receiver"),children:(0,q.jsx)(ee.Z,(0,d.Z)((0,d.Z)({},H("hasReceiverInfo")),{},{rejectLabel:(0,Z.t)("The same"),acceptLabel:(0,Z.t)("Another")}))})})]}),(null===F||void 0===F?void 0:F.hasReceiverInfo)&&(0,q.jsxs)(we,{contentContainerStyle:{padding:"8px 0",gap:8},open:!0,renderHeader:(0,q.jsx)(Ce,{title:(0,Z.t)("Receiver")}),children:[(null===M||void 0===M?void 0:M.receiver)&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(O.Z,{label:(0,Z.t)("Receiver information"),children:[(0,q.jsx)(te,{info:null===M||void 0===M?void 0:M.receiver})," "]}),(0,q.jsx)(ye,{fillWidth:!0,children:(0,q.jsx)(O.Z,{label:(0,Z.t)("Communication methods"),children:(0,q.jsx)(z.Z,{multiple:!0,numColumns:2,values:null===M||void 0===M||null===(r=M.communication)||void 0===r?void 0:r.receiver,resetButtonLabel:(0,Z.t)("Without"),options:R.map((function(e){return(0,d.Z)((0,d.Z)({},e),{},{value:e._id})})),resetButtonPosition:"start",onChange:function(e){V("communication.receiver",e)}})})})]}),(0,q.jsxs)(p.ZP,{fxDirection:"row",gap:8,fillWidth:!0,alignItems:"center",children:[(0,q.jsx)(ie,{isReceiver:!0,onSuccess:function(e){V("receiver",e)}}),(0,q.jsx)(C.Z,{variant:"outlinedSmall",flex:1,onClick:function(){var e=m.open({ModalChildren:$,modalChildrenProps:{onSelect:function(n){V("receiver",n),(null===e||void 0===e?void 0:e.onClose)&&(null===e||void 0===e||e.onClose())}}})},children:(0,Z.t)(null!==M&&void 0!==M&&M.receiver?"Change receiver":"Select receiver")})]})]}),(0,q.jsxs)(we,{contentContainerStyle:{padding:"8px 2px"},open:!0,renderHeader:(0,q.jsx)(Ce,{title:(0,Z.t)("Invoicing")}),children:[(0,q.jsx)(O.Z,{label:(0,Z.t)("Payment method"),required:!0,children:(0,q.jsx)(Y.Z,{options:E,currentOption:null===M||void 0===M||null===(l=M.invoiceInfo)||void 0===l?void 0:l.method,onChangeIndex:function(e){V("invoiceInfo.method",E[e])}})}),(0,q.jsx)(O.Z,{label:(0,Z.t)("Expired at"),required:!0,children:(0,q.jsx)(ne.ZP,(0,d.Z)({placeholder:(0,Z.t)("Expired at"),type:"datetime-local",required:!0},y("invoiceInfo.expiredAt",{required:!0})))})]}),(0,q.jsxs)(we,{contentContainerStyle:{padding:"0 2px"},open:!0,renderHeader:(0,q.jsx)(Ce,{title:(0,Z.t)("Shipment")}),children:[(0,q.jsxs)(ye,{fillWidth:!0,gap:4,children:[(0,q.jsx)(O.Z,{label:(0,Z.t)("Another execute date"),children:(0,q.jsx)(ee.Z,(0,d.Z)({},H("hasExecuteDate")))}),(null===F||void 0===F?void 0:F.hasExecuteDate)&&(0,q.jsx)(O.Z,{label:(0,Z.t)("Execute at"),required:null===F||void 0===F?void 0:F.hasExecuteDate,children:(0,q.jsx)(ne.ZP,(0,d.Z)({placeholder:(0,Z.t)("Execute at"),type:"date",required:null===F||void 0===F?void 0:F.hasExecuteDate},y("shipmentInfo.executeAt",{required:null===F||void 0===F?void 0:F.hasExecuteDate})))})]}),(0,q.jsx)(ye,{fillWidth:!0,gap:4,children:(0,q.jsx)(O.Z,{label:(0,Z.t)("Delivery"),children:(0,q.jsx)(ee.Z,(0,d.Z)({},H("hasDelivery")))})})]}),(null===F||void 0===F?void 0:F.hasDelivery)&&(0,q.jsxs)(we,{contentContainerStyle:{padding:"0 2px"},open:!0,renderHeader:(0,q.jsx)(Ce,{title:(0,Z.t)("Delivery")}),children:[(0,q.jsx)(ye,{fillWidth:!0,gap:8,children:(0,q.jsx)(O.Z,{label:(0,Z.t)("Delivery method"),required:!0,children:(0,q.jsx)(Y.Z,{options:A,currentOption:null===M||void 0===M||null===(a=M.deliveryInfo)||void 0===a?void 0:a.method,onChangeIndex:function(e){V("deliveryInfo.method",A[e])}})})}),(0,q.jsx)(ye,{fillWidth:!0,style:{columnGap:8,display:"grid",gridTemplateColumns:"1fr 1fr"},children:re.map((function(e){var n,o,i=e.name,t=e.label,r=e.required;return(0,q.jsx)(O.Z,{label:t,error:null!==S&&void 0!==S&&null!==(n=S.deliveryInfo)&&void 0!==n&&n.destination?null===S||void 0===S||null===(o=S.deliveryInfo)||void 0===o?void 0:o.destination[i]:void 0,required:r,children:(0,q.jsx)(ne.ZP,(0,d.Z)({required:r,placeholder:t},y("deliveryInfo.destination.".concat(i),{required:r})))},"dest-addr-".concat(t))}))}),(0,q.jsx)(ye,{fillWidth:!0,gap:8,children:(0,q.jsx)(O.Z,{label:(0,Z.t)("Has payment"),required:!0,children:(0,q.jsx)(ee.Z,(0,d.Z)({},H("hasDeliveryInvoice")))})}),(0,q.jsx)(ye,{fillWidth:!0,gap:8,children:(null===F||void 0===F?void 0:F.hasDeliveryInvoice)&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(O.Z,{label:(0,Z.t)("Payment method"),required:!0,children:(0,q.jsx)(Y.Z,{options:E,currentOption:null===M||void 0===M||null===(s=M.deliveryInfo)||void 0===s||null===(v=s.invoiceInfo)||void 0===v?void 0:v.method,onChangeIndex:function(e){V("deliveryInfo.invoiceInfo.method",E[e])}})}),(0,q.jsx)(O.Z,{label:(0,Z.t)("Expired at"),required:!0,children:(0,q.jsx)(ne.ZP,(0,d.Z)({placeholder:(0,Z.t)("Expired at"),type:"datetime-local",required:!0},y("deliveryInfo.invoiceInfo.expiredAt",{required:!0})))})]})})]})]})]})},Ie=o(4695),De=o(371),qe=o(2795),ke=function(e){return e.Stuffing="Stuffing",e.Info="Info",e}({}),Me=(0,s.H1)(ke),Ae=(xe={},(0,c.Z)(xe,ke.Stuffing,!0),(0,c.Z)(xe,ke.Info,!1),xe),Re=m.ZP.form(Ze||(Ze=(0,a.Z)(["\n  color: ",";\n\n  display: flex;\n  flex-direction: column;\n\n  width: 98vw;\n  height: 98vh;\n  padding: 0 8px;\n\n  background-color: ",";\n"])),(function(e){return e.theme.fontColorSidebar}),(function(e){return e.theme.modalBackgroundColor})),Ee=(0,m.ZP)(p.ZP)(ge||(ge=(0,a.Z)(["\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),We=(0,m.ZP)(p.ZP)(be||(be=(0,a.Z)([""]))),Be=function(e){var n,o,i,t,r=e.onClose,l=(0,E.xc)()[E.EJ.orders],a=(0,j.xA)().ordersGroupFormData,s=(0,f.dn)(Me),m=s.stepsMap,p=s.stepIdx,b=s.setNextStep,C=s.setPrevStep,y=s.getCurrentStep,w=s.isLast,P=(0,h.useState)(Ae),I=(0,u.Z)(P,2),D=I[0],k=I[1],M=function(e){return function(n){k((function(o){return(0,d.Z)((0,d.Z)({},o),{},(0,c.Z)({},ke[e],n))}))}},A=(0,oe.cI)({defaultValues:(0,d.Z)((0,d.Z)({},a.info),{},{invoiceInfo:(0,d.Z)((0,d.Z)({},null===(n=a.info)||void 0===n?void 0:n.invoiceInfo),{},{expiredAt:null!==(o=null===(i=a.info)||void 0===i||null===(t=i.invoiceInfo)||void 0===t?void 0:t.expiredAt)&&void 0!==o?o:(0,je.w4)(fe(new Date,1))})}),resolver:(0,Ie.X)(De.Lr),reValidateMode:"onSubmit"}),R=A.watch,W=A.handleSubmit,B=R(),F=(0,h.useMemo)((function(){return null!==m&&void 0!==m&&m.Stuffing?(0,q.jsx)(V,{onChangeValidStatus:M("Stuffing")}):null!==m&&void 0!==m&&m.Info?(0,q.jsx)(Pe,{onChangeValidStatus:M("Info"),isGroup:!0}):void 0}),[null===m||void 0===m?void 0:m.Info,null===m||void 0===m?void 0:m.Stuffing]),_=(0,h.useMemo)((function(){return D[y().value]}),[y,D]);return(0,q.jsx)(oe.RV,(0,d.Z)((0,d.Z)({},A),{},{children:(0,q.jsxs)(Re,{onSubmit:W((function(e){w?(0,qe.Eh)({data:{data:{info:(0,je.vg)(B,{omitPathArr:["deliveryInfo.destination"]}),slots:(0,je.Y_)(a.slots)}},onSuccess:function(e){console.log(e)},onError:function(e){console.log(e)},onLoading:function(e){}},qe.p6.createManyOrdersGroupedByWarehouse):S.kl.error("Form data is not valid")}),(function e(n){console.debug(e.name,n)})),children:[(0,q.jsx)(x.xB,{title:(0,Z.t)("Create orders group by warehouse"),onBackPress:r}),(0,q.jsxs)(Ee,{fillWidth:!0,flex:1,overflow:"hidden",children:[(0,q.jsx)(v.Z,{filterOptions:Me,asStepper:!0,currentIndex:p,optionProps:{fitContentH:!0}}),F]}),(0,q.jsx)(We,{padding:"8px",children:(0,q.jsx)(g.Z,{steps:Me,onNextPress:function(){"Info"===y().value&&l.updateCurrentGroupFormInfoData(ae().cloneDeep(B)),_?b():S.kl.error("".concat((0,Z.t)("Step is not finished"),': "').concat(y().value.toUpperCase(),'"'))},onPrevPress:function(){"Info"===y().value&&l.updateCurrentGroupFormInfoData(ae().cloneDeep(B)),C()},currentIndex:p,canGoNext:!0,canSubmit:w,submitButton:!0,onCancelPress:0===p?r:void 0})})]})}))};function Fe(e){console.debug("Transform Order Info For Req".toUpperCase()),console.log({input:e});var n={info:function e(n){var o={};for(var i in n)n[i]instanceof Object?o[i]=e(n[i]):"method"===i?(o.method=(0,je.rE)(n.method),o.expiredAt=n.expiredAt):o[i]=n[i];return o}(e)};return console.log({output:n}),n.info}},7606:function(e,n,o){var i,t,r,l=o(168),a=o(9439),d=o(2360),u=o(8095),c=o(8302),s=o(2791),v=o(4538),f=o(6522),h=o(4805),m=o(3329),p=(0,d.ZP)(u.ZP)(i||(i=(0,l.Z)(["\n  //min-height: 44px;\n  // border-top: 1px solid ",";\n  // border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.modalBorderColor}),(function(e){return e.theme.modalBorderColor})),x=(0,d.ZP)(c.Z)(t||(t=(0,l.Z)(["\n  flex: 1;\n  min-width: min-content;\n  height: 100%;\n"]))),Z=(0,d.ZP)(c.Z)(r||(r=(0,l.Z)(["\n  min-width: 34px;\n  height: 100%;\n  // color: ",";\n  // fill: ",";\n  // background-color: ",";\n  @media screen and (min-width: 480px) {\n    flex: 1;\n  }\n"])),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.light}));n.Z=function(e){var n=e.steps,o=e.currentIndex,i=void 0===o?0:o,t=e.onNextPress,r=e.onPrevPress,l=e.onCancelPress,d=e.onAcceptPress,u=e.canGoNext,c=void 0===u||u,g=e.canAccept,b=e.canSubmit,j=e.cancelButton,C=void 0===j||j,S=e.submitButton,y=void 0!==S&&S,w=e.acceptButton,P=e.arrowButtons,I=void 0===P||P,D=(0,h.useMediaQuery)({query:"(max-width: 768px)"}),q=(0,h.useMediaQuery)({query:"(max-width: 480px)"}),k=(0,s.useState)(i),M=(0,a.Z)(k,2),A=M[0],R=M[1],E=(0,s.useMemo)((function(){var e,o;return n&&n[A-1]?{label:null===(e=n[A-1])||void 0===e?void 0:e.label,value:null===(o=n[A-1])||void 0===o?void 0:o.value}:null}),[A,n]),W=(0,s.useMemo)((function(){var e,o;return n&&n[A+1]?{label:null===(e=n[A+1])||void 0===e?void 0:e.label,value:null===(o=n[A+1])||void 0===o?void 0:o.value}:null}),[A,n]),B=(0,s.useCallback)((function(){if(n)if(r){if(0===A)return void(l&&l());var e=A-1;r&&r({option:n[e],value:n[e].value,index:e})}else R((function(e){return 0===e?e:e-1}))}),[A,l,r,n]),F=(0,s.useCallback)((function(){if(n){if(t){var e=A+1;return e===n.length?d&&d():t({option:n[e],value:n[e].value,index:e})}R((function(e){return e+1===n.length?e+1:e}))}}),[A,d,t,n]);return(0,s.useEffect)((function(){v.sr.isNotUnd(i)&&R(i)}),[i]),(0,m.jsxs)(p,{fxDirection:"row",gap:8,fillWidth:!0,children:[C&&!D&&(0,m.jsx)(x,{variant:"defOutlinedSmall",onClick:l,children:(0,f.t)("Cancel")}),I&&(0,m.jsx)(Z,{variant:q?"onlyIconFilled":"filledSmall",icon:"SmallArrowLeft",onClick:B,disabled:!E,children:null===E||void 0===E?void 0:E.label}),I&&(0,m.jsx)(Z,{variant:q?"onlyIconFilled":"filledSmall",endIcon:"SmallArrowRight",onClick:F,disabled:!c||!W,children:null===W||void 0===W?void 0:W.label}),(y||w)&&(0,m.jsx)(x,{variant:"filledSmall",type:b&&y?"submit":"button",onClick:d,disabled:b&&y?!b:!g,children:(0,f.t)("Accept")})]})}},7665:function(e,n,o){o.d(n,{Z:function(){return R}});var i,t=o(168),r=o(1413),l=o(4925),a=function(e){return e.facebook="facebook",e.instagram="instagram",e.referralSystem="referralSystem",e.another="another",e}({}),d=o(9656),u=o(6522),c=o(2360),s=o(8095),v=o(4990),f=o(6681),h=o(9964),m=o(457),p=o(1134),x=o(8302),Z=o(1392),g=o(8553),b=o(2791),j=o(1383),C=o(5611),S=o(763),y=o.n(S),w=o(3329),P=["defaultState","withReferer","onSubmit"],I=["register","setValue","handleSubmit","watch"],D=j.E4.isDevMode(),q=(0,g.H1)(a),k=(0,c.ZP)(s.ZP)(i||(i=(0,t.Z)([""]))),M=function(e){var n=e.form,o=[{name:"first",label:(0,u.t)("First name"),required:!0},{name:"second",label:(0,u.t)("Second name")},{name:"middle",label:(0,u.t)("Middle name")}];return(0,w.jsx)(w.Fragment,{children:o.map((function(e){var o=e.name,i=e.label,t=e.required;return(0,w.jsx)(v.Z,{label:i,required:t,children:(0,w.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:i},n.register("name.".concat(o),{required:t})),{},{required:t}))},"name_".concat(o))}))})},A=function(e){var n=e.form,o=[{name:"base",label:(0,u.t)("Label"),required:!0},{name:"print",label:(0,u.t)("Print label")}];return(0,w.jsx)(w.Fragment,{children:o.map((function(e){var o=e.name,i=e.label,t=e.required;return(0,w.jsx)(v.Z,{label:i,required:t,children:(0,w.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:i},n.register("label.".concat(o),{required:t})),{},{required:t}))},"name_".concat(o))}))})},R=function(e){var n=e.defaultState,o=e.withReferer,i=e.onSubmit,t=(0,l.Z)(e,P),c=(0,p.cI)({defaultValues:(0,r.Z)((0,r.Z)({},n),{},{businessType:C.G.company})}),g=c.register,j=c.setValue,S=c.handleSubmit,R=c.watch,E=(0,l.Z)(c,I),W=R(),B=(0,b.useMemo)((function(){return!(null===n||void 0===n||!n.email)}),[null===n||void 0===n?void 0:n.email]);return(0,w.jsx)(d.Z,(0,r.Z)((0,r.Z)({fillHeight:!0},t),{},{title:t.title?t.title:(0,u.t)("Create customer"),onSubmit:S((function(e){i&&i(y().omit(e,B?["engagementSource","email"]:["engagementSource"]))})),children:(0,w.jsxs)(k,{padding:"0 8px 8px",children:[(0,w.jsx)(v.Z,{label:(0,u.t)("type"),required:!0,children:(0,w.jsx)(h.Z,{options:m.Wk,onSelect:function(e){j("businessType",null===e||void 0===e?void 0:e.value)}})}),W.businessType!==C.G.person&&(0,w.jsx)(A,{form:(0,r.Z)({register:g,setValue:j,handleSubmit:S,watch:R},E)}),W.businessType!==C.G.company&&(0,w.jsx)(M,{form:(0,r.Z)({register:g,setValue:j,handleSubmit:S,watch:R},E)}),(0,w.jsx)(v.Z,{label:(0,u.t)("email"),disabled:B,required:!0,children:(0,w.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:(0,u.t)("email"),type:"email"},g("email",{required:!0})),{},{disabled:B,required:!0}))}),(0,w.jsx)(v.Z,{label:(0,u.t)("phone"),children:(0,w.jsx)(f.ZP,(0,r.Z)({placeholder:(0,u.t)("phone")},g("phone")))}),W.businessType!==C.G.company&&(0,w.jsx)(v.Z,{label:(0,u.t)("Birth date"),children:(0,w.jsx)(f.ZP,(0,r.Z)((0,r.Z)({placeholder:(0,u.t)("Birth date")},g("birthDate")),{},{type:"datetime-local"}))}),o&&D&&(0,w.jsx)(v.Z,{label:(0,u.t)("Referrer id"),children:(0,w.jsx)(f.ZP,(0,r.Z)({placeholder:(0,u.t)("Referrer id")},g("referrer._id")))}),(0,w.jsx)(v.Z,{label:(0,u.t)("Source"),children:(0,w.jsx)(Z.Z,{disabled:!0,options:q,currentOption:{value:null===W||void 0===W?void 0:W.engagementSource},onChangeIndex:function(e){j("engagementSource",q[e].value)}})}),(null===W||void 0===W?void 0:W.engagementSource)===a.referralSystem&&(0,w.jsxs)(s.ZP,{gap:8,fillWidth:!0,children:[(0,w.jsx)(v.Z,{label:(0,u.t)("Referrer"),required:!0,children:(0,w.jsx)(f.ZP,{placeholder:(0,u.t)("Referrer"),type:"email",required:!0})}),(0,w.jsxs)(s.ZP,{fxDirection:"row",fillWidth:!0,gap:8,padding:"8px 0",children:[(0,w.jsx)(x.Z,{variant:"defOutlinedSmall",children:(0,u.t)("Clear referrer")}),(0,w.jsx)(x.Z,{variant:"outlinedSmall",flex:1,children:(0,u.t)("Select referrer")})]})]})]})}))}},1392:function(e,n,o){var i=o(3433),t=o(9439),r=o(2791),l=o(4538),a=o(8095),d=o(3855),u=o(6492),c=o(3329);n.Z=function(e){var n=e.options,o=e.onChangeIndex,s=e.currentIndex,v=e.currentOption,f=e.multiple,h=e.onChange,m=e.value,p=e.disabled,x=e.disabledCheck,Z=(0,r.useState)(0),g=(0,t.Z)(Z,2),b=g[0],j=g[1],C=(0,r.useState)([]),S=(0,t.Z)(C,2),y=S[0],w=S[1];return(0,r.useEffect)((function(){l.sr.isUnd(s)||j(s)}),[s]),(0,r.useEffect)((function(){f||l.sr.isUnd(v)||l.sr.isUnd(n)||j(n.findIndex((function(e){return(null===e||void 0===e?void 0:e.value)===(null===v||void 0===v?void 0:v.value)||(null===e||void 0===e?void 0:e._id)===(null===v||void 0===v?void 0:v._id)})))}),[v,f,n]),(0,r.useEffect)((function(){f&&!l.sr.isUnd(m)&&l.sr.isArray(m)&&w(m)}),[f,m]),(0,c.jsx)(a.ZP,{fillWidth:!0,gap:8,children:null===n||void 0===n?void 0:n.map((function(e,n){var t=x?x(e,n):p;return(0,c.jsxs)(a.ZP,{fxDirection:"row",gap:8,padding:"2px 4px",alignItems:"center",style:{opacity:t?.7:1,pointerEvents:t?"none":"all"},onClick:function(){var r;t||(!function(e){j(e),o&&o(e)}(n),(null===e||void 0===e?void 0:e._id)&&(r=null===e||void 0===e?void 0:e._id,f?w((function(e){var n=y.includes(r)?e.filter((function(e){return e!==r})):[].concat((0,i.Z)(e),[r]);return h&&h(n),n})):(w([r]),h&&h([r]))))},children:[(0,c.jsx)(d.Z,{checked:(null===e||void 0===e?void 0:e._id)&&y.includes(null===e||void 0===e?void 0:e._id)||n===b,size:"22px",disabled:t}),(0,c.jsx)(u.x,{children:null===e||void 0===e?void 0:e.label})]},"m-opt_".concat(e.value))}))})}},1186:function(e,n,o){o.d(n,{f:function(){return t}});var i=o(6522),t=[{top:{name:"".concat((0,i.t)("label"),"/").concat((0,i.t)("name")),getData:function(e){var n,o=null!==(n=e.label)&&void 0!==n?n:e.name;return o?Object.values(o).map((function(e){return null!==e&&void 0!==e?e:""})).join(" "):"---"}},bottom:{name:"\u0406\u041f\u041d/\u0404\u0414\u0420\u041f\u041e\u0423",getData:function(e){var n,o;return((null===(n=e.taxCode)||void 0===n?void 0:n.personal)||"---")+"/"+((null===(o=e.taxCode)||void 0===o?void 0:o.corp)||"---")}},width:"240px",action:"doubleDataWithAvatar"},{top:{name:"\u0422\u0438\u043f",getData:function(e){return null===e||void 0===e?void 0:e.type}},bottom:{name:"\u0421\u0442\u0430\u0442\u0443\u0441",path:"status"},width:"120px",action:"valueByPath"},{top:{name:"\u0415\u043c\u0435\u0439\u043b",path:"email",uppercase:!1},bottom:{name:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",path:"phone"},width:"170px",action:"contacts"},{top:{name:"\u041b\u043e\u043a\u0430\u0446\u0456\u044f"},width:"170px",action:"valueByPath"},{top:{name:"\u0422\u0435\u0433\u0438",path:"tags"},width:"200px",action:"tags"},{top:{name:"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440",path:"description"},width:"170px",action:"valueByPath"},{top:{name:"\u0421\u0442\u0432\u043e\u0440\u0435\u043d\u043e",align:"center",path:"createdAt"},bottom:{name:"\u041e\u043d\u043e\u0432\u043b\u0435\u043d\u043e",align:"center",path:"updatedAt"},width:"150px",action:"dateSimple"}]}}]);
//# sourceMappingURL=265.2acf5ecc.chunk.js.map