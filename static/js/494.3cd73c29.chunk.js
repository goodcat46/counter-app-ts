"use strict";(self.webpackChunkcounter_app_ts=self.webpackChunkcounter_app_ts||[]).push([[494],{9701:function(e,n,i){i.d(n,{B:function(){return j}});var o=i(1413),t=i(4925),l=i(8768),d=i(4716),r=i(4990),a=i(6522),u=i(6681),s=i(8095),c=(i(2791),i(6785)),f=i(870),v=i(4343),p=i(7653),m=i(2913),h=i(1494),b=i(4436),Z=i(7348),x=i(3329),g=["formState","register","registerSelect","formValues"],j=function(e){var n=e.defaultValues,i=e.edit,j=e.type,S=e.onSuccess,_=e._id,y=(0,h.useOfferLoadersProvider)(),L=y.isLoading,P=y.onLoading,C=(0,m.Z)(),I=(0,Z.q$)(f.cA.BRANDS).directory,B=(0,d.hN)({defaultValues:(0,o.Z)((0,o.Z)({},n),{},{type:j})}),V=B.formState.errors,k=B.register,w=B.registerSelect,O=(B.formValues,(0,t.Z)(B,g));return(0,x.jsxs)(l.h,{label:(0,a.t)("Base info"),isLoading:i?null===L||void 0===L?void 0:L.offer_update:null===L||void 0===L?void 0:L.offer_create,onSubmit:O.handleSubmit((function(e){var n=(0,p.vg)(e,{ignorePaths:["measurement"]});i?C.updateById({data:{data:n,_id:_},onSuccess:S,onLoading:P("offer_update")}):C.create({data:{data:n},onSuccess:S,onLoading:P("offer_create")})})),onReset:O.reset,children:[(0,x.jsx)(r.Z,{label:(0,a.t)("label"),error:V.label,required:!0,children:(0,x.jsx)(u.ZP,(0,o.Z)((0,o.Z)({placeholder:(0,a.t)("label")},k("label")),{},{required:!0,autoFocus:!0}))}),(0,x.jsxs)(s.ZP,{fxDirection:"row",gap:6,fillWidth:!0,children:[(0,x.jsx)(r.Z,{label:(0,a.t)("sku"),error:V.sku,children:(0,x.jsx)(u.ZP,(0,o.Z)({placeholder:(0,a.t)("sku")},k("sku")))}),(0,x.jsx)(r.Z,{label:"\u0428\u0442\u0440\u0438\u0445-\u043a\u043e\u0434",error:V.barCode,children:(0,x.jsx)(u.ZP,(0,o.Z)({placeholder:"\u0428\u0442\u0440\u0438\u0445-\u043a\u043e\u0434"},k("barCode")))})]}),(0,x.jsx)(c.Z,(0,o.Z)({},w("brand",{options:I,label:(0,a.t)("brand"),placeholder:(0,a.t)("selectBrand")}))),(0,x.jsx)(c.Z,(0,o.Z)({},w("approved",{options:b.SQ,label:(0,a.t)("status"),placeholder:(0,a.t)("status")}))),(0,x.jsx)(r.Z,{label:(0,a.t)("description"),error:V.description,children:(0,x.jsx)(v.Z,(0,o.Z)({placeholder:(0,a.t)("description")},k("description")))})]})}},6600:function(e,n,i){i.d(n,{A:function(){return _}});var o,t=i(1413),l=i(9439),d=i(4925),r=i(168),a=i(6522),u=i(2791),s=i(8095),c=i(4990),f=i(6681),v=i(2360),p=i(3329),m=[{name:"height",label:(0,a.t)("Height"),placeholder:(0,a.t)("Sm")},{name:"width",label:(0,a.t)("Width"),placeholder:(0,a.t)("Sm")},{name:"length",label:(0,a.t)("Length"),placeholder:(0,a.t)("Sm")},{name:"weight",label:(0,a.t)("Weight"),placeholder:(0,a.t)("Kg")}],h=(0,v.ZP)(s.ZP)(o||(o=(0,r.Z)(["\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  column-gap: 8px;\n\n  @media screen and (min-width: 480px) {\n    grid-template-columns: repeat(4, 1fr);\n  }\n"]))),b=function(e){var n,i,o=e.form,l=e.disabled,d=null===o||void 0===o||null===(n=o.formState)||void 0===n||null===(i=n.errors)||void 0===i?void 0:i.dimensions;return(0,p.jsx)(h,{fillWidth:!0,children:m.map((function(e){return(0,p.jsx)(c.Z,{label:e.label,error:d&&d[e.name],children:(0,p.jsx)(f.ZP,(0,t.Z)((0,t.Z)({placeholder:e.placeholder,min:1,type:"number"},o.register("dimensions.".concat(e.name),{valueAsNumber:!0,min:1})),{},{disabled:l}))},e.name)}))})},Z=i(4716),x=i(8768),g=i(2913),j=i(1383),S=["defaultValues","_id","disabled"],_=function(e){var n,i,o,r=e.defaultValues,s=e._id,c=e.disabled,f=(0,d.Z)(e,S),v=(0,g.Z)(),m=(0,u.useState)(!1),h=(0,l.Z)(m,2),_=h[0],y=h[1],L=(0,Z.hN)({defaultValues:{dimensions:null!==r&&void 0!==r?r:{}}}),P=!(null===(n=L.formState.touchedFields)||void 0===n||!n.dimensions)&&(null===(i=Object.values(null===(o=L.formState.touchedFields)||void 0===o?void 0:o.dimensions))||void 0===i?void 0:i.some((function(e){return e})));return(0,p.jsx)(x.h,(0,t.Z)((0,t.Z)({onSubmit:L.handleSubmit((function(e){v.updateById({data:{data:e,_id:s},onSuccess:function(e){j.kl.success("Product updated")},onError:function(e){console.error("Product update action",e)},onLoading:y})})),label:(0,a.t)("Package size"),isLoading:_},f),{},{disabled:!P||c,children:(0,p.jsx)(b,{form:L,disabled:c})}))}},3023:function(e,n,i){i.d(n,{A:function(){return y}});var o,t,l,d,r=i(168),a=i(3433),u=i(4942),s=i(1413),c=i(9439),f=i(2791),v=i(6492),p=i(8768),m=i(2360),h=i(8095),b=i(7348),Z=i(1819),x=i(1494),g=i(6522),j=i(870),S=i(3855),_=i(3329),y=function(e){var n,i=e.onSubmit,o=e.onSuccess,t=e.disabled,l=e.offer,d=e.defaultValues,r=(0,x.useOfferLoadersProvider)(),m=(0,b.q$)(j.cA.CATEGORIES_PROD).directory,y=(0,f.useState)({}),I=(0,c.Z)(y,2),V=I[0],k=I[1],w=(0,Z.xc)()[Z.EJ.offers],O=(0,f.useMemo)((function(){return Object.keys(V).filter((function(e){var n;return null===V||void 0===V||null===(n=V[e])||void 0===n?void 0:n.selected}))}),[V]),D=(0,f.useCallback)((function(e,n){if(null!==n&&void 0!==n&&n.length){var i,o=(0,s.Z)((0,s.Z)({},V),{},(0,u.Z)({},e,{selected:!0,parentIds:(null===V||void 0===V||null===(i=V[e])||void 0===i?void 0:i.parentIds)||n}));null===n||void 0===n||n.forEach((function(e){null!==o&&void 0!==o&&o[e]?o[e]=(0,s.Z)((0,s.Z)({},o[e]),{},{selected:!0}):o[e]={parentIds:[],selected:!0}})),k(o)}else k((function(i){return(0,s.Z)((0,s.Z)({},i),{},(0,u.Z)({},e,{selected:!0,parentIds:null!==n&&void 0!==n?n:[]}))}))}),[V]),A=(0,f.useCallback)((function(e){var n=O.filter((function(n){var i,o;return null===V||void 0===V||null===(i=V[n])||void 0===i||null===(o=i.parentIds)||void 0===o?void 0:o.includes(e)}));if(null!==n&&void 0!==n&&n.length){var i,o=(0,s.Z)((0,s.Z)({},V),{},(0,u.Z)({},e,{selected:!1,parentIds:null===V||void 0===V||null===(i=V[e])||void 0===i?void 0:i.parentIds}));n.forEach((function(e){o[e]=(0,s.Z)((0,s.Z)({},o[e]),{},{selected:!1})})),k(o)}else k((function(n){var i;return(0,s.Z)((0,s.Z)({},n),{},(0,u.Z)({},e,{selected:!1,parentIds:null===n||void 0===n||null===(i=n[e])||void 0===i?void 0:i.parentIds}))}))}),[V,O]),E=(0,f.useMemo)((function(){var e,n;return!t&&(null!==l&&void 0!==l&&null!==(e=l.categories)&&void 0!==e&&e.length?(null===l||void 0===l||null===(n=l.categories)||void 0===n?void 0:n.map((function(e){return e._id})).sort((function(e,n){return e.localeCompare(n)})).join(","))!==O.sort((function(e,n){return e.localeCompare(n)})).join(","):!!O.length)}),[null===l||void 0===l?void 0:l.categories,t,O]);(0,f.useEffect)((function(){null!==d&&void 0!==d&&d.length&&k((function(e){return Object.assign.apply(Object,[e].concat((0,a.Z)(d.map((function(e){return(0,u.Z)({},e,{parentIds:[],selected:!0})})))))}))}),[]);var W=(0,f.useMemo)((function(){return m.map((function(e){var n,i,o=function(e,n){var i;return n&&O.some((function(n){var i,o,t;return(null===V||void 0===V||null===(i=V[n])||void 0===i||null===(o=i.parentIds)||void 0===o?void 0:o.includes(e))&&(null===V||void 0===V||null===(t=V[n])||void 0===t?void 0:t.selected)}))||(null===V||void 0===V||null===(i=V[e])||void 0===i?void 0:i.selected)};return(0,_.jsxs)(P,{gap:8,fillWidth:!0,padding:"8px 0 0",children:[(0,_.jsxs)(h.ZP,{fxDirection:"row",justifyContent:"space-between",alignItems:"center",gap:12,children:[(0,_.jsx)(S.Z,{checked:o(e._id,!(null===e||void 0===e||null===(n=e.childrenList)||void 0===n||!n.length)),onChange:function(n){n.checked?D(e._id):A(e._id)}}),(0,_.jsx)(v.x,{style:{flex:1,paddingLeft:12},$weight:500,children:e.label})]}),(0,_.jsx)(C,{fillWidth:!0,padding:"8px 0",children:null===e||void 0===e||null===(i=e.childrenList)||void 0===i?void 0:i.map((function(n){return(0,_.jsx)(B,{item:n,parentIds:[e._id],getIsSelected:o,onChange:function(e,n,i){e?D(n,null!==i&&void 0!==i?i:[]):A(n)}},n._id)}))})]},"property-".concat(e._id))}))}),[A,D,m,V,O]);return(0,_.jsx)(p.h,{label:(0,g.t)("Categories"),onSubmit:function(e){e.preventDefault(),i?i(O):l&&w.updateById({data:{_id:null===l||void 0===l?void 0:l._id,updateCurrent:!0,data:{categories:O}},onLoading:r.onLoading("properties"),onSuccess:o})},onReset:function(){k({})},isLoading:null===(n=r.isLoading)||void 0===n?void 0:n.properties,disabled:!E,children:(0,_.jsx)(L,{flex:1,overflow:"auto",children:W})})},L=(0,m.ZP)(h.j6)(o||(o=(0,r.Z)(["\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n  padding-bottom: 8px;\n"])),(function(e){return e.theme.sideBarBorderColor}),(function(e){return e.theme.sideBarBorderColor})),P=(0,m.ZP)(h.Ov)(t||(t=(0,r.Z)(["\n  &:not(:first-child) {\n    border-top: 1px solid ",";\n  }\n"])),(function(e){return e.theme.sideBarBorderColor})),C=(0,m.ZP)(h.j6)(l||(l=(0,r.Z)([""]))),I=(0,m.ZP)(h.Ov)(d||(d=(0,r.Z)([""]))),B=function e(n){var i,o,t=n.item,l=n.onChange,d=n.getIsSelected,r=n.parentIds,u=d&&d(t._id,!(null===t||void 0===t||null===(i=t.childrenList)||void 0===i||!i.length));return(0,_.jsxs)(I,{padding:"0 8px 0px 12px",gap:12,children:[(0,_.jsxs)(h.ZP,{fxDirection:"row",alignItems:"center",gap:12,children:[(0,_.jsx)(S.Z,{checked:u,onChange:function(e){l&&l(e.checked,t._id,r)}}),(0,_.jsx)(v.x,{$size:14,$weight:500,children:t.label})]}),(0,_.jsx)(C,{children:!(null===(o=t.childrenList)||void 0===o||!o.length)&&t.childrenList.map((function(n){return(0,_.jsx)(e,{item:n,onChange:l,getIsSelected:d,parentIds:[].concat((0,a.Z)(null!==r&&void 0!==r?r:[]),[t._id])},n._id)}))})]},"cate-value-".concat(t._id))}},2353:function(e,n,i){i.d(n,{A:function(){return v}});var o=i(1413),t=i(9439),l=i(1494),d=i(1819),r=i(2791),a=i(8768),u=i(8790),s=i(7653),c=i(6522),f=i(3329),v=function(e){var n,i,v=e.offer,p=e.onSubmit,m=e.onSuccess,h=e.disabled,b=e.defaultValues,Z=(0,l.useOfferLoadersProvider)(),x=(0,r.useState)(b||(null===Z||void 0===Z||null===(n=Z.state)||void 0===n?void 0:n.images)||[]),g=(0,t.Z)(x,2),j=g[0],S=g[1],_=(0,d.xc)()[d.EJ.offers],y=(0,r.useMemo)((function(){return!0}),[]);return(0,f.jsx)(a.h,{label:(0,c.t)("Images"),onSubmit:function(e){e.preventDefault(),p?p(j):v?_.updateById({data:(0,o.Z)((0,o.Z)({},(0,s.rE)(v)),{},{data:{images:j},refreshCurrent:!0}),onSuccess:m,onLoading:Z.onLoading("images")}):console.warn("Offer not passed")},disabled:h||!y,isLoading:null===(i=Z.isLoading)||void 0===i?void 0:i.images,children:(0,f.jsx)(u.Z,{hideLabel:!0,initialData:j,onChangeState:S,contentContainerStyle:{flex:1}})})}},7109:function(e,n,i){i.d(n,{R:function(){return S}});var o,t,l,d,r=i(168),a=i(3433),u=i(9439),s=i(2791),c=i(6492),f=i(8768),v=i(2360),p=i(8095),m=i(4109),h=i(7348),b=i(1819),Z=i(6785),x=i(1494),g=i(6522),j=i(3329),S=function(e){var n,i,o=e.onSubmit,t=e.onSuccess,l=e.disabled,d=e.offer,r=(0,x.useOfferLoadersProvider)(),v=(0,h.WS)(),p=(0,b.xc)()[b.EJ.offers],m=(0,s.useState)([]),S=(0,u.Z)(m,2),C=S[0],I=S[1],B=(0,s.useState)(null===(n=v[0])||void 0===n?void 0:n._id),V=(0,u.Z)(B,2),k=V[0],w=V[1],O=(0,s.useMemo)((function(){return v.find((function(e){return e._id===k}))}),[k,v]),D=(0,s.useMemo)((function(){var e,n;return!l&&(null!==d&&void 0!==d&&null!==(e=d.properties)&&void 0!==e&&e.length?(null===d||void 0===d||null===(n=d.properties)||void 0===n?void 0:n.map((function(e){return e._id})).sort((function(e,n){return e.localeCompare(n)})).join(","))!==C.sort((function(e,n){return e.localeCompare(n)})).join(","):!!C.length)}),[null===d||void 0===d?void 0:d.properties,l,C]),A=(0,s.useCallback)((function(e,n){I((function(n){return n.includes(e)?n.filter((function(n){return n!==e})):[].concat((0,a.Z)(n),[e])}))}),[]),E=(0,s.useMemo)((function(){var e;return null===O||void 0===O||null===(e=O.childrenList)||void 0===e?void 0:e.filter((function(e){return!(null!==e&&void 0!==e&&e.isSelectable)})).map((function(e){var n;return(0,j.jsxs)(y,{gap:8,fillWidth:!0,padding:"8px 0 0",children:[(0,j.jsx)(c.x,{style:{flex:1,paddingLeft:12},$weight:500,children:e.label}),(0,j.jsx)(L,{fillWidth:!0,padding:"8px 0",gap:6,flexWrap:"wrap",fxDirection:"row",children:null===(n=e.childrenList)||void 0===n?void 0:n.map((function(n){var i=C.includes(n._id);return(0,j.jsx)(P,{variant:i?"filledSmall":"outlinedSmall",padding:"6px 8px",fontWeight:500,onClick:function(){return A(n._id,e._id)},children:n.label},"prop-value-".concat(n._id))}))})]},"property-".concat(e._id))}))}),[A,C,null===O||void 0===O?void 0:O.childrenList]);return(0,s.useEffect)((function(){null!==d&&void 0!==d&&d.properties&&I(null===d||void 0===d?void 0:d.properties.map((function(e){return e._id})))}),[null===d||void 0===d?void 0:d.properties]),(0,j.jsxs)(f.h,{label:(0,g.t)("Properties"),onSubmit:function(e){e.preventDefault(),o?o(C):d&&p.updateById({data:{_id:null===d||void 0===d?void 0:d._id,updateCurrent:!0,data:{properties:C}},onLoading:r.onLoading("properties"),onSuccess:t})},isLoading:null===(i=r.isLoading)||void 0===i?void 0:i.properties,disabled:!D,children:[(0,j.jsx)(Z.Z,{label:(0,g.t)("Available templates"),options:v,selectedValue:k,onSelect:function(e){w(null===e||void 0===e?void 0:e._id)}}),(0,j.jsx)(_,{flex:1,overflow:"auto",children:E})]})},_=(0,v.ZP)(p.ZP)(o||(o=(0,r.Z)(["\n  border-top: 1px solid ",";\n  border-bottom: 1px solid ",";\n  padding-bottom: 8px;\n"])),(function(e){return e.theme.sideBarBorderColor}),(function(e){return e.theme.sideBarBorderColor})),y=(0,v.ZP)(p.ZP)(t||(t=(0,r.Z)(["\n  &:not(:first-child) {\n    border-top: 1px solid ",";\n  }\n"])),(function(e){return e.theme.sideBarBorderColor})),L=(0,v.ZP)(p.ZP)(l||(l=(0,r.Z)([""]))),P=(0,v.ZP)(m.Z)(d||(d=(0,r.Z)(["\n  flex-basis: 100px;\n  min-width: max-content;\n"])))},4826:function(e,n,i){i.d(n,{n:function(){return _}});var o=i(1413),t=i(9439),l=i(4925),d=i(3691),r=i(8553),a=i(6785),u=i(4990),s=i(6681),c=i(8095),f=i(2791),v=i(6522),p=i(3329),m=(0,r.H1)(d.qU),h=[{name:"measurement.unit",label:(0,v.t)("unit"),placeholder:(0,v.t)("unit"),options:m},{name:"measurement.min",label:(0,v.t)("min"),placeholder:(0,v.t)("min"),type:"number"},{name:"measurement.max",label:(0,v.t)("max"),placeholder:(0,v.t)("max"),type:"number"}],b=function(e){var n=e.appForm,i=e.disabled;return(0,p.jsx)(c.ZP,{fillWidth:!0,style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",columnGap:8},children:h.map((function(e){var t;return e.options?(0,p.jsx)(a.Z,(0,o.Z)((0,o.Z)({},n.registerSelect(null===e||void 0===e?void 0:e.name,{options:null===e||void 0===e?void 0:e.options,label:null===e||void 0===e?void 0:e.label,placeholder:null===e||void 0===e?void 0:e.label,dropDownIsAbsolute:!0,onlyValue:!0})),{},{disabled:i}),e.name):(0,p.jsx)(u.Z,{label:e.label,error:null===n||void 0===n||null===(t=n.formState)||void 0===t?void 0:t.errors[e.name],children:(0,p.jsx)(s.ZP,(0,o.Z)((0,o.Z)({placeholder:e.placeholder,min:"number"===(null===e||void 0===e?void 0:e.type)?1:void 0,type:null===e||void 0===e?void 0:e.type},n.register(e.name,{valueAsNumber:"number"===(null===e||void 0===e?void 0:e.type),min:"number"===(null===e||void 0===e?void 0:e.type)?1:void 0})),{},{disabled:i}))},e.name)}))})},Z=i(4716),x=i(8768),g=i(2913),j=i(1383),S=["defaultValues","_id","disabled"],_=function(e){var n,i,d,r=e.defaultValues,a=e._id,u=e.disabled,s=(0,l.Z)(e,S),c=(0,g.Z)(),m=(0,f.useState)(!1),h=(0,t.Z)(m,2),_=h[0],y=h[1],L=(0,Z.hN)({defaultValues:{measurement:r}}),P=!(null===(n=L.formState.touchedFields)||void 0===n||!n.measurement)&&(null===(i=Object.values(null===(d=L.formState.touchedFields)||void 0===d?void 0:d.measurement))||void 0===i?void 0:i.some((function(e){return e})));return(0,p.jsx)(x.h,(0,o.Z)((0,o.Z)({onSubmit:L.handleSubmit((function(e){c.updateById({data:{data:e,_id:a},onSuccess:function(e){j.kl.success("Product updated")},onError:function(e){console.error("Product update action",e)},onLoading:y})})),label:(0,v.t)("Measurement info"),isLoading:_,disabled:!P||u},s),{},{children:(0,p.jsx)(b,{appForm:L,disabled:u})}))}},1494:function(e,n,i){i.r(n),i.d(n,{useOfferLoadersProvider:function(){return S}});var o=i(1413),t=i(6600),l=i(8050),d=i(6522),r=i(7653),a=i(2791),u=i(3691),s=i(4826),c=i(9701),f=i(8095),v=i(9953),p=i(3383),m=i(7109),h=i(9541),b=i(7578),Z=i(2353),x=i(4716),g=i(3023),j=i(3329),S=function(){return(0,b.un)()};n.default=function(e){var n,i,S=e.onClose,_=(e._id,(0,h.J)()),y=_.state.formData,L=_.setData,P=(0,x.xj)(),C=(0,x.G2)({id:null===(n=P.query)||void 0===n?void 0:n.offerId});return(0,a.useEffect)((function(){return P.push({query:{}}),function(){P.push({query:{}})}}),[]),(0,j.jsx)(l.Z,{title:(0,d.t)("Create offer"),onClose:S,extraHeader:(0,j.jsx)(v.Z,{defaultValue:null!==(i=null===y||void 0===y?void 0:y.type)&&void 0!==i?i:u.iv.GOODS,filterOptions:p.jI,onOptSelect:function(e){return L("formData",(function(n){return(0,o.Z)((0,o.Z)({},n),{},{type:e.value})}))}}),children:(0,j.jsx)(b.f4,{value:_,children:(0,j.jsxs)(f.ZP,{padding:"0 8px 16px",children:[(0,j.jsx)(c.B,{defaultValues:y,onSuccess:function(e){L("formData",(0,r.xT)(e)),P.push({query:{offerId:null===e||void 0===e?void 0:e._id}})},type:null===y||void 0===y?void 0:y.type}),C&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(g.A,{offer:C,defaultValues:null===y||void 0===y?void 0:y.categories,disabled:!y}),(0,j.jsx)(m.R,{offer:C,defaultValues:null===y||void 0===y?void 0:y.properties,disabled:!y}),(0,j.jsx)(t.A,{offer:C,defaultValues:null===y||void 0===y?void 0:y.dimensions,disabled:!y}),(0,j.jsx)(s.n,{offer:C,defaultValues:null===y||void 0===y?void 0:y.measurement,disabled:!y}),(0,j.jsx)(Z.A,{offer:C,defaultValues:null===y||void 0===y?void 0:y.images,disabled:!y})]})]})})})}}}]);
//# sourceMappingURL=494.3cd73c29.chunk.js.map