"use strict";(self.webpackChunkmia_erp=self.webpackChunkmia_erp||[]).push([[779,264],{1779:function(e,n,o){o.r(n),o.d(n,{CartPageRightTabsEnum:function(){return E},cartPageTabsOptions:function(){return G},default:function(){return Q}});var i,t,l=o(168),a=o(2360),r=o(8095),d=o(8495),s=o(6146),u=o(8589),c=o(6366),f=o(4897),v=o(2791),p=o(3665),h=o(2928),x=o(9006),g=o(2989),m=o(4781),b=o(2483),j=o(1413),Z=o(9439),y=o(1819),w=o(7824),C=o(8548),I=o(959),S=o(7294),P=o(763),k=o(6492),D=o(6522),$=o(3299),V=o(6681),_=o(3329),R=function(e){var n,o=e.slot,i=e.onChangeQuantity,t=(0,v.useState)(null!==(n=null===o||void 0===o?void 0:o.quantity)&&void 0!==n?n:1),l=(0,Z.Z)(t,2),d=l[0],s=l[1],u=(0,a.Fg)(),c=(0,v.useRef)(),f=(0,v.useRef)(),p=function(e){return function(){var n=null===o||void 0===o?void 0:o.quantity;!(0,P.isUndefined)(n)&&i?i(n+e<0?n:n+e):s((function(n){return n+e<0?n:n+e}))}},h=function(e){return{onMouseDown:function(){c.current=setTimeout((function(){f.current=setInterval((function(){s((function(n){return n+e<0?n:n+e}))}),100)}),250)},onMouseUp:function(){clearTimeout(c.current),clearInterval(f.current),c.current=void 0,f.current=void 0,i&&i(d)}}};return(0,v.useEffect)((function(){var e=null===o||void 0===o?void 0:o.quantity;(0,P.isUndefined)(e)||s(e)}),[null===o||void 0===o?void 0:o.quantity]),(0,_.jsxs)(r.ZP,{flexWrap:"wrap",gap:8,padding:"8px",fxDirection:"row",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr"},children:[["cashback","bonus","discount"].map((function(e){var n;return(0,_.jsxs)(r.ZP,{background:u.fieldBackgroundColor,borderRadius:"4px",justifyContent:"space-between",children:[(0,_.jsx)(k.x,{$weight:400,$size:12,$padding:"4px 6px",children:(0,D.t)(e)}),(0,_.jsx)(k.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,$.pU)(null===o||void 0===o||null===(n=o[e])||void 0===n?void 0:n.amount)})]},e)})),["brutto","netto"].map((function(e){return(0,_.jsxs)(r.ZP,{background:u.fieldBackgroundColor,borderRadius:"4px",justifyContent:"space-between",children:[(0,_.jsx)(k.x,{$weight:400,$size:12,$padding:"4px 6px",children:(0,D.t)(e)}),(0,_.jsx)(k.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,$.pU)(null===o||void 0===o?void 0:o[e])})]},e)})),(0,_.jsxs)(r.ZP,{padding:"0 8px",children:[(0,_.jsx)(A,(0,j.Z)((0,j.Z)({variant:"def",iconSize:"15px",icon:"SmallArrowUp"},h(1)),{},{onClick:p(1)})),(0,_.jsx)(V.ZP,{value:d,name:"quantity",align:"center",onChange:function(e){s(Number(e.target.value))},onBlur:function(){i&&i(d)}}),(0,_.jsx)(A,(0,j.Z)((0,j.Z)({variant:"def",iconSize:"15px",icon:"SmallArrowDown"},h(-1)),{},{onClick:p(-1)}))]})]})},A=(0,a.ZP)(h.ZP)(i||(i=(0,l.Z)(["\n  height: 15px;\n\n  &:hover {\n    padding: 4px 0;\n  }\n"]))),T=o(1251),q=o(8189),z=function(e){var n,o=e.offer,i=e.warehouse,t=(e.slotId,e.onClose),l=(0,p.f9)(),a=(0,g.G2)(o),r=(0,v.useState)(),d=(0,Z.Z)(r,2),s=d[0],u=d[1],f=(0,g.xj)(),h=(0,c.jD)(),x=h.actions.getSlotByVariationId(null===s||void 0===s?void 0:s._id),m=(0,v.useState)(null!==(n=null===x||void 0===x?void 0:x.quantity)&&void 0!==n?n:1),b=(0,Z.Z)(m,2),y=b[0],w=b[1],C=(0,v.useMemo)((function(){var e;return(0,I.Gn)((0,j.Z)((0,j.Z)((0,j.Z)({},x),{},{quantity:y},null!==(e=null===s||void 0===s?void 0:s.price)&&void 0!==e?e:null===a||void 0===a?void 0:a.price),{},{offer:a,variation:s,warehouse:null!==i&&void 0!==i?i:null===a||void 0===a?void 0:a.warehouse}))}),[x,a,y,s,i]);return(0,_.jsxs)(S.Z,{title:"Select variation | ".concat(null===a||void 0===a?void 0:a.label),fillHeight:!0,okButton:!0,onBackPress:t,children:[(0,_.jsx)(q.Z,{offer:a,onSelect:u,selected:s}),(0,_.jsx)(R,{slot:C,onChangeQuantity:w}),(0,_.jsx)(T.AT,{canAccept:!!s,onAcceptPress:function(){var e;null!==s&&void 0!==s&&s._id&&(null!==C&&void 0!==C&&C.tempId&&null!==C&&void 0!==C&&null!==(e=C.tempId)&&void 0!==e&&e.includes(null===s||void 0===s?void 0:s._id)?C.quantity!==(null===x||void 0===x?void 0:x.quantity)&&h.actions.update(C):null!==C&&void 0!==C&&C.warehouse&&h.actions.addSlot(C));f.push({query:(0,P.omit)(f.query,["offerId","slotId","variationId"])}),l.clearStack()}})]})};function L(e){var n,o,i=e.warehouse,t=e.slotId,l=e.onClose,a=(0,c.jD)(),r=(0,y.xc)().get(w.d.offers).getAll,d=a.actions.getSlotWithMethods(t),s=(0,g.xj)(),f=(0,v.useState)(),h=(0,Z.Z)(f,2),x=h[0],m=h[1],b=(0,v.useState)(null!==(n=null===d||void 0===d?void 0:d.quantity)&&void 0!==n?n:1),P=(0,Z.Z)(b,2),k=P[0],D=P[1],$=(0,p.kw)(),V=(0,C.useOffersTableSettings)({searchState:null!==i&&void 0!==i&&i.label?{search:null!==(o=null===i||void 0===i?void 0:i.label)&&void 0!==o?o:"",param:{dataPath:"warehouse.label",label:"\u0421\u043a\u043b\u0430\u0434"}}:void 0}),A=V.tableConfig,q=V.isLoading,L=V.searchParams,F=(0,v.useMemo)((function(){return(0,I.Gn)((0,j.Z)((0,j.Z)({},d),{},{quantity:k},null===x||void 0===x?void 0:x.price))}),[d,k,null===x||void 0===x?void 0:x.price]);return(0,v.useEffect)((function(){var e,n=(0,I.P_)(null===L||void 0===L||null===(e=L.param)||void 0===e?void 0:e.dataPath,null===L||void 0===L?void 0:L.search);i&&r({data:{refresh:!0,params:n}})}),[]),(0,_.jsxs)(S.Z,{title:"Select offer",fillHeight:!0,okButton:!0,onBackPress:l,children:[(0,_.jsx)(u.ZP,(0,j.Z)((0,j.Z)({},A),{},{isLoading:null===q||void 0===q?void 0:q.offers,checkBoxes:!1,selectedRow:x,onRowClick:function(e){var n,o;null!==e&&void 0!==e&&e.rowData&&((null===e||void 0===e||null===(n=e.rowData)||void 0===n?void 0:n._id)&&s.push({query:{offerId:null===e||void 0===e||null===(o=e.rowData)||void 0===o?void 0:o._id}}),m(null===e||void 0===e?void 0:e.rowData))}})),x&&(0,_.jsx)(R,{slot:F,onChangeQuantity:D}),(0,_.jsx)(T.AT,{canAccept:!!x,onAcceptPress:function(){x&&$.create(z,{offer:x})}})]})}function F(e){e.warehouse;var n,o,i=(0,c.jD)(),t=(0,g.zR)(),l=i.actions.getSlotWithMethods(null===(n=t.query)||void 0===n?void 0:n.slotId),a=(0,v.useState)(l.variation),d=(0,Z.Z)(a,1)[0],s=(0,v.useState)(null!==(o=null===l||void 0===l?void 0:l.quantity)&&void 0!==o?o:1),u=(0,Z.Z)(s,2),f=u[0],p=u[1],h=(0,v.useMemo)((function(){var e,n;return(0,I.Gn)((0,j.Z)((0,j.Z)((0,j.Z)({variation:d},l),null!==(e=null===d||void 0===d?void 0:d.price)&&void 0!==e?e:l),{},{origin:null!==(n=null===d||void 0===d?void 0:d.price)&&void 0!==n?n:l.origin,quantity:f}))}),[l,f,d]);return(0,_.jsxs)(B,{fillHeight:!0,maxWidth:"380px",flex:1,padding:"0 8px 8px",children:[(0,_.jsx)(r.ZP,{flex:1}),(0,_.jsx)(R,{slot:h,onChangeQuantity:p}),(0,_.jsx)(T.AT,{canAccept:!!l.tempId&&l.quantity!==f,onAcceptPress:function(){l.setQty(f)}})]})}var M,O,B=(0,a.ZP)(r.ZP)(t||(t=(0,l.Z)(["\n  position: relative;\n  overflow: hidden;\n\n  background-color: ",";\n"])),(function(e){return e.theme.sideBarBackgroundColor})),H=o(4805),W=o(1467),U=o(9953),E=function(e){return e.Slot="Slot",e.Chat="Chat",e}({}),G=(0,I.$G)(E,(function(e){return(0,D.t)(e)}));function Q(e){var n,o=e.path,i=(0,g.zR)(),t=(0,g.Zx)(),l=(0,H.useMediaQuery)({query:"(min-width: 960px)"}),a=(0,c.jD)();return(0,v.useEffect)((function(){t.cartId&&a.actions.setCartId(t.cartId)}),[]),(0,_.jsx)(s.vI,{path:o,children:(0,_.jsxs)(m.ZP,{children:[(0,_.jsxs)(N,{fillWidth:!0,flex:1,overflow:"hidden",fillHeight:!0,fxDirection:"row",gap:4,children:[(0,_.jsx)(r.ZP,{fillHeight:!0,flex:2,children:(0,_.jsx)(K,{})}),(0,_.jsxs)(J,{isVisible:l?void 0:!(null===i||void 0===i||null===(n=i.query)||void 0===n||!n.slotId),className:"RightSide",style:{},children:[(0,_.jsx)(U.Z,{options:G}),(0,_.jsx)(F,{})]})]}),(0,_.jsx)(b.j,{})]})})}var N=(0,a.ZP)(r.ZP)(M||(M=(0,l.Z)(["\n  ","\n"])),d.VU),J=(0,a.ZP)(r.ZP)(O||(O=(0,l.Z)(["\n  overflow: auto;\n\n  max-width: 100%;\n  height: 100%;\n\n  transition: ",";\n  background-color: ",";\n\n  border-color: ",";\n  border-style: solid;\n  border: 0;\n\n  // border-left-width: ",";\n  border-left-width: 1px;\n\n  @media screen and (min-width: 960px) {\n    min-width: 320px;\n  }\n\n  @media screen and (max-width: 960px) {\n    border-left-width: ",";\n\n    position: absolute;\n    top: 0;\n    right: 0;\n    z-index: 250;\n    height: 100%;\n\n    transform: translateX(","%);\n\n    box-shadow: ",";\n  }\n"])),(function(e){return e.theme.globals.timingFunctionMain}),(function(e){return e.theme.backgroundColorLight}),(function(e){return e.theme.trBorderClr}),(function(e){return e.isVisible?"1px":0}),(function(e){return e.isVisible?"1px":0}),(function(e){return e.isVisible?0:100}),(function(e){return e.isVisible?"0 12px 26px rgba(0, 0, 0, 0.25)":""}));function K(e){e.onSlotEditPress;var n=(0,g.zR)().query.cartId,o=(0,c.jD)(),i=(0,p.kw)(),t=(0,g.xj)(),l=(0,a.Fg)(),d=o.actions.getCurrentCart(n||W.JO),s=(0,v.useMemo)((function(){var e=null===d||void 0===d?void 0:d.ordersIds;return null===e||void 0===e?void 0:e.map((function(e,n){var l,a,d,s,c;if(!e)return null;var v=o.actions.getOrderById(e),p=null===(l=o.ordersSlotsMap)||void 0===l?void 0:l[e];return(0,_.jsxs)(x.y,{label:null!==(a=(0,D.t)("Warehouse")+": "+(null===v||void 0===v||null===(d=v.warehouse)||void 0===d?void 0:d.label))&&void 0!==a?a:(0,D.t)("undefined"),hideFooter:!0,renderTitle:(0,_.jsx)(r.ZP,{fxDirection:"row",gap:8,padding:"0 12px",children:(0,_.jsx)(k.x,{$size:13,$weight:600,$padding:"2px 8px",children:null!==(s=(0,D.t)("Warehouse")+": "+(null===v||void 0===v||null===(c=v.warehouse)||void 0===c?void 0:c.label))&&void 0!==s?s:(0,D.t)("undefined")})}),children:[(0,_.jsx)(r.ZP,{minHeight:"300px",children:(0,_.jsx)(u.ZP,{tableData:p,hasSearch:!1,hasFilter:!1,checkBoxes:!0,onCheckboxChange:function(e){o.actions.setChecked({tempId:e.rowId,checked:e.checked})},onHeadCheckboxChange:function(n){o.actions.setChecked({orderId:e,checked:n.checked})},selectedRows:null===v||void 0===v?void 0:v.selectedIds,rowIds:null===v||void 0===v?void 0:v.slotsIds,keyExtractor:function(e){var n;return null!==(n=null===e||void 0===e?void 0:e.tempId)&&void 0!==n?n:"slot"},tableTitles:f.KS,onRowClick:function(){},actionsCreator:function(e){var n,l=null===(n=e.selectedRow)||void 0===n?void 0:n.tempId;return[{icon:"delete",disabled:!l,onClick:function(){l&&o.actions.removeSlot(l)}},{icon:"edit",disabled:!l,onClick:function(){l&&t.push({query:{slotId:l}})}},{icon:"plus",type:"onlyIconFilled",disabled:!(null!==v&&void 0!==v&&v.warehouse),onClick:function(){(null===v||void 0===v?void 0:v.warehouse)&&i.create(L,{warehouse:null===v||void 0===v?void 0:v.warehouse})}}]}})}),(0,_.jsx)(r.ZP,{padding:"8px 0",children:(0,_.jsx)(h.ZP,{variant:"filledMiddle",onClick:function(){o.actions.removeOrder(e)},children:"Remove"})})]},null!==e&&void 0!==e?e:n)}))}),[null===d||void 0===d?void 0:d.ordersIds,o.actions,o.ordersSlotsMap,i,t]);return(0,_.jsxs)(r.ZP,{overflow:"auto",fillHeight:!0,children:[(0,_.jsx)(x.y,{label:"Cart: ".concat(null===d||void 0===d?void 0:d.tempId),expandable:!0,isOpen:!0,hideFooter:!0,children:(0,_.jsxs)(r.ZP,{padding:"8px 12px",flexWrap:"wrap",fxDirection:"row",gap:10,children:[["cashback","bonus","discount"].map((function(e){var n,o;return(0,_.jsxs)(r.ZP,{background:l.backgroundColorSecondary,borderRadius:"2px",justifyContent:"space-between",children:[(0,_.jsx)(k.x,{$weight:400,$size:12,$padding:"4px 6px",$textTransform:"capitalize",children:(0,D.t)(e)}),(0,_.jsx)(k.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,$.pU)(null===d||void 0===d||null===(n=d.summary)||void 0===n||null===(o=n[e])||void 0===o?void 0:o.amount)})]},e)})),["brutto","netto"].map((function(e){var n;return(0,_.jsxs)(r.ZP,{background:l.backgroundColorSecondary,borderRadius:"2px",justifyContent:"space-between",children:[(0,_.jsx)(k.x,{$weight:400,$size:12,$padding:"4px 6px",$textTransform:"capitalize",children:(0,D.t)(e)}),(0,_.jsx)(k.x,{$weight:600,$size:13,$padding:"4px 6px",$align:"end",children:(0,$.pU)(null===d||void 0===d||null===(n=d.summary)||void 0===n?void 0:n[e])})]},e)}))]})}),(0,_.jsx)(r.ZP,{flex:1,gap:8,children:s}),(0,_.jsxs)(r.ZP,{fxDirection:"row",gap:12,padding:"16px",fillWidth:!0,alignItems:"center",justifyContent:"center",style:{position:"sticky",bottom:0,left:0,zIndex:100,backdropFilter:"blur(3px)"},children:[(0,_.jsx)(h.ZP,{variant:"outlinedMiddle",icon:"plus",disabled:!d,onClick:function(){i.create(L,{})},children:"Add slot"}),(0,_.jsx)(h.ZP,{variant:"filledMiddle",disabled:!d,onClick:function(){null===d||void 0===d||d.remove()},children:"Remove all"})]})]})}},8548:function(e,n,o){o.r(n),o.d(n,{default:function(){return G},useOffersTableSettings:function(){return Q}});var i,t=o(9439),l=o(168),a=o(1413),r=o(8589),d=o(8495),s=o(2360),u=o(2791),c=o(6931),f=o(7348),v=function(){return[]},p=o(3433),h=o(3665),x=o(3691),g=o(1819),m=o(6522),b=o(7264),j=o(1494),Z=o(2410),y=o(2989),w=o(959),C=o(8095),I=o(389),S=o(8050),P=o(4990),k=o(6681),D=o(9006),$=o(8582),V=o(9964),_=o(3383),R=o(7802),A=o(870),T=o(9184),q=o(4809),z=o(9953),L=o(763),F=o(3329),M=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).loaders,n=(0,g.xc)().get(g.EJ.offers),o=(0,Z.x)(),i=(0,h.f9)(),t=(0,f.i7)().dataMap;return(0,u.useCallback)((function(l){var a,r=null===(a=l.selectedRow)||void 0===a?void 0:a._id,d=r?null===t||void 0===t?void 0:t[r]:void 0;return[{name:"filter",icon:"filterOff",onClick:function(){i.create(B,{onSubmit:function(e){n.getAll({params:(0,w.vg)(e)})}})}},{separator:!0},{name:"refreshData",title:(0,m.t)("Refresh data"),icon:"refresh",type:"onlyIcon",onClick:function(){n.getAll({data:{refresh:!0},onLoading:e?e.onLoading("refresh"):l.onRefresh})}},{separator:!0},{name:"review",title:"\u041f\u0435\u0440\u0435\u0433\u043b\u044f\u0434 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u0443",icon:"openInNew",disabled:!r,type:"onlyIcon",navTo:"/app/".concat(o.params.permissionId,"/offers/")+r},{name:"edit",title:"\u0417\u043c\u0456\u043d\u0438\u0442\u0438",icon:"edit",iconSize:"90%",type:"onlyIcon",disabled:!r,onClick:function(){d?i.create(b.default,{offer:d}):r&&n.getOne({data:{data:{params:{_id:r}}},onLoading:e?e.onLoading("offer"):l.onRefresh,onSuccess:function(e){var n=e.data;i.create(b.default,{offer:n})}})}},{name:"copy",title:"\u041a\u043e\u043f\u0456\u044e\u0432\u0430\u0442\u0438",icon:"copy",iconSize:"90%",type:"onlyIcon",disabled:!d,onClick:function(){d&&i.create(b.default,{offer:d,copy:!0})}},{name:"archiveOffer",title:"\u0410\u0440\u0445\u0456\u0432",icon:"archive",iconSize:"90%",type:"onlyIcon",disabled:!0},{separator:!0},{name:"createOffer",title:"\u041d\u043e\u0432\u0438\u0439",icon:"plus",iconSize:"90%",type:"onlyIconFilled",disabled:!1,onClick:function(){i.create(j.default)}}]}),[e,i,o,n,t])},O=["createdAt","updatedAt","deletedAt"],B=function(e){var n,o,i=e.onSubmit,l=e.onClose,r=(0,f.q$)(A.cA.TAGS),d=(0,f.q$)(A.cA.BRANDS),s=(0,f.q$)(A.cA.CATEGORIES_PROD),c=(0,f.WS)(),v=(0,f.eO)().warehouses,h=(0,y.hN)(),g=(0,w.H1)(x.H),b=(0,u.useState)(),j=(0,t.Z)(b,2),Z=j[0],M=j[1],B=(0,u.useMemo)((function(){return{tags:r.directory.map((function(e,n){var o;return(0,a.Z)((0,a.Z)({},e),{},{label:null!==(o=e.label)&&void 0!==o?o:"Item ".concat(n),value:e._id,name:""})})),categories:s.directory.map((function(e,n){var o;return(0,a.Z)((0,a.Z)({},e),{},{label:null!==(o=e.label)&&void 0!==o?o:"Item ".concat(n),value:e._id,name:""})})),brands:d.directory.map((function(e,n){var o;return(0,a.Z)((0,a.Z)({},e),{},{label:null!==(o=e.label)&&void 0!==o?o:"Item ".concat(n),value:e._id,name:""})})),properties:c.map((function(e,n){var o;return(0,a.Z)((0,a.Z)({},e),{},{label:null!==(o=e.label)&&void 0!==o?o:"Item ".concat(n),value:e._id,name:""})})),warehouses:v.map((function(e,n){var o;return(0,a.Z)((0,a.Z)({},e),{},{label:null!==(o=e.label)&&void 0!==o?o:"Item ".concat(n),value:e._id,name:""})}))}}),[d.directory,s.directory,c,r.directory,v]);return(0,F.jsx)(S.Z,{title:"Filter",onClose:l,children:(0,F.jsxs)(C._0,{padding:"8px",onSubmit:h.handleSubmit((function(e){console.log(e),i&&i((0,L.omit)(e,["propsIdsMap"]))})),children:[(0,F.jsx)(P.Z,{label:(0,m.t)("Status"),children:(0,F.jsx)(R.Z,{onSelectValue:function(e){h.setValue("approved",e.value)},values:h.formValues.approved?[h.formValues.approved]:void 0,options:g})}),(0,F.jsx)(P.Z,{label:(0,m.t)("Type"),children:(0,F.jsx)(V.Z,{value:h.formValues.type,options:_.LC,form:h})}),(0,F.jsx)(P.Z,{label:(0,m.t)("Visibility"),children:(0,F.jsx)(I.Z,{name:"visible",value:h.formValues.visible,onChange:function(e){h.setValue("visible",e,{shouldTouch:!0,shouldDirty:!0})}})}),(0,F.jsx)(D.y,{hideFooter:!0,label:"Tags",children:(0,F.jsx)(R.Z,{multiple:!0,onChange:function(e){h.setValue("tagsIds",e)},values:h.formValues.tagsIds,options:B.tags})}),(0,F.jsx)(D.y,{hideFooter:!0,label:"Categories",maxHeight:"500px",children:(0,F.jsx)(T.Z,{onChangeIds:function(e){h.setValue("categoriesIds",e)},selectedIds:h.formValues.categoriesIds})}),(0,F.jsxs)(D.y,{hideFooter:!0,label:"Properties",children:[(0,F.jsx)(z.Z,{options:c,defaultOption:Z,onOptSelect:function(e){M(e)}}),null===Z||void 0===Z||null===(n=Z.childrenList)||void 0===n?void 0:n.map((function(e){var n;return(0,F.jsx)(q.Z,{item:e,multiple:!0,selectedIds:null===(n=h.formValues.propsIdsMap)||void 0===n?void 0:n[e._id],onChangeIds:function(e,n){var o;h.setValue("propsIdsMap.".concat(e),n,{shouldDirty:!0,shouldTouch:!0}),h.setValue("propertiesIds",Array.from(new Set([].concat((0,p.Z)(null!==(o=h.formValues.propertiesIds)&&void 0!==o?o:[]),(0,p.Z)(n)))),{shouldDirty:!0,shouldTouch:!0})}},e._id)}))]}),(0,F.jsx)(D.y,{hideFooter:!0,label:"Brands",children:(0,F.jsx)(R.Z,{multiple:!0,onChange:function(e){h.setValue("brandsIds",e)},values:h.formValues.brandsIds,options:B.brands})}),(0,F.jsx)(D.y,{hideFooter:!0,label:"Warehouses",children:(0,F.jsx)(R.Z,{multiple:!0,onChange:function(e){h.setValue("warehouse.ids",e)},values:null===(o=h.formValues.warehouse)||void 0===o?void 0:o.ids,options:B.warehouses})}),(0,F.jsx)(D.y,{label:"Date fields",hideFooter:!0,children:O.map((function(e){return(0,F.jsxs)(C.hs,{gap:12,fxDirection:"row",fillWidth:!0,xsStyles:{fxDirection:"column",gap:0,margin:"0 0 8px"},children:[(0,F.jsx)(P.Z,{flex:1,label:"".concat((0,m.t)(e)," ").concat((0,m.t)("From").toLowerCase(),":"),children:(0,F.jsx)(k.ZP,(0,a.Z)({type:"datetime-local"},h.register("".concat(e,".dateFrom"))))}),(0,F.jsx)(P.Z,{flex:1,label:"".concat((0,m.t)(e)," ").concat((0,m.t)("To").toLowerCase(),":"),children:(0,F.jsx)(k.ZP,(0,a.Z)({type:"datetime-local"},h.register("".concat(e,".dateTo"))))})]},e)}))}),(0,F.jsx)($.Z,{onSubmitPassed:!0})]})})},H=o(4897),W=o(9541),U=o(7824),E=(0,s.ZP)(C.ZP)(i||(i=(0,l.Z)(["\n  ","\n"])),d.VU),G=function(e){var n=Q({}),o=n.tableConfig,i=n.isLoading;return(0,F.jsx)(c.default,{path:e.path,children:(0,F.jsx)(E,{children:(0,F.jsx)(r.ZP,(0,a.Z)((0,a.Z)({},o),{},{showFooter:!0,isLoading:null===i||void 0===i?void 0:i.offers}))})})},Q=function(e){var n=e.searchState,o=e.sortState,i=(0,W.J)({offers:{content:"Refreshing..."},refresh:{content:"Refreshing..."},offer:{content:"Refreshing..."}}),l=i.onLoading,a=i.isLoading,r=(0,g.xc)().get(U.d.offers).getAll,d=(0,f.i7)(),s=v(),c=M({loaders:i}),p=(0,u.useState)(o),h=(0,t.Z)(p,2),x=h[0],m=h[1],b=(0,u.useState)(n),j=(0,t.Z)(b,2),Z=j[0],y=j[1],C=(0,u.useMemo)((function(){return{onSubmitSearch:function(e){if(e.search){var n,o={},i=null===(n=e.param)||void 0===n?void 0:n.dataPath;i&&e.search&&(0,w.P_)(i,e.search,o,{mutation:!0}),y(e),r({params:o,onLoading:l("offers")}).then()}else r({onLoading:l("offers")}).then()},tableData:d.list,tableTitles:H.Y5,searchParams:H.Dr,sortParams:H.Cs,filterSelectors:s,hasFilter:!1,hasSearch:!0,showFooter:!1,checkBoxes:!0,actionsCreator:c,onTableSortChange:function(e,n){m({param:e,order:n}),console.log({param:e,order:n}),r({params:{sortOrder:n,sortPath:e.dataPath},onLoading:l("offers")}).then()}}}),[c,s,r,l,d.list]);return(0,u.useEffect)((function(){0===d.list.length&&r({onLoading:l("offers")})}),[]),{tableConfig:C,isLoading:a,sortParams:x,searchParams:Z}}},7264:function(e,n,o){o.r(n);var i=o(1413),t=o(9420),l=o(8050),a=o(6522),r=o(959),d=o(3691),s=o(9306),u=o(3007),c=o(8095),f=o(6653),v=o(6492),p=o(9541),h=o(7578),x=o(8160),g=o(5888),m=o(2989),b=o(7608),j=o(5248),Z=o(3329);n.default=function(e){var n,o,y,w,C,I,S,P,k,D,$=e.onClose,V=e.offer,_=e.copy,R=(0,m.G2)(V),A=(0,p.J)({offer_refresh:{content:"Refreshing..."},offer_update:{content:"Updating..."}},{formData:R?(0,r.xT)(R):{type:d.i.GOODS}}),T=A.setData,q=A.state,z=_?null===(n=q.formData)||void 0===n?void 0:n._id:null===R||void 0===R?void 0:R._id;return R?(0,Z.jsx)(l.Z,{fillHeight:!0,title:_?(0,a.t)("Copy offer"):(0,a.t)("Update offer"),onClose:$,children:(0,Z.jsx)(h.f4,{value:A,children:null!==(o=A.isLoading)&&void 0!==o&&o.offer?(0,Z.jsxs)(c.ZP,{fillWidth:!0,padding:"24px",alignItems:"center",gap:16,children:[(0,Z.jsx)(f.$,{size:52}),(0,Z.jsx)(v.x,{children:(0,a.t)("Loading info about offer...")})]}):(0,Z.jsxs)(c.ZP,{padding:"0 0 16px",children:[(0,Z.jsx)(u.B,{_id:z,edit:!_,type:null===(y=q.formData)||void 0===y?void 0:y.type,defaultValues:null===q||void 0===q?void 0:q.formData,onSuccess:function(e){var n=e.data;T("formData",_?(0,i.Z)((0,i.Z)({},(0,r.xT)(n)),{},{_id:n._id}):(0,r.xT)(n))}}),(0,Z.jsx)(b.A,{_id:z,offer:R,defaultValues:null===(w=q.formData)||void 0===w?void 0:w.categories,disabled:!q.formData}),(0,Z.jsx)(x.R,{_id:z,offer:R,defaultValues:null===(C=q.formData)||void 0===C?void 0:C.properties,disabled:!q.formData}),(0,Z.jsx)(j.L,{expandable:!0,isOpen:!1,offer:R,defaultState:null===R||void 0===R?void 0:R.price,price:null===R||void 0===R?void 0:R.price,title:(0,a.t)("Price")}),(0,Z.jsx)(g.A,{offer:R,defaultValues:null===q||void 0===q||null===(I=q.formData)||void 0===I?void 0:I.images,disabled:!(null!==q&&void 0!==q&&q.formData),_id:z}),(0,Z.jsx)(t.A,{offer:R,defaultValues:null===(S=q.formData)||void 0===S?void 0:S.dimensions,disabled:_?!(null!==(P=q.formData)&&void 0!==P&&P._id&&q.formData):!z,_id:z}),(0,Z.jsx)(s.n,{offer:R,defaultValues:null===(k=q.formData)||void 0===k?void 0:k.measurement,disabled:_?!(null!==(D=q.formData)&&void 0!==D&&D._id&&q.formData):!z,_id:z})]})})}):(0,Z.jsx)(l.Z,{title:_?(0,a.t)("Copy offer"):(0,a.t)("Update offer"),fillHeight:!0,children:(0,Z.jsx)(c.ZP,{fillWidth:!0,fillHeight:!0,padding:"26px",alignItems:"center",justifyContent:"center",children:(0,Z.jsx)(v.x,{$size:16,$weight:600,children:(0,a.t)("Offer not found")})})})}}}]);
//# sourceMappingURL=779.892d8a38.chunk.js.map