"use strict";(self.webpackChunkcounter_app_ts=self.webpackChunkcounter_app_ts||[]).push([[481],{9481:function(e,n,o){o.r(n),o.d(n,{default:function(){return B}});var t=o(168),i=o(1413),l=o(3933),r=o(1680),a=o(454),c=o(2360),d=o(7348),u=o(3551),s=function(){return{create:function(e){console.log("trService create",e)},deleteById:function(e){console.log("trService deleteById",e)},editById:function(e){console.log("trService editById",e)},getById:function(e){console.log("trService getById",e)},dispatch:(0,u.TL)(),state:(0,d.cM)()}},f=o(2791),p=function(){var e=(0,u.CG)(),n=e.counts,o=e.categories;return[{label:"\u0422\u0438\u043f",data:[{_id:"ds6d5vf6sd5f1v6sd",name:"INCOME",label:"\u0414\u041e\u0425\u0406\u0414"},{_id:"ds6d5vf6sd6f1v61d",name:"TRANSFER",label:"\u041f\u0415\u0420\u0415\u041a\u0410\u0417"},{_id:"ds6d5vf6dd6f1v68d",name:"EXPENSE",label:"\u0412\u0418\u0422\u0420\u0410\u0422\u0418"}],selectorName:"type"},{label:"\u0420\u0430\u0445\u0443\u043d\u043a\u0438",data:n.counts,selectorName:"counts"},{label:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u0457",data:o.categories,selectorName:"categories"}]},h=o(4354),b=o(4925),m=o(5114),v=o(4990),g=o(6681),Z=o(6727),x=o(4695),C=o(1134),y=o(4343),S=o(3423),j=o(2322),I=o(9439),P=o(8409),O=function(e){var n=(0,f.useState)({parentList:[],treeData:{},loading:!1,error:null}),o=(0,I.Z)(n,2),t=o[0],l=o[1];return(0,f.useMemo)((function(){(0,P.h)(e,{onSuccess:function(e){return l((function(n){return(0,i.Z)((0,i.Z)({},n),{},{treeData:e})}))},onError:function(e){return l((function(n){return(0,i.Z)((0,i.Z)({},n),{},{error:e})}))},onLoading:function(e){return l((function(n){return(0,i.Z)((0,i.Z)({},n),{},{loading:e})}))}})}),[e]),(0,f.useMemo)((function(){return l((function(n){return(0,i.Z)((0,i.Z)({},n),{},{parentList:e.filter((function(e){return!e.owner}))})}))}),[e]),t},N=o(8095);function M(e,n){var o=n||{},t=o.logData,i=o.logError,l=o.logLoading,r=o.logAll,a=o.onError,c=o.onSuccess,d=o.onLoading;return{onSuccess:function(e){(r||t)&&console.log("createSubmitHandlerWithPayload onSuccess",e),c&&c(e)},onError:function(e){(r||i)&&console.log("createSubmitHandlerWithPayload onError",e),a&&a(e)},onLoading:function(e){(r||l)&&console.log("createSubmitHandlerWithPayload onLoading",e),d&&d(e)},submitData:e,data:e}}var E,k,_=o(184),w=["edit","onSubmit","onSubmitEdit","copy","defaultState"],T=Z.Ry().shape({_id:Z.Z_(),label:Z.Z_(),owner:Z.Ry().shape({_id:Z.Z_(),label:Z.Z_()}).optional().nullable()}).nullable(),R=Z.Ry().shape({countIn:T,subCountIn:T}),F=c.ZP.div(E||(E=(0,t.Z)(["\n  display: grid;\n  grid-template-columns: ",";\n  gap: 12px;\n"])),(function(e){return e.gridTemplateColumns||"1fr 120px"})),D=function(e){e.edit;var n,o,t,l=e.onSubmit,r=e.onSubmitEdit,a=(e.copy,e.defaultState),c=(0,b.Z)(e,w),d=(0,u.CG)(),s=d.counts.counts,p=d.categories.categories,h=O(s),Z=O(p),I=(0,C.cI)({defaultValues:(0,i.Z)({currency:"UAH"},a),resolver:(0,x.X)(R),reValidateMode:"onSubmit"}),P=I.formState.errors,E=I.register,k=I.setValue,T=I.watch,D=I.unregister,V=I.handleSubmit,z=T(),A=(0,f.useCallback)((function(e,n,o){var t;return(0,i.Z)({onSelect:function(t,i){console.log({option:t,formValues:z,name:e,props:n,childControl:o,setValue:k,unregister:D}),k(e,t)},name:e,selectValue:z[e],onClear:function(){z[e]&&(k(e,null),D(e),console.log("cleared input",e,z[e]),null!==o&&void 0!==o&&o.childName&&(console.log("cleared child",o.childName),k(o.childName,null),D(o.childName),console.log("cleared child",o.childName,z[o.childName])),null===n||void 0===n||!n.options||n.options.length)},disabled:!(null!==n&&void 0!==n&&n.options)||0===(null===n||void 0===n||null===(t=n.options)||void 0===t?void 0:t.length)},n)}),[z,k,D]),B=(0,f.useMemo)((function(){var e,n,o=h.parentList,t=h.treeData,l=null!==(e=z.countIn)&&void 0!==e&&e._id?t[null===(n=z.countIn)||void 0===n?void 0:n._id]:void 0;return z.type&&["INCOME","TRANSFER"].includes(z.type)?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(S.Z,(0,i.Z)({label:"\u0420\u0430\u0445\u0443\u043d\u043e\u043a IN",placeholder:"\u0420\u0430\u0445\u0443\u043d\u043e\u043a IN"},A("countIn",{options:o},{childName:"subCountIn"}))),(0,_.jsx)(S.Z,(0,i.Z)({label:"\u0421\u0443\u0431-\u0440\u0430\u0445\u0443\u043d\u043e\u043a IN",placeholder:"\u0421\u0443\u0431-\u0440\u0430\u0445\u0443\u043d\u043e\u043a IN"},A("subCountIn",{options:l})))]}):null}),[h,null===(n=z.countIn)||void 0===n?void 0:n._id,z.type,A]),H=(0,f.useMemo)((function(){var e,n,o=h.parentList,t=h.treeData,l=null!==(e=z.countOut)&&void 0!==e&&e._id?t[null===(n=z.countOut)||void 0===n?void 0:n._id]:void 0;return z.type&&["EXPENSE","TRANSFER"].includes(z.type)?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(S.Z,(0,i.Z)({label:"\u0420\u0430\u0445\u0443\u043d\u043e\u043a OUT",placeholder:"\u0420\u0430\u0445\u0443\u043d\u043e\u043a OUT"},A("countOut",{options:o,error:P.countOut},{childName:"subCountOut"}))),(0,_.jsx)(S.Z,(0,i.Z)({label:"\u0421\u0443\u0431-\u0440\u0430\u0445\u0443\u043d\u043e\u043a OUT",placeholder:"\u0421\u0443\u0431-\u0440\u0430\u0445\u0443\u043d\u043e\u043a OUT"},A("subCountOut",{options:l,error:P.subCountOut})))]}):null}),[h,P.countOut,P.subCountOut,null===(o=z.countOut)||void 0===o?void 0:o._id,z.type,A]),L=(0,f.useMemo)((function(){var e,n,o=Z.parentList,t=Z.treeData,l=null!==(e=z.category)&&void 0!==e&&e._id?t[null===(n=z.category)||void 0===n?void 0:n._id]:void 0;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(S.Z,(0,i.Z)({label:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044f",placeholder:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044f"},A("category",{options:o}))),(0,_.jsx)(S.Z,(0,i.Z)({label:"\u041f\u0456\u0434\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044f",placeholder:"\u041f\u0456\u0434\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044f"},A("subCategory",{options:l})))]})}),[Z,null===(t=z.category)||void 0===t?void 0:t._id,A]);return(0,_.jsx)(m.Z,(0,i.Z)((0,i.Z)({onSubmit:V((function(e){var n="INCOME"===z.type&&["countOut","subCountOut"]||"EXPENSE"===z.type&&["countIn","subCountIn"]||[],o=(0,j.hJ)(e,n,"transactionDate");console.log("trReqData",o),l&&l(M({data:o})),r&&null!==a&&void 0!==a&&a._id&&r(M({_id:null===a||void 0===a?void 0:a._id,data:o}))})),onOptSelect:function(e){var n=e.value;return n&&k("type",n)}},c),{},{children:(0,_.jsxs)(N.ZP,{className:"inputs",flex:"1",fillWidth:!0,maxHeight:"100%",padding:"12px",overflow:"auto",children:[(0,_.jsx)(v.Z,{label:"\u0414\u0430\u0442\u0430 \u0456 \u0447\u0430\u0441",direction:"vertical",children:(0,_.jsx)(g.ZP,(0,i.Z)({placeholder:"\u0414\u0430\u0442\u0430 \u0456 \u0447\u0430\u0441",type:"datetime-local"},E("transactionDate")))}),(0,_.jsxs)(F,{children:[(0,_.jsx)(v.Z,{label:"\u0421\u0443\u043c\u0430",direction:"vertical",children:(0,_.jsx)(g.ZP,(0,i.Z)({placeholder:"\u0421\u0443\u043c\u0430"},E("amount")))}),(0,_.jsx)(v.Z,{label:"\u0412\u0430\u043b\u044e\u0442\u0430",direction:"vertical",children:(0,_.jsx)(g.ZP,(0,i.Z)((0,i.Z)({placeholder:"\u0412\u0430\u043b\u044e\u0442\u0430"},E("currency")),{},{disabled:!0}))})]}),B,H,L,(0,_.jsx)(v.Z,{label:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",direction:"vertical",disabled:!0,children:(0,_.jsx)(g.ZP,{placeholder:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",disabled:!0})}),(0,_.jsx)(v.Z,{label:"\u041f\u0440\u043e\u0454\u043a\u0442",direction:"vertical",disabled:!0,children:(0,_.jsx)(g.ZP,{placeholder:"\u041f\u0440\u043e\u0454\u043a\u0442",disabled:!0})}),(0,_.jsx)(v.Z,{label:"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442",direction:"vertical",disabled:!0,children:(0,_.jsx)(g.ZP,{placeholder:"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442",disabled:!0})}),(0,_.jsx)(v.Z,{label:"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440",direction:"vertical",children:(0,_.jsx)(y.Z,(0,i.Z)({placeholder:"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440"},E("comment")))})]})}))},V=o(4961),z=o(3431),A=c.ZP.div(k||(k=(0,t.Z)(["\n  ","\n"])),r.VU),B=function(e){var n=e.path,o=s(),t=p(),r=function(e){var n=(0,h.f9)();return(0,f.useCallback)((function(o){return[{name:"editTr",title:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u043d\u043d\u044f \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0456\u0457",icon:"edit",disabled:!1,disabledCheck:function(){return!1},type:"onlyIcon",onClick:function(){n.handleOpenModal({ModalChildren:D,modalChildrenProps:{title:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u043d\u043d\u044f \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0456\u0457",filterOptions:V.MN,onSubmitEdit:e.editById,fillHeight:!0}})}},{name:"copyTr",title:"\u041a\u043e\u043f\u0456\u044e\u0432\u0430\u043d\u043d\u044f \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0456\u0457",icon:"copy",type:"onlyIcon",disabled:!1,disabledCheck:function(){return!1},onClick:function(){n.handleOpenModal({ModalChildren:D,modalChildrenProps:{title:"\u041a\u043e\u043f\u0456\u044e\u0432\u0430\u043d\u043d\u044f \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0456\u0457",filterOptions:V.MN,onSubmit:e.create,fillHeight:!0}})}},{name:"deleteTr",title:"\u0412\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0456\u0457",icon:"delete",iconSize:"90%",type:"onlyIcon",disabled:!0,disabledCheck:function(){return!0},onClick:function(){e.deleteById(M({id:"id"},{onSuccess:function(e){console.log(e)}}))}},{separator:!0},{name:"createIncomeTr",title:"\u0414\u043e\u0445\u0456\u0434",icon:"INCOME",iconSize:"90%",type:"onlyIconFilled",disabled:!1,disabledCheck:function(){return!0},onClick:function(){n.handleOpenModal({ModalChildren:D,modalChildrenProps:{title:"\u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u043d\u043e\u0432\u0443",filterOptions:V.MN,defaultOption:0,defaultState:{type:"INCOME"},onSubmit:e.create,fillHeight:!0}})}},{name:"createTransferTr",title:"\u041f\u0435\u0440\u0435\u043a\u0430\u0437 \u043c\u0456\u0436 \u0440\u0430\u0445\u0443\u043d\u043a\u0430\u043c\u0438",icon:"TRANSFER",iconSize:"90%",type:"onlyIconFilled",disabled:!1,disabledCheck:function(){return!0},onClick:function(){n.handleOpenModal({ModalChildren:D,modalChildrenProps:{title:"\u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u043d\u043e\u0432\u0443",filterOptions:V.MN,defaultOption:1,defaultState:{type:"TRANSFER"},onSubmit:e.create,fillHeight:!0}})}},{name:"createExpenseTr",title:"\u0412\u0438\u0442\u0440\u0430\u0442\u0430",icon:"EXPENSE",iconSize:"90%",type:"onlyIconFilled",disabled:!1,disabledCheck:function(){return!0},onClick:function(){n.handleOpenModal({ModalChildren:D,modalChildrenProps:{title:"\u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u043d\u043e\u0432\u0443",filterOptions:V.MN,defaultOption:2,defaultState:{type:"EXPENSE"},onSubmit:e.create,fillHeight:!0}})}}]}),[n,e])}(o),c=(0,f.useMemo)((function(){return{tableData:a.VF||o.state.transactions,tableTitles:a.yV,tableSearchParams:a.wo.filter((function(e){return e.search})),tableSortParams:a.wo.filter((function(e){return e.sort})),filterSelectors:t,isFilter:!0,isSearch:!0,footer:!0,checkBoxes:!0,actionsCreator:r,onFilterSubmit:function(e){},onRowClick:function(e){}}}),[r,t,o.state.transactions]);return(0,_.jsx)(z.default,{path:n,children:(0,_.jsx)(A,{children:(0,_.jsx)(l.ZP,(0,i.Z)({},c))})})}},1680:function(e,n,o){o.d(n,{SI:function(){return d},VU:function(){return c}});var t,i,l,r=o(168),a=o(2360),c=(0,a.iv)(t||(t=(0,r.Z)(["\n  grid-column: 1/13;\n  grid-row: 1/13;\n"]))),d=(0,a.iv)(i||(i=(0,r.Z)(["\n  width: 100%;\n  height: 100%;\n"])));(0,a.iv)(l||(l=(0,r.Z)(["\n  outline: 1px solid tomato;\n"])))},3423:function(e,n,o){var t,i,l,r,a,c,d=o(168),u=o(1413),s=o(9439),f=o(4925),p=o(4990),h=o(2791),b=o(763),m=o(2360),v=o(8095),g=o(8449),Z=o(4109),x=o(184),C=["InputComponent","inputProps","labelProps","selectValue","keepOpen","valueKey","id","options","name","open","onSelect","onClear","fieldMode"],y=function(e,n){e.InputComponent;var o=e.inputProps,t=void 0===o?{}:o,i=e.labelProps,l=void 0===i?{}:i,r=e.selectValue,a=e.keepOpen,c=e.valueKey,d=e.id,m=e.options,y=(e.name,e.open),M=void 0!==y&&y,E=e.onSelect,k=e.onClear,_=e.fieldMode,w=(0,f.Z)(e,C),T=(0,h.useState)(r),R=(0,s.Z)(T,2),F=R[0],D=R[1],V=(0,h.useState)(a||M),z=(0,s.Z)(V,2),A=z[0],B=z[1],H=(0,h.useRef)(null),L=(0,h.useMemo)((function(){return Math.random().toFixed(5)}),[]),W=(0,h.useCallback)((function(){!a&&B((function(e){return!e}))}),[a]),U=(0,h.useCallback)((function(e){if(m&&0!==(null===m||void 0===m?void 0:m.length))return function(){D(e),E&&c&&c&&e[c]?E(e,e[c]):(E&&E(e,null===e||void 0===e?void 0:e.value),W())}}),[W,E,m,c]),X=(0,h.useCallback)((function(){D(void 0),k&&k()}),[k]),G=(0,h.useMemo)((function(){return null===m||void 0===m?void 0:m.map((function(e){return(0,x.jsx)(j,{onClick:U(e),justifyContent:"flex-start",fillWidth:!0,fxDirection:"row",padding:"5px 8px",isActive:(null===e||void 0===e?void 0:e._id)===(null===F||void 0===F?void 0:F._id),children:e.label||e.name},e._id)}))}),[null===F||void 0===F?void 0:F._id,U,m]);return(0,h.useEffect)((function(){L||console.log("Render CustomSelect",d||L)}),[d,L]),(0,h.useEffect)((function(){return r?D(r):r?void 0:D(void 0)}),[r]),(0,x.jsxs)(v.ZP,{fillWidth:!0,style:{position:"relative"},"data-select":d||L,children:[(0,x.jsx)(v.ZP,{fillWidth:!0,style:{position:"relative"},children:(0,x.jsx)(p.Z,(0,u.Z)((0,u.Z)((0,u.Z)({direction:"vertical",ref:H},(0,b.pick)(w,["error","success","helperText","loading","label","id","uppercase","align","direction","disabled"])),l),{},{onClick:W,children:(0,x.jsxs)(I,{fieldMode:_,error:!!w.error,success:!!w.success,children:[(0,x.jsx)(P,(0,u.Z)((0,u.Z)({disabled:!_,value:(null===F||void 0===F?void 0:F.label)||(null===F||void 0===F?void 0:F.name)||"",ref:n},(0,b.omit)((0,u.Z)({},(0,b.pick)(w,["".concat(_?"onChange":""),"onBlur","name","id","ref","placeholder"])),["error","success","loading"])),t)),(0,x.jsxs)(N,{fxDirection:"row",gap:6,fillHeight:!0,alignItems:"center",padding:"0 8px 0 0",children:[k&&F&&(0,x.jsx)(Z.Z,{variant:"onlyIconNoEffects",className:"clearIcon",icon:"close",size:"20px",onClick:X}),(0,x.jsx)(g.Z,{className:"openIcon",icon:A?"SmallArrowUp":"SmallArrowDown",size:"20px"})]})]})}))}),(0,x.jsx)(S,{isOpen:A,children:(0,x.jsx)(v.ZP,{fillWidth:!0,overflow:"auto",children:m&&(null===m||void 0===m?void 0:m.length)>0?G:(0,x.jsx)(O,{fillWidth:!0,fxDirection:"row",alignItems:"center",justifyContent:"center",children:"\u041e\u043f\u0446\u0456\u0457 \u0432\u0456\u0434\u0441\u0443\u0442\u043d\u0456"})})})]})},S=(0,m.ZP)(v.ZP)(t||(t=(0,d.Z)(["\n  // position: absolute;\n  // top: calc(100% + 4px);\n  // left: 0;\n  // z-index: ",";\n  font-size: 14px;\n\n  max-height: ",";\n  opacity: ",";\n  width: 100%;\n  overflow: hidden;\n\n  margin-top: 4px;\n\n  border-radius: 2px;\n  background-color: ",";\n  transition: all ",";\n"])),(function(e){return e.isOpen?100:10}),(function(e){return e.isOpen?"120px":0}),(function(e){return e.isOpen?1:0}),(function(e){return e.theme.fieldBackgroundColor}),(function(e){return e.theme.globals.timingFunctionMain})),j=(0,m.ZP)(v.X1)(i||(i=(0,d.Z)(["\n  min-height: 28px;\n\n  font-weight: ",";\n"])),(function(e){return e.isActive?700:""})),I=m.ZP.fieldset(l||(l=(0,d.Z)(["\n  flex: 1;\n\n  display: flex;\n  align-items: center;\n\n  padding: 0;\n  margin: 0;\n\n  width: 100%;\n  min-height: 28px;\n\n  color: ",";\n\n  background-color: ",";\n  border-radius: 2px;\n\n  border: 1px solid\n    ",";\n\n  &:hover {\n    border-color: ",";\n    //box-shadow: 0 0 3px ",";\n  }\n\n  &:focus,\n  &:focus-visible {\n    border-color: ",";\n    //box-shadow: 0 0 5px ",";\n    outline: 1px solid ",";\n  }\n\n  &::placeholder {\n    font-size: inherit;\n    color: ",";\n  }\n\n  //transition: border-color ",";\n\n  &[disabled] {\n    pointer-events: none;\n    opacity: 70%;\n  }\n\n  @media screen and (max-width: 480px) {\n    height: 34px;\n    font-size: 16px;\n  }\n"])),(function(e){var n=e.error,o=e.success,t=e.theme;return n&&t.globals.colors.error||o&&t.globals.colors.success||"inherit"}),(function(e){var n=e.theme,o=e.fieldMode;return(void 0===o?"true":o)?n.field.backgroundColor:"transparent"}),(function(e){var n=e.error,o=e.success,t=e.fieldMode,i=void 0===t?"true":t,l=e.theme;return n&&l.globals.colors.error||o&&l.globals.colors.success||i&&l.field.backgroundColor||l.input.borderColor}),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.globals.inputPlaceholderColor}),(function(e){return e.theme.globals.timingFunctionMain})),P=m.ZP.input(r||(r=(0,d.Z)(["\n  flex: 1;\n  height: 100%;\n\n  padding: 4px 8px;\n\n  background-color: transparent;\n  border-radius: 0;\n  border: 0;\n  outline: none;\n\n  &:hover,\n  &:focus,\n  &:focus-visible {\n    outline: none;\n  }\n"]))),O=(0,m.ZP)(v.ZP)(a||(a=(0,d.Z)(["\n  min-height: 28px;\n\n  font-weight: 700;\n  line-height: 1.3;\n"]))),N=(0,m.ZP)(v.ZP)(c||(c=(0,d.Z)(["\n  //position: absolute;\n  //top: 50%;\n  //right: 4px;\n  //z-index: 5;\n  //transform: translateY(-50%);\n\n  max-height: 100%;\n\n  color: ",";\n  fill: ",";\n"])),(function(e){return e.theme.accentColor.base}),(function(e){return e.theme.accentColor.base}));n.Z=(0,h.memo)((0,h.forwardRef)(y))}}]);
//# sourceMappingURL=481.190f317e.chunk.js.map