{"version":3,"file":"static/js/910.9d730eb5.chunk.js","mappings":"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","sources":["components/Forms/FormCreateProductInventory.tsx"],"sourcesContent":["import ModalForm, { ModalFormProps } from '../ModalForm';\nimport FlexBox from '../atoms/FlexBox';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { IProduct } from '../../redux/products/products.types';\nimport TableList from '../TableList/TableList';\nimport { pricesColumnsForProductReview } from '../../data/priceManagement.data';\nimport { IProductInventoryFormData } from '../../redux/warehouses/warehouses.types';\nimport { IPriceListItem } from '../../redux/priceManagement/priceManagement.types';\nimport { IVariation } from '../../redux/products/variations.types';\nimport styled from 'styled-components';\nimport { useProductsSelector, usePropertiesSelector } from '../../redux/selectors.store';\nimport InputLabel from '../atoms/Inputs/InputLabel';\nimport InputText from '../atoms/Inputs/InputText';\nimport { t } from '../../lang';\nimport { enumToFilterOptions } from '../../utils/fabrics';\nimport ButtonsGroup from '../atoms/ButtonsGroup';\nimport { createTableTitlesFromTemplate } from '../../utils';\nimport { transformVariationTableData } from '../../utils/tables';\nimport { createApiCall, PriceManagementApi } from '../../api';\nimport { getIdRef } from '../../utils/dataTransform';\nimport { OnRowClickHandler } from '../TableList/tableTypes.types';\nimport { useForm } from 'react-hook-form';\nimport { OnlyUUID } from '../../redux/global.types';\n\nexport interface FormCreateProductInventoryProps extends Omit<ModalFormProps<IProductInventoryFormData>, 'onSubmit'> {\n  product?: IProduct;\n}\n\nconst formCreateProductInventoryInputs: {\n  name: string;\n  placeholder?: string;\n  label?: string;\n  disabled?: boolean;\n  required?: boolean;\n}[] = [\n  { name: 'stock', label: t('Available'), placeholder: t('Available') },\n  { name: 'reserved', label: t('Reserved'), placeholder: t('Reserved') },\n];\nenum ReservationOptions {\n  Yes = 'Yes',\n  No = 'No',\n}\nconst reservationOptions = enumToFilterOptions(ReservationOptions);\nconst FormCreateProductInventory: React.FC<FormCreateProductInventoryProps> = ({ ...props }) => {\n  // const modalS = useModalProvider();\n  const currentProduct = useProductsSelector().currentProduct;\n\n  const form = useForm({});\n\n  const currentProductData = useMemo(() => {\n    return props?.product || currentProduct;\n  }, [currentProduct, props?.product]);\n\n  // const { products: productsS, warehouses: warehousesS } = useAppServiceProvider();\n  const [loadedPrices, setLoadedPrices] = useState<IPriceListItem[]>([]);\n  const [selectedPrice, setSelectedPrice] = useState<IPriceListItem | OnlyUUID | undefined>();\n  const [selectedVariation, setSelectedVariation] = useState<IVariation>();\n\n  useEffect(() => {\n    console.log('FormCreateProductInventory selectedPrice', selectedPrice);\n  }, [selectedPrice]);\n\n  const templates = usePropertiesSelector();\n\n  const variationsTableTitles = useMemo(() => {\n    const template = templates.find(t => t._id === currentProduct?.template?._id);\n    return createTableTitlesFromTemplate(template);\n  }, [currentProduct?.template?._id, templates]);\n\n  useEffect(() => {\n    if (selectedVariation) {\n      createApiCall(\n        { data: { variation: getIdRef(selectedVariation) }, onSuccess: setLoadedPrices },\n        PriceManagementApi.getAllPrices,\n        PriceManagementApi\n      );\n    }\n  }, [selectedVariation]);\n\n  const transformedVariationsTableData = useMemo(\n    () => currentProductData?.variations?.map(v => transformVariationTableData(v)),\n    [currentProductData?.variations]\n  );\n\n  const handleSelectVariation: OnRowClickHandler = useCallback(data => {\n    const variation = data?._id ? { _id: data._id } : null;\n    if (!variation) return;\n\n    setSelectedVariation(variation);\n\n    createApiCall(\n      { data: { variation }, onSuccess: setLoadedPrices },\n      PriceManagementApi.getAllPrices,\n      PriceManagementApi\n    );\n  }, []);\n\n  const handleSelectPrice: OnRowClickHandler = useCallback(data => {\n    const price = data?._id ? { _id: data._id } : null;\n    if (!price) return;\n\n    setSelectedPrice(price);\n  }, []);\n\n  const onValid = (data: IProductInventoryFormData) => {\n    console.log('IProductInventoryFormData', data);\n  };\n\n  return (\n    <Form\n      fillHeight\n      title={'Add new product inventory'}\n      width={'960px'}\n      {...props}\n      onSubmit={form.handleSubmit(onValid)}\n    >\n      <FlexBox padding={'8px'} overflow={'auto'} gap={8}>\n        <InputLabel label={t('Select variation')}>\n          <FlexBox style={{ height: 300 }} overflow={'hidden'}>\n            <TableList\n              tableTitles={variationsTableTitles}\n              tableData={transformedVariationsTableData}\n              isSearch={false}\n              onRowClick={handleSelectVariation}\n            />\n          </FlexBox>\n        </InputLabel>\n\n        <InputLabel label={t('Select price')}>\n          <FlexBox style={{ height: 300 }} overflow={'hidden'}>\n            <TableList\n              tableTitles={pricesColumnsForProductReview}\n              tableData={loadedPrices}\n              isSearch={false}\n              onRowClick={handleSelectPrice}\n            />\n          </FlexBox>\n        </InputLabel>\n\n        <Inputs>\n          {formCreateProductInventoryInputs.map(info => {\n            return (\n              <InputLabel key={info?.name} label={info?.label} disabled={info?.disabled} required={info?.required}>\n                <InputText\n                  name={info?.name}\n                  align={'right'}\n                  disabled={info?.disabled}\n                  required={info?.required}\n                  placeholder={info?.placeholder}\n                />\n              </InputLabel>\n            );\n          })}\n        </Inputs>\n\n        <InputLabel label={t('Reservation anable')}>\n          <ButtonsGroup options={reservationOptions} />\n        </InputLabel>\n      </FlexBox>\n    </Form>\n  );\n};\nconst Form = styled(ModalForm)`\n  @media screen and (min-width: 480px) {\n    width: fit-content;\n    max-width: 960px;\n  }\n`;\nconst Inputs = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 8px;\n\n  width: 100%;\n`;\n\nexport default FormCreateProductInventory;\n"],"names":["formCreateProductInventoryInputs","name","label","t","placeholder","ReservationOptions","reservationOptions","enumToFilterOptions","Form","styled","ModalForm","_templateObject","_taggedTemplateLiteral","Inputs","_templateObject2","_ref","_currentProduct$templ2","props","Object","assign","_objectDestructuringEmpty","currentProduct","useProductsSelector","form","useForm","currentProductData","useMemo","product","_useState","useState","_useState2","_slicedToArray","loadedPrices","setLoadedPrices","_useState3","_useState4","selectedPrice","setSelectedPrice","_useState5","_useState6","selectedVariation","setSelectedVariation","useEffect","console","log","templates","usePropertiesSelector","variationsTableTitles","template","find","_currentProduct$templ","_id","createTableTitlesFromTemplate","createApiCall","data","variation","getIdRef","onSuccess","PriceManagementApi","transformedVariationsTableData","_currentProductData$v","variations","map","v","transformVariationTableData","handleSelectVariation","useCallback","handleSelectPrice","price","_jsx","_objectSpread","fillHeight","title","width","onSubmit","handleSubmit","children","_jsxs","FlexBox","padding","overflow","gap","InputLabel","style","height","TableList","tableTitles","tableData","isSearch","onRowClick","pricesColumnsForProductReview","info","disabled","required","InputText","align","ButtonsGroup","options"],"sourceRoot":""}